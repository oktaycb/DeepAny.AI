<!DOCTYPE html>
<html lang="en" style="background: rgba(24, 24, 24, 1);" class="loading-screen">
<head>
    <title>AI Video Generation: The Best, Free & Online | DeepAny.AI</title>
    <link rel="canonical" href="https://deepany.ai/video-generation">

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="DeepAny.AI offers a free trial for creating realistic AI-generated videos with cutting-edge technology. Easily generate videos with our user-friendly online tools. No technical skills required, start your free trial today!">
    <meta name="keywords" content="AI video generation, deepany, free video creation, online video editing, realistic AI videos, video manipulation, deepfake videos, AI-powered video tools">
    <meta name="apple-mobile-web-app-title" content="AI Video Generation" />

    <meta property="og:type" content="website">
    <meta property="og:url" content="https://deepany.ai/video-generation">
    <meta property="og:locale" content="en_US">
    <meta property="og:site_name" content="DeepAny.AI">
    <meta property="og:title" content="DeepAny.AI | Video Generation">
    <meta property="og:description" content="DeepAny.AI offers a free trial for creating realistic AI-generated videos with cutting-edge technology!">
    <meta property="og:image" content="https://deepany.ai/assets/brand.png">
    <meta property="og:image:alt" content="DeepAny.AI | Brand Logo">

    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://deepany.ai/video-generation">
    <meta property="twitter:title" content="DeepAny.AI | Video Generation">
    <meta property="twitter:description" content="DeepAny.AI offers a free trial for creating realistic AI-generated videos with cutting-edge technology!">
    <meta property="twitter:image" content="https://deepany.ai/assets/brand.png">


    <style id="loading-stylesheet">
        .loading-screen {
            position: fixed;
            top: 50%;
            left: 50%;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #ff7300;
            z-index: 999999;
            border-radius: 50%;
            width: 50px !important;
            height: 50px !important;
            animation: spin 2s linear infinite
        }

        @keyframes spin {
            0% {
                transform: translate(-50%, -50%) rotate(0deg);
            }

            100% {
                transform: translate(-50%, -50%) rotate(360deg);
            }
        }
    </style>
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
    <link rel="shortcut icon" href="/.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="manifest" href="/site.webmanifest" />
    <script>
        const version = new URLSearchParams(window.location.search).get('version') || localStorage.getItem('version') || '1.1.1.5.0.8';
        const url = window.location.origin + window.location.pathname;

        document.addEventListener('DOMContentLoaded', () => {
            (async function () {
                const storedVersion = localStorage.getItem('version');
                const urlParamsVersion = new URLSearchParams(window.location.search).get('version');
                const version = urlParamsVersion || storedVersion || '1.1.1.5.0.8';

                try {
                    const randomParam = `nocache=${Math.random()}`;
                    const versionUrl = `${window.location.origin}/version?${randomParam}`;
                    const response = await fetch(versionUrl, { cache: "no-store" });
                    const newVersion = (await response.text()).trim();
                    localStorage.setItem('version', newVersion);

                    if (!urlParamsVersion && newVersion !== version) {
                        location.reload(true);
                    }
                } catch (error) {
                    console.error("Error checking for updates:", error);
                }
            })();
        });

        // Create and insert the stylesheet link with the version parameter
        const linkEl = document.createElement('link');
        linkEl.rel = 'stylesheet';
        linkEl.href = `css/styles.css?v=${version}`;
        document.head.appendChild(linkEl);
    </script>
    <style>
        :root {
            --input-size: calc(12vh * var(--scale-factor-h));
            --input-margin: calc(4vh * var(--scale-factor-h));
        }
    </style>
</head>
<body lang="en">
    <script type="module" defer>
        const version = new URLSearchParams(window.location.search).get('version') || localStorage.getItem('version') || '1.1.1.5.0.8';

        async function loadModule(url) {
            return import(`${url}?v=${version}`);
        }

        document.addEventListener('DOMContentLoaded', async function () {
            const functions = await loadModule('./scripts/functions.js');
            const { serverID, fetchWithRandom, getCheckedCheckboxIdFromCombobox, setDownloadCancelled, getAbortController, resetAbortController, pageName, setFetchableServerAdresses, getFetchableServerAdresses, checkServerStatus, setDynamicInterval, updateDownloadFile, cancelProcess, fetchUploadedChunks, processBlobToFile, createSectionAndElements, setMaxWidth, saveCountIndex, handleDownload, handleFileContainerEvents, handleUpload, setupFileUpload, setClientStatus, customFetch, checkServerQueue, showNotification, openDB, addToDB, getFromDB, initDB, setUser, getUserData, getUserDoc, setAuthentication, getFirebaseModules, getDocSnapshot, getDocsSnapshot, getScreenMode, getCurrentMain, updateContent, ScreenMode, createPages, setNavbar, setSidebar, showSidebar, removeSidebar, getSidebarActive, moveMains, setupMainSize, loadScrollingAndMain, showZoomIndicator, setScaleFactors, clamp, loadPageContent, retrieveImageFromURL, fetchServerAddress, ensureUniqueId, getUserInternetProtocol, fetchServerAddresses } = functions;

            if (!window.indexedDB) {
                alert('Your browser does not support IndexedDB.');
            }

            function savePageState() {
                const requiredIds = [
                    'removeBanner',
                    'showServers',
                    'enhanceDetails',
                    'generateAudio',
                    'enhanceResolution',
                ];

                if (!requiredIds.every(id => document.getElementById(id))) {
                    return;
                }

                const getCheckboxState = id => document.getElementById(id)?.checked || false; const activeLinks = Array.from(document.querySelectorAll('.nav-links .active')).map(link => link.getAttribute('for') || '');

                const state = {
                    removeBanner: getCheckboxState('removeBanner'),
                    showServers: getCheckboxState('showServers'),
                    generateAudio: getCheckboxState('generateAudio'),
                    enhanceDetails: getCheckboxState('enhanceDetails'),
                    enhanceResolution: getCheckboxState('enhanceResolution'),
                    positivePrompt: document.getElementById('positiveAudioPrompt').value,
                    negativePrompt: document.getElementById('negativeAudioPrompt').value,
                    positivePrompt: document.getElementById('positivePrompt').value,
                    negativePrompt: document.getElementById('negativePrompt').value,
                    activeLinks: activeLinks,
                    multiboxes: Array.from(document.querySelectorAll('.multibox')).map(multibox => ({
                        text: multibox.querySelector('.multibox-text')?.innerText || '',
                        open: multibox.classList.contains('open'),
                        items: Array.from(multibox.querySelectorAll('.item')).map(item => ({
                            checked: item.querySelector('input[type="checkbox"]')?.checked || false,
                        })),
                    })),
                    comboboxes: Array.from(document.querySelectorAll('.combobox')).map(combobox => ({
                        text: combobox.querySelector('.combobox-text')?.innerText || '',
                        open: combobox.classList.contains('open'),
                        items: Array.from(combobox.querySelectorAll('.item')).map(item => ({
                            checked: item.querySelector('input[type="checkbox"]')?.checked || false,
                        })),
                    })),
                };

                localStorage.setItem(pageName, JSON.stringify(state));
            }

            let userData = await getUserData();
            let userDoc = await getUserDoc();

            function updateMainContent(screenMode, pageContent) {
                pageContent.length = 0;
                if (screenMode !== 1) {
                    pageContent.push(`
                                        <div id="baseContainer" style="display: grid; grid-template-columns: 8fr 3fr; width: 100%; height: 100%;gap: calc(2vh* var(--scale-factor-h));">
                                            <div class="background-container" style="display: flex; flex-direction: column; align-items: stretch; width: 100%; height: 100%;">
                                                <div style="display: grid;grid-template-rows: 1fr auto;height: 100%;">
                                                    <div class="background-dot-container">
                                                        <div class="background-dot-container-content" style="--degree: 45deg; border-color: white; display: flex;gap: 0; flex-direction: column; padding: 0;">
                                                            <div class="tab-container">
                                                                <div class="section-tabs">
                                                                    <div class="tab active" for="processTab">
                                                                        <div class="svg-tag">
                                                                            <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 256 256" height="1em" width="1em"><path d="M197.58,129.06l-51.61-19-19-51.65a15.92,15.92,0,0,0-29.88,0L78.07,110l-51.65,19a15.92,15.92,0,0,0,0,29.88L78,178l19,51.62a15.92,15.92,0,0,0,29.88,0l19-51.61,51.65-19a15.92,15.92,0,0,0,0-29.88ZM140.39,163a15.87,15.87,0,0,0-9.43,9.43l-19,51.46L93,172.39A15.87,15.87,0,0,0,83.61,163h0L32.15,144l51.46-19A15.87,15.87,0,0,0,93,115.61l19-51.46,19,51.46a15.87,15.87,0,0,0,9.43,9.43l51.46,19ZM144,40a8,8,0,0,1,8-8h16V16a8,8,0,0,1,16,0V32h16a8,8,0,0,1,0,16H184V64a8,8,0,0,1-16,0V48H152A8,8,0,0,1,144,40ZM248,88a8,8,0,0,1-8,8h-8v8a8,8,0,0,1-16,0V96h-8a8,8,0,0,1,0-16h8V72a8,8,0,0,1,16,0v8h8A8,8,0,0,1,248,88Z"></path></svg>
                                                                        </div>
                                                                        <span>Generate</span>
                                                                    </div>
                                                                    <div class="tab" for="downloadTab">
                                                                        <div class="svg-tag">
                                                                            <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 256 256" height="1em" width="1em"><path d="M197.58,129.06l-51.61-19-19-51.65a15.92,15.92,0,0,0-29.88,0L78.07,110l-51.65,19a15.92,15.92,0,0,0,0,29.88L78,178l19,51.62a15.92,15.92,0,0,0,29.88,0l19-51.61,51.65-19a15.92,15.92,0,0,0,0-29.88ZM140.39,163a15.87,15.87,0,0,0-9.43,9.43l-19,51.46L93,172.39A15.87,15.87,0,0,0,83.61,163h0L32.15,144l51.46-19A15.87,15.87,0,0,0,93,115.61l19-51.46,19,51.46a15.87,15.87,0,0,0,9.43,9.43l51.46,19ZM144,40a8,8,0,0,1,8-8h16V16a8,8,0,0,1,16,0V32h16a8,8,0,0,1,0,16H184V64a8,8,0,0,1-16,0V48H152A8,8,0,0,1,144,40ZM248,88a8,8,0,0,1-8,8h-8v8a8,8,0,0,1-16,0V96h-8a8,8,0,0,1,0-16h8V72a8,8,0,0,1,16,0v8h8A8,8,0,0,1,248,88Z"></path></svg>
                                                                        </div>
                                                                        <span>Download</span>
                                                                    </div>
                                                                </div>

                                                                <div id="processTab" class="content-section" style="display: none;flex-direction: column;justify-content: space-between;flex: 1 1 auto;padding: calc(1.5vh * var(--scale-factor-h));gap: calc(1.5vh * var(--scale-factor-h));">
                                                                    <div id="featuresContainer" style="display: flex;flex-direction: column;gap: calc(1.5vh * var(--scale-factor-h));flex: 1 1 auto;overflow-y: auto;max-height: 100%;padding-right: calc(0.75vh* var(--scale-factor-h));height: 0;">
                                                                        <div>
                                                                            <h4 class="non-bold">Positive Prompt</h4>
                                                                            <div style="font-size: 0px; font-weight: 400;" tooltip>
                                                                                <div class="tooltip">Enter the things you want to happen in the video.</div>
                                                                                <textarea id="positivePrompt" placeholder="Enter the things you want to happen in the video..." maxlength="2000" style="width: 100%;height: calc(12vh* var(--scale-factor-h));"></textarea>
                                                                            </div>
                                                                        </div>
                                                                        <div>
                                                                            <div style="display: flex;align-items: center;justify-content: space-between;">
                                                                                <div style="display: flex;align-items: center;">
                                                                                    <h4 class="non-bold">Negative Prompt</h4>
                                                                                    &nbsp;
                                                                                    <h4 class="non-bold" style="opacity: 0.5;">(Optional)</h4>
                                                                                </div>
                                                                                <svg id="negativeSVG" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="rgba(var(--white),1)" version="1.1" id="Layer_1" viewBox="0 0 330 330" xml:space="preserve" style="width: calc(4vh* var(--scale-factor-h));">
                                                                                    <path id="XMLID_225_" d="M325.607,79.393c-5.857-5.857-15.355-5.858-21.213,0.001l-139.39,139.393L25.607,79.393  c-5.857-5.857-15.355-5.858-21.213,0.001c-5.858,5.858-5.858,15.355,0,21.213l150.004,150c2.813,2.813,6.628,4.393,10.606,4.393  s7.794-1.581,10.606-4.394l149.996-150C331.465,94.749,331.465,85.251,325.607,79.393z"></path>
                                                                                </svg>
                                                                            </div>
                                                                            <div style="font-size: 0px; font-weight: 400;" tooltip>
                                                                                <div class="tooltip">Enter the things you do not want to happen in the video.</div>
                                                                                <textarea id="negativePrompt" placeholder="Enter the things you do not want to happen in the video..." maxlength="2000" style="width: 100%;height: calc(12vh* var(--scale-factor-h));"></textarea>
                                                                            </div>
                                                                        </div>
                                                                        <div class="line"></div>
                                                                        <div>
                                                                            <div id="quality" class="combobox" tooltip>
                                                                                <div class="tooltip">
                                                                                    Change the detail quality of the video.
                                                                                </div>
                                                                                <span class="combobox-text" title="Quality" default="Low"></span>
                                                                                <span class="arrow-dwn"></span>
                                                                                <ul class="list-items">
                                                                                    <li class="item">
                                                                                        <label class="checkbox" tooltip>
                                                                                            <input type="checkbox" id="1"><span>Low</span>
                                                                                            <div class="tooltip">Low quality of video.</div>
                                                                                        </label>
                                                                                    </li>
                                                                                    <li class="item">
                                                                                        <label class="checkbox" tooltip>
                                                                                            <input type="checkbox" id="2"><span>Medium</span>
                                                                                            <div class="tooltip">Medium quality of video.</div>
                                                                                        </label>
                                                                                    </li>
                                                                                    <li class="item">
                                                                                        <label class="checkbox" tooltip>
                                                                                            <input type="checkbox" id="3"><span>High</span>
                                                                                            <div class="tooltip">High quality of video.</div>
                                                                                        </label>
                                                                                    </li>
                                                                                </ul>
                                                                            </div>
                                                                        </div>
                                                                        <div>
                                                                            <div id="duration" class="combobox" tooltip>
                                                                                <div class="tooltip">
                                                                                    How many frames to generate within the video, 16 frames = 1 second.
                                                                                </div>
                                                                                <span class="combobox-text" title="Duration" default="3s"></span>
                                                                                <span class="arrow-dwn"></span>
                                                                                <ul class="list-items">
                                                                                    <li class="item">
                                                                                        <label class="checkbox" tooltip>
                                                                                            <input type="checkbox" id="1"><span>1s</span>
                                                                                            <div class="tooltip">1 second duration of video will be generated.</div>
                                                                                        </label>
                                                                                    </li>
                                                                                    <li class="item">
                                                                                        <label class="checkbox" tooltip>
                                                                                            <input type="checkbox" id="2"><span>2s</span>
                                                                                            <div class="tooltip">2 second duration of video will be generated.</div>
                                                                                        </label>
                                                                                    </li>
                                                                                    <li class="item">
                                                                                        <label class="checkbox" tooltip>
                                                                                            <input type="checkbox" id="3"><span>3s</span>
                                                                                            <div class="tooltip">3 second duration of video will be generated.</div>
                                                                                        </label>
                                                                                    </li>
                                                                                    <li class="item">
                                                                                        <label class="checkbox" tooltip>
                                                                                            <input type="checkbox" id="4"><span>4s</span>
                                                                                            <div class="tooltip">4 second duration of video will be generated.</div>
                                                                                        </label>
                                                                                    </li>
                                                                                    <li class="item">
                                                                                        <label class="checkbox" tooltip>
                                                                                            <input type="checkbox" id="5"><span>5s</span>
                                                                                            <div class="tooltip">5 second duration of video will be generated.</div>
                                                                                        </label>
                                                                                    </li>
                                                                                    <li class="item">
                                                                                        <label class="checkbox" tooltip>
                                                                                            <input type="checkbox" id="10"><span>10s (Unstable)</span>
                                                                                            <div class="tooltip">5 second duration of video will be generated.</div>
                                                                                        </label>
                                                                                    </li>
                                                                                </ul>
                                                                            </div>
                                                                        </div>
                                                                        <div>
                                                                            <div id="aspectRatio" class="combobox" tooltip>
                                                                                <div class="tooltip">
                                                                                    Image aspect ratio - that is, the shape of the image (wide vs square vs tall).
                                                                                </div>
                                                                                <span class="combobox-text" title="Aspect Ratio" default="16:9 (Wide)"></span>
                                                                                <span class="arrow-dwn"></span>
                                                                                <ul class="list-items">
                                                                                    <li class="item">
                                                                                        <label class="checkbox" tooltip>
                                                                                            <input type="checkbox" id="16:9"><span>16:9 (Wide)</span>
                                                                                            <div class="tooltip">Wide video resolution</div>
                                                                                        </label>
                                                                                    </li>
                                                                                    <li class="item">
                                                                                        <label class="checkbox" tooltip>
                                                                                            <input type="checkbox" id="1:1"><span>1:1 (Square)</span>
                                                                                            <div class="tooltip">Square video resolution.</div>
                                                                                        </label>
                                                                                    </li>
                                                                                    <li class="item">
                                                                                        <label class="checkbox" tooltip>
                                                                                            <input type="checkbox" id="9:16"><span>9:16 (Tall)</span>
                                                                                            <div class="tooltip">Tall video resolution.</div>
                                                                                        </label>
                                                                                    </li>
                                                                                </ul>
                                                                            </div>
                                                                        </div>
                                                                        <div class="line"></div>
                                                                        <div>
                                                                            <label class="checkbox">
                                                                                <input type="checkbox" id="generateAudio"><span>Generate audio</span>
                                                                            </label>
                                                                        </div>
                                                                        <div id="audioContainer">
                                                                            <div>
                                                                                <h4 class="non-bold">Positive Audio Prompt</h4>
                                                                                <div style="font-size: 0px; font-weight: 400;" tooltip>
                                                                                    <div class="tooltip">Enter the things you want to happen in the audio.</div>
                                                                                    <textarea id="positiveAudioPrompt" placeholder="Leave or enter the things if you want as audio..." maxlength="2000" style="width: 100%;height: calc(6vh* var(--scale-factor-h));"></textarea>
                                                                                </div>
                                                                            </div>
                                                                            <div>
                                                                                <div style="display: flex;align-items: center;justify-content: space-between;">
                                                                                    <div style="display: flex;align-items: center;">
                                                                                        <h4 class="non-bold">Negative Prompt</h4>
                                                                                        &nbsp;
                                                                                        <h4 class="non-bold" style="opacity: 0.5;">(Optional)</h4>
                                                                                    </div>
                                                                                    <svg id="negativeAudioSVG" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="rgba(var(--white),1)" version="1.1" id="Layer_1" viewBox="0 0 330 330" xml:space="preserve" style="width: calc(4vh* var(--scale-factor-h));">
                                                                                        <path id="XMLID_225_" d="M325.607,79.393c-5.857-5.857-15.355-5.858-21.213,0.001l-139.39,139.393L25.607,79.393  c-5.857-5.857-15.355-5.858-21.213,0.001c-5.858,5.858-5.858,15.355,0,21.213l150.004,150c2.813,2.813,6.628,4.393,10.606,4.393  s7.794-1.581,10.606-4.394l149.996-150C331.465,94.749,331.465,85.251,325.607,79.393z"></path>
                                                                                    </svg>
                                                                                </div>
                                                                                <div style="font-size: 0px; font-weight: 400;" tooltip>
                                                                                    <div class="tooltip">Enter the things you do not want to happen in the audio.</div>
                                                                                    <textarea id="negativeAudioPrompt" placeholder="Enter the things if you don't want in audio..." maxlength="2000" style="width: 100%;height: calc(6vh* var(--scale-factor-h));"></textarea>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <div>
                                                                            <label class="checkbox">
                                                                                <input type="checkbox" id="enhanceResolution"><span>Enhance resolution</span>
                                                                            </label>
                                                                        </div>
                                                                        <div>
                                                                            <label class="checkbox">
                                                                                <input type="checkbox" id="enhanceDetails"><span>Enhance details</span>
                                                                            </label>
                                                                        </div>
                                                                        <div class="line"></div>
                                                                        <div>
                                                                            <label class="checkbox">
                                                                                <input type="checkbox" id="removeBanner"><span>Remove banner</span>
                                                                            </label>
                                                                        </div>
                                                                        <div>
                                                                            <div id="showServersContainer">
                                                                                <label class="checkbox">
                                                                                    <input type="checkbox" id="showServers">Server List</input>
                                                                                </label>
                                                                            </div>
                                                                            <div id="serverList" style="display: flex;justify-content: space-evenly;flex-wrap: wrap;align-content: stretch;flex-direction: column;"></div>
                                                                        </div>
                                                                    </div>
                                                                    <div style="display: flex;gap: calc(1.5vh * var(--scale-factor-h));flex-direction: column;">
                                                                        <div class="line"></div>
                                                                        <div style="display: flex;gap: calc(1.5vh * var(--scale-factor-h));flex-direction: row;">
                                                                            <button class="wide important" id="startProcessBtn">
                                                                                <svg style="opacity: 1;" stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 256 256" class="w-5 h-5" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M197.58,129.06l-51.61-19-19-51.65a15.92,15.92,0,0,0-29.88,0L78.07,110l-51.65,19a15.92,15.92,0,0,0,0,29.88L78,178l19,51.62a15.92,15.92,0,0,0,29.88,0l19-51.61,51.65-19a15.92,15.92,0,0,0,0-29.88ZM140.39,163a15.87,15.87,0,0,0-9.43,9.43l-19,51.46L93,172.39A15.87,15.87,0,0,0,83.61,163h0L32.15,144l51.46-19A15.87,15.87,0,0,0,93,115.61l19-51.46,19,51.46a15.87,15.87,0,0,0,9.43,9.43l51.46,19ZM144,40a8,8,0,0,1,8-8h16V16a8,8,0,0,1,16,0V32h16a8,8,0,0,1,0,16H184V64a8,8,0,0,1-16,0V48H152A8,8,0,0,1,144,40ZM248,88a8,8,0,0,1-8,8h-8v8a8,8,0,0,1-16,0V96h-8a8,8,0,0,1,0-16h8V72a8,8,0,0,1,16,0v8h8A8,8,0,0,1,248,88Z"></path></svg>
                                                                                <span>Generate</span>
                                                                            </button>
                                                                        </div>
                                                                    </div>
                                                                </div>

                                                                <div id="downloadTab" class="content-section" style="display: none;flex-direction: column;justify-content: space-between;flex: 1 1 auto;padding: calc(1.5vh * var(--scale-factor-h));gap: calc(1.5vh * var(--scale-factor-h));">
                                                                    <div id="featuresContainer" style="display: flex;flex-direction: column;gap: calc(1.5vh * var(--scale-factor-h));flex: 1 1 auto;overflow-y: auto;max-height: 100%;padding-right: calc(0.75vh* var(--scale-factor-h));height: 0;">
                                                                        <div id="outputSection" style="--degree: 135deg;height: 100%;display: grid;grid-template-rows: 1fr auto;gap: calc(2vh* var(--scale-factor-h));border-color: white;">
                                                                            <div class="card-container background-non-hover-for-card" style="display: block;height: 100%;width: 100%;">
                                                                                <div class="card" style="position: relative;">
                                                                                    <div class="card-content card-remove-hover" style="--degree: -135deg;justify-content: center;padding: 0;border-color: white;">
                                                                                        <div id="outputs_beforeInit"  style="width: 100%;height: 100%;display: flex;justify-content: center;align-items: center;">
                                                                                            <div style="display: flex;align-items: center;gap: calc(1vh * var(--scale-factor-h));flex-direction: column;">
                                                                                                <svg style="width: 6vh;" viewBox="0 0 49 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M44.5393 33.64L38.2793 19C37.1393 16.32 35.4393 14.8 33.4993 14.7C31.5793 14.6 29.7193 15.94 28.2993 18.5L24.4993 25.32C23.6993 26.76 22.5593 27.62 21.3193 27.72C20.0593 27.84 18.7993 27.18 17.7793 25.88L17.3393 25.32C15.9193 23.54 14.1593 22.68 12.3593 22.86C10.5593 23.04 9.0193 24.28 7.9993 26.3L4.5393 33.2C3.2993 35.7 3.4193 38.6 4.8793 40.96C6.3393 43.32 8.8793 44.74 11.6593 44.74H37.1793C39.8593 44.74 42.3593 43.4 43.8393 41.16C45.3593 38.92 45.5993 36.1 44.5393 33.64Z" fill="#EFF6FF" fill-opacity="0.25"></path><path d="M14.4402 16.76C18.1736 16.76 21.2002 13.7334 21.2002 9.99999C21.2002 6.26655 18.1736 3.23999 14.4402 3.23999C10.7067 3.23999 7.68018 6.26655 7.68018 9.99999C7.68018 13.7334 10.7067 16.76 14.4402 16.76Z" fill="#EFF6FF" fill-opacity="0.25"></path></svg>
                                                                                                <small style="color: grey;">Your output will display here!</small>
                                                                                            </div>
                                                                                        </div>
                                                                                        <div id="outputs_afterInit" style="display: none; width: 100%; height: 100%; justify-content: center;"></div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                            <div class="card-container background-non-hover-for-card" style="display: block;height: 100%;width: 100%;">
                                                                                <div class="card" style="position: relative;">
                                                                                    <div class="card-content card-remove-hover" style="--degree: -45deg;justify-content: center;border-color: white;min-height: calc(var(--input-size) + (var(--input-margin)));padding: 0;justify-content: flex-start;">
                                                                                        <div style="display: flex;">
                                                                                            <div class="outputs" style="flex-direction: column;width: 100%;align-items: flex-start;overflow: auto hidden !important;display: flex;align-content: flex-start;max-width: unset;"></div>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div style="display: flex;gap: calc(1.5vh * var(--scale-factor-h));flex-direction: column;">
                                                                        <div class="line"></div>
                                                                        <div style="display: flex;gap: calc(1.5vh * var(--scale-factor-h));flex-direction: row;">
                                                                            <button disabled class="wide" id="viewOutput">
                                                                                <span>Preview</span>
                                                                            </button>
                                                                            <button class="wide important" id="downloadOutput">
                                                                                <span>Download</span>
                                                                            </button>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    `);
                    return;
                }

                pageContent.push(`
                                        <div id="baseContainer" style="display: grid; grid-template-columns: 2fr 5fr; width: 100%; height: 100%;gap: calc(2vh* var(--scale-factor-h));">
                                            <div class="background-container" style="display: flex; flex-direction: column; align-items: stretch; width: 100%; height: 100%;">
                                                <div style="display: grid;grid-template-rows: 1fr auto;height: 100%;">
                                                    <div class="background-dot-container">
                                                        <div class="background-dot-container-content" style="--degree: 45deg; border-color: white; display: flex;gap: 0; flex-direction: column; padding: 0;">
                                                            <div class="tab-container">
                                                                <div class="section-tabs">
                                                                    <div class="tab active" for="processTab">
                                                                        <div class="svg-tag">
                                                                            <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 256 256" height="1em" width="1em"><path d="M197.58,129.06l-51.61-19-19-51.65a15.92,15.92,0,0,0-29.88,0L78.07,110l-51.65,19a15.92,15.92,0,0,0,0,29.88L78,178l19,51.62a15.92,15.92,0,0,0,29.88,0l19-51.61,51.65-19a15.92,15.92,0,0,0,0-29.88ZM140.39,163a15.87,15.87,0,0,0-9.43,9.43l-19,51.46L93,172.39A15.87,15.87,0,0,0,83.61,163h0L32.15,144l51.46-19A15.87,15.87,0,0,0,93,115.61l19-51.46,19,51.46a15.87,15.87,0,0,0,9.43,9.43l51.46,19ZM144,40a8,8,0,0,1,8-8h16V16a8,8,0,0,1,16,0V32h16a8,8,0,0,1,0,16H184V64a8,8,0,0,1-16,0V48H152A8,8,0,0,1,144,40ZM248,88a8,8,0,0,1-8,8h-8v8a8,8,0,0,1-16,0V96h-8a8,8,0,0,1,0-16h8V72a8,8,0,0,1,16,0v8h8A8,8,0,0,1,248,88Z"></path></svg>
                                                                        </div>
                                                                        <span>Generate</span>
                                                                    </div>
                                                                </div>

                                                                <div id="processTab" class="content-section" style="display: flex;flex-direction: column;justify-content: space-between;flex: 1 1 auto;padding: calc(1.5vh * var(--scale-factor-h));gap: calc(1.5vh * var(--scale-factor-h));">
                                                                    <div id="featuresContainer" style="display: flex;flex-direction: column;gap: calc(1.5vh * var(--scale-factor-h));flex: 1 1 auto;overflow-y: auto;max-height: 100%;padding-right: calc(0.75vh* var(--scale-factor-h));height: 0;">
                                                                        <div>
                                                                            <h4 class="non-bold">Positive Prompt</h4>
                                                                            <div style="font-size: 0px; font-weight: 400;" tooltip>
                                                                                <div class="tooltip">Enter the things you want to happen in the video.</div>
                                                                                <textarea id="positivePrompt" placeholder="Enter the things you want to happen in the video..." maxlength="2000" style="width: 100%;height: calc(12vh* var(--scale-factor-h));"></textarea>
                                                                            </div>
                                                                        </div>
                                                                        <div>
                                                                            <div style="display: flex;align-items: center;justify-content: space-between;">
                                                                                <div style="display: flex;align-items: center;">
                                                                                    <h4 class="non-bold">Negative Prompt</h4>
                                                                                    &nbsp;
                                                                                    <h4 class="non-bold" style="opacity: 0.5;">(Optional)</h4>
                                                                                </div>
                                                                                <svg id="negativeSVG" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="rgba(var(--white),1)" version="1.1" id="Layer_1" viewBox="0 0 330 330" xml:space="preserve" style="width: calc(4vh* var(--scale-factor-h));">
                                                                                    <path id="XMLID_225_" d="M325.607,79.393c-5.857-5.857-15.355-5.858-21.213,0.001l-139.39,139.393L25.607,79.393  c-5.857-5.857-15.355-5.858-21.213,0.001c-5.858,5.858-5.858,15.355,0,21.213l150.004,150c2.813,2.813,6.628,4.393,10.606,4.393  s7.794-1.581,10.606-4.394l149.996-150C331.465,94.749,331.465,85.251,325.607,79.393z"></path>
                                                                                </svg>
                                                                            </div>
                                                                            <div style="font-size: 0px; font-weight: 400;" tooltip>
                                                                                <div class="tooltip">Enter the things you do not want to happen in the video.</div>
                                                                                <textarea id="negativePrompt" placeholder="Enter the things you do not want to happen in the video..." maxlength="2000" style="width: 100%;height: calc(12vh* var(--scale-factor-h));"></textarea>
                                                                            </div>
                                                                        </div>
                                                                        <div class="line"></div>
                                                                        <div>
                                                                            <div id="quality" class="combobox" tooltip>
                                                                                <div class="tooltip">
                                                                                    Change the detail quality of the video.
                                                                                </div>
                                                                                <span class="combobox-text" title="Quality" default="Low"></span>
                                                                                <span class="arrow-dwn"></span>
                                                                                <ul class="list-items">
                                                                                    <li class="item">
                                                                                        <label class="checkbox" tooltip>
                                                                                            <input type="checkbox" id="1"><span>Low</span>
                                                                                            <div class="tooltip">Low quality of video.</div>
                                                                                        </label>
                                                                                    </li>
                                                                                    <li class="item">
                                                                                        <label class="checkbox" tooltip>
                                                                                            <input type="checkbox" id="2"><span>Medium</span>
                                                                                            <div class="tooltip">Medium quality of video.</div>
                                                                                        </label>
                                                                                    </li>
                                                                                    <li class="item">
                                                                                        <label class="checkbox" tooltip>
                                                                                            <input type="checkbox" id="3"><span>High</span>
                                                                                            <div class="tooltip">High quality of video.</div>
                                                                                        </label>
                                                                                    </li>
                                                                                </ul>
                                                                            </div>
                                                                        </div>
                                                                        <div>
                                                                            <div id="duration" class="combobox" tooltip>
                                                                                <div class="tooltip">
                                                                                    How many frames to generate within the video, 16 frames = 1 second.
                                                                                </div>
                                                                                <span class="combobox-text" title="Duration" default="3s"></span>
                                                                                <span class="arrow-dwn"></span>
                                                                                <ul class="list-items">
                                                                                    <li class="item">
                                                                                        <label class="checkbox" tooltip>
                                                                                            <input type="checkbox" id="1"><span>1s</span>
                                                                                            <div class="tooltip">1 second duration of video will be generated.</div>
                                                                                        </label>
                                                                                    </li>
                                                                                    <li class="item">
                                                                                        <label class="checkbox" tooltip>
                                                                                            <input type="checkbox" id="2"><span>2s</span>
                                                                                            <div class="tooltip">2 second duration of video will be generated.</div>
                                                                                        </label>
                                                                                    </li>
                                                                                    <li class="item">
                                                                                        <label class="checkbox" tooltip>
                                                                                            <input type="checkbox" id="3"><span>3s</span>
                                                                                            <div class="tooltip">3 second duration of video will be generated.</div>
                                                                                        </label>
                                                                                    </li>
                                                                                    <li class="item">
                                                                                        <label class="checkbox" tooltip>
                                                                                            <input type="checkbox" id="4"><span>4s</span>
                                                                                            <div class="tooltip">4 second duration of video will be generated.</div>
                                                                                        </label>
                                                                                    </li>
                                                                                    <li class="item">
                                                                                        <label class="checkbox" tooltip>
                                                                                            <input type="checkbox" id="5"><span>5s</span>
                                                                                            <div class="tooltip">5 second duration of video will be generated.</div>
                                                                                        </label>
                                                                                    </li>
                                                                                    <li class="item">
                                                                                        <label class="checkbox" tooltip>
                                                                                            <input type="checkbox" id="10"><span>10s (Unstable)</span>
                                                                                            <div class="tooltip">10 second duration of video will be generated.</div>
                                                                                        </label>
                                                                                    </li>
                                                                                </ul>
                                                                            </div>
                                                                        </div>
                                                                        <div>
                                                                            <div id="aspectRatio" class="combobox" tooltip>
                                                                                <div class="tooltip">
                                                                                    Image aspect ratio - that is, the shape of the image (wide vs square vs tall).
                                                                                </div>
                                                                                <span class="combobox-text" title="Aspect Ratio" default="16:9 (Wide)"></span>
                                                                                <span class="arrow-dwn"></span>
                                                                                <ul class="list-items">
                                                                                    <li class="item">
                                                                                        <label class="checkbox" tooltip>
                                                                                            <input type="checkbox" id="16:9"><span>16:9 (Wide)</span>
                                                                                            <div class="tooltip">Wide video resolution</div>
                                                                                        </label>
                                                                                    </li>
                                                                                    <li class="item">
                                                                                        <label class="checkbox" tooltip>
                                                                                            <input type="checkbox" id="1:1"><span>1:1 (Square)</span>
                                                                                            <div class="tooltip">Square video resolution.</div>
                                                                                        </label>
                                                                                    </li>
                                                                                    <li class="item">
                                                                                        <label class="checkbox" tooltip>
                                                                                            <input type="checkbox" id="9:16"><span>9:16 (Tall)</span>
                                                                                            <div class="tooltip">Tall video resolution.</div>
                                                                                        </label>
                                                                                    </li>
                                                                                </ul>
                                                                            </div>
                                                                        </div>
                                                                        <div class="line"></div>
                                                                        <div>
                                                                            <label class="checkbox">
                                                                                <input type="checkbox" id="generateAudio"><span>Generate audio</span>
                                                                            </label>
                                                                        </div>
                                                                        <div id="audioContainer">
                                                                            <div>
                                                                                <h4 class="non-bold">Positive Audio Prompt</h4>
                                                                                <div style="font-size: 0px; font-weight: 400;" tooltip>
                                                                                    <div class="tooltip">Enter the things you want to happen in the audio.</div>
                                                                                    <textarea id="positiveAudioPrompt" placeholder="Enter the things if you want as audio..." maxlength="2000" style="width: 100%;height: calc(6vh* var(--scale-factor-h));"></textarea>
                                                                                </div>
                                                                            </div>
                                                                            <div>
                                                                                <div style="display: flex;align-items: center;justify-content: space-between;">
                                                                                    <div style="display: flex;align-items: center;">
                                                                                        <h4 class="non-bold">Negative Prompt</h4>
                                                                                        &nbsp;
                                                                                        <h4 class="non-bold" style="opacity: 0.5;">(Optional)</h4>
                                                                                    </div>
                                                                                    <svg id="negativeAudioSVG" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="rgba(var(--white),1)" version="1.1" id="Layer_1" viewBox="0 0 330 330" xml:space="preserve" style="width: calc(4vh* var(--scale-factor-h));">
                                                                                        <path id="XMLID_225_" d="M325.607,79.393c-5.857-5.857-15.355-5.858-21.213,0.001l-139.39,139.393L25.607,79.393  c-5.857-5.857-15.355-5.858-21.213,0.001c-5.858,5.858-5.858,15.355,0,21.213l150.004,150c2.813,2.813,6.628,4.393,10.606,4.393  s7.794-1.581,10.606-4.394l149.996-150C331.465,94.749,331.465,85.251,325.607,79.393z"></path>
                                                                                    </svg>
                                                                                </div>
                                                                                <div style="font-size: 0px; font-weight: 400;" tooltip>
                                                                                    <div class="tooltip">Enter the things you do not want to happen in the audio.</div>
                                                                                    <textarea id="negativeAudioPrompt" placeholder="Enter the things if you don't want in audio..." maxlength="2000" style="width: 100%;height: calc(6vh* var(--scale-factor-h));"></textarea>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <div>
                                                                            <label class="checkbox">
                                                                                <input type="checkbox" id="enhanceResolution"><span>Enhance resolution</span>
                                                                            </label>
                                                                        </div>
                                                                        <div>
                                                                            <label class="checkbox">
                                                                                <input type="checkbox" id="enhanceDetails"><span>Enhance details</span>
                                                                            </label>
                                                                        </div>
                                                                        <div class="line"></div>
                                                                        <div>
                                                                            <label class="checkbox">
                                                                                <input type="checkbox" id="removeBanner"><span>Remove banner</span>
                                                                            </label>
                                                                        </div>
                                                                        <div>
                                                                            <div id="showServersContainer">
                                                                                <label class="checkbox">
                                                                                    <input type="checkbox" id="showServers">Server List</input>
                                                                                </label>
                                                                            </div>
                                                                            <div id="serverList" style="display: flex;justify-content: space-evenly;flex-wrap: wrap;align-content: stretch;flex-direction: column;"></div>
                                                                        </div>
                                                                    </div>
                                                                    <div style="display: flex;gap: calc(1.5vh * var(--scale-factor-h));flex-direction: column;">
                                                                        <div class="line"></div>
                                                                        <div style="display: flex;gap: calc(1.5vh * var(--scale-factor-h));flex-direction: row;">
                                                                            <button class="wide important" id="startProcessBtn">
                                                                                <svg style="opacity: 1;" stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 256 256" class="w-5 h-5" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M197.58,129.06l-51.61-19-19-51.65a15.92,15.92,0,0,0-29.88,0L78.07,110l-51.65,19a15.92,15.92,0,0,0,0,29.88L78,178l19,51.62a15.92,15.92,0,0,0,29.88,0l19-51.61,51.65-19a15.92,15.92,0,0,0,0-29.88ZM140.39,163a15.87,15.87,0,0,0-9.43,9.43l-19,51.46L93,172.39A15.87,15.87,0,0,0,83.61,163h0L32.15,144l51.46-19A15.87,15.87,0,0,0,93,115.61l19-51.46,19,51.46a15.87,15.87,0,0,0,9.43,9.43l51.46,19ZM144,40a8,8,0,0,1,8-8h16V16a8,8,0,0,1,16,0V32h16a8,8,0,0,1,0,16H184V64a8,8,0,0,1-16,0V48H152A8,8,0,0,1,144,40ZM248,88a8,8,0,0,1-8,8h-8v8a8,8,0,0,1-16,0V96h-8a8,8,0,0,1,0-16h8V72a8,8,0,0,1,16,0v8h8A8,8,0,0,1,248,88Z"></path></svg>
                                                                                <span>Generate</span>
                                                                            </button>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="background-container" style="display: flex; flex-direction: column; align-items: stretch; width: 100%; height: 100%;">
                                                <div style="display: grid;grid-template-rows: 1fr auto;height: 100%;">
                                                    <div class="background-dot-container">
                                                        <div class="background-dot-container-content" style="--degree: 45deg; border-color: white; display: flex;gap: 0; flex-direction: column; padding: 0;">
                                                            <div class="tab-container">
                                                                <div class="section-tabs">
                                                                    <div class="tab" for="downloadTab">
                                                                        <div class="svg-tag">
                                                                            <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 256 256" height="1em" width="1em"><path d="M197.58,129.06l-51.61-19-19-51.65a15.92,15.92,0,0,0-29.88,0L78.07,110l-51.65,19a15.92,15.92,0,0,0,0,29.88L78,178l19,51.62a15.92,15.92,0,0,0,29.88,0l19-51.61,51.65-19a15.92,15.92,0,0,0,0-29.88ZM140.39,163a15.87,15.87,0,0,0-9.43,9.43l-19,51.46L93,172.39A15.87,15.87,0,0,0,83.61,163h0L32.15,144l51.46-19A15.87,15.87,0,0,0,93,115.61l19-51.46,19,51.46a15.87,15.87,0,0,0,9.43,9.43l51.46,19ZM144,40a8,8,0,0,1,8-8h16V16a8,8,0,0,1,16,0V32h16a8,8,0,0,1,0,16H184V64a8,8,0,0,1-16,0V48H152A8,8,0,0,1,144,40ZM248,88a8,8,0,0,1-8,8h-8v8a8,8,0,0,1-16,0V96h-8a8,8,0,0,1,0-16h8V72a8,8,0,0,1,16,0v8h8A8,8,0,0,1,248,88Z"></path></svg>
                                                                        </div>
                                                                        <span>Download</span>
                                                                    </div>
                                                                </div>

                                                                <div id="downloadTab" class="content-section" style="display: flex;flex-direction: column;justify-content: space-between;flex: 1 1 auto;padding: calc(1.5vh * var(--scale-factor-h));gap: calc(1.5vh * var(--scale-factor-h));">
                                                                    <div id="featuresContainer" style="display: flex;flex-direction: column;gap: calc(1.5vh * var(--scale-factor-h));flex: 1 1 auto;overflow-y: auto;max-height: 100%;padding-right: calc(0.75vh* var(--scale-factor-h));height: 0;">
                                                                        <div id="outputSection" style="--degree: 135deg;height: 100%;display: grid;grid-template-rows: 1fr auto;gap: calc(2vh* var(--scale-factor-h));border-color: white;">
                                                                            <div class="card-container background-non-hover-for-card" style="display: block;height: 100%;width: 100%;">
                                                                                <div class="card" style="position: relative;">
                                                                                    <div class="card-content card-remove-hover" style="--degree: -135deg;justify-content: center;padding: 0;border-color: white;">
                                                                                        <div id="outputs_beforeInit"  style="width: 100%;height: 100%;display: flex;justify-content: center;align-items: center;">
                                                                                            <div style="display: flex;align-items: center;gap: calc(1vh * var(--scale-factor-h));flex-direction: column;">
                                                                                                <svg style="width: 6vh;" viewBox="0 0 49 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M44.5393 33.64L38.2793 19C37.1393 16.32 35.4393 14.8 33.4993 14.7C31.5793 14.6 29.7193 15.94 28.2993 18.5L24.4993 25.32C23.6993 26.76 22.5593 27.62 21.3193 27.72C20.0593 27.84 18.7993 27.18 17.7793 25.88L17.3393 25.32C15.9193 23.54 14.1593 22.68 12.3593 22.86C10.5593 23.04 9.0193 24.28 7.9993 26.3L4.5393 33.2C3.2993 35.7 3.4193 38.6 4.8793 40.96C6.3393 43.32 8.8793 44.74 11.6593 44.74H37.1793C39.8593 44.74 42.3593 43.4 43.8393 41.16C45.3593 38.92 45.5993 36.1 44.5393 33.64Z" fill="#EFF6FF" fill-opacity="0.25"></path><path d="M14.4402 16.76C18.1736 16.76 21.2002 13.7334 21.2002 9.99999C21.2002 6.26655 18.1736 3.23999 14.4402 3.23999C10.7067 3.23999 7.68018 6.26655 7.68018 9.99999C7.68018 13.7334 10.7067 16.76 14.4402 16.76Z" fill="#EFF6FF" fill-opacity="0.25"></path></svg>
                                                                                                <small style="color: grey;">Your output will display here!</small>
                                                                                            </div>
                                                                                        </div>
                                                                                        <div id="outputs_afterInit" style="display: none; width: 100%; height: 100%; justify-content: center;"></div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                            <div class="card-container background-non-hover-for-card" style="display: block;height: 100%;width: 100%;">
                                                                                <div class="card" style="position: relative;">
                                                                                    <div class="card-content card-remove-hover" style="--degree: -45deg;justify-content: center;border-color: white;min-height: calc(var(--input-size) + (var(--input-margin)));padding: 0;justify-content: flex-start;">
                                                                                        <div style="display: flex;">
                                                                                            <div class="outputs" style="flex-direction: column;width: 100%;align-items: flex-start;overflow: auto hidden !important;display: flex;align-content: flex-start;max-width: unset;"></div>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div style="display: flex;gap: calc(1.5vh * var(--scale-factor-h));flex-direction: column;">
                                                                        <div class="line"></div>
                                                                        <div style="display: flex;gap: calc(1.5vh * var(--scale-factor-h));flex-direction: row;">
                                                                            <button disabled class="wide" id="viewOutput">
                                                                                <span>Preview</span>
                                                                            </button>
                                                                            <button class="wide important" id="downloadOutput">
                                                                                <span>Download</span>
                                                                            </button>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                        </div>
                                    `);
            }

            loadPageContent(setUser, retrieveImageFromURL, getUserInternetProtocol, ensureUniqueId, fetchServerAddress, getFirebaseModules, getDocSnapshot, getScreenMode, getCurrentMain, updateContent, createPages, setNavbar, setSidebar, showSidebar, removeSidebar, getSidebarActive, moveMains, setupMainSize, loadScrollingAndMain, showZoomIndicator, setScaleFactors, clamp, setAuthentication, updateMainContent, savePageState);

            const mainContainers = document.querySelectorAll('.main-container');
            mainContainers.forEach((mainContainer, id) => {
                mainContainer.style.justifyContent = 'flex-start';
            });

            window.addEventListener('beforeunload', () => { savePageState(); });
            window.addEventListener('pagehide', () => { savePageState(); });

            document.addEventListener('click', () => { savePageState(); });
            document.addEventListener('touchend', () => { savePageState(); });

            const creditPerTotalFrames = 30;
            const STATUS_OK = 200;

            function loadPageState() {
                setMaxWidth();

                document.querySelectorAll('.tab-container').forEach((container, containerIndex) => {
                    const tabs = container.querySelectorAll('.tab');
                    const storageKey = `activeTab_${containerIndex}_${pageName}`;

                    // Determine which tab should be active: saved state, then current active class, then default to the first tab.
                    let defaultTabId = localStorage.getItem(storageKey);
                    if (!defaultTabId) {
                        const activeTab = container.querySelector('.tab.active');
                        defaultTabId = activeTab ? activeTab.getAttribute('for') : tabs[0].getAttribute('for');
                    }

                    // Set the active state on tabs based on defaultTabId.
                    tabs.forEach(tab => {
                        const tabFor = tab.getAttribute('for');
                        tab.classList.toggle('active', tabFor === defaultTabId);
                    });

                    // Display the appropriate content section.
                    container.querySelectorAll('.content-section').forEach(section => {
                        section.style.display = (section.id === defaultTabId) ? 'flex' : 'none';
                    });

                    // Add click event listeners to update state and persist the active tab.
                    tabs.forEach(tab => {
                        tab.onclick = () => {
                            // Remove active class from all tabs and add it to the clicked one.
                            tabs.forEach(t => t.classList.remove('active'));
                            tab.classList.add('active');

                            // Determine the target content section id.
                            const targetId = tab.getAttribute('for');

                            // Update content section display based on the clicked tab.
                            container.querySelectorAll('.content-section').forEach(section => {
                                section.style.display = (section.id === targetId) ? 'flex' : 'none';
                            });

                            // Save the active tab state.
                            localStorage.setItem(storageKey, targetId);
                        };
                    });
                });


                const pageData = localStorage.getItem(pageName) || null;
                if (pageData) {
                    const state = JSON.parse(pageData || '{}') || {};

                    const removeBanner = document.getElementById('removeBanner');
                    if (removeBanner) removeBanner.checked = state.removeBanner || false;

                    const showServers = document.getElementById('showServers');
                    if (showServers) showServers.checked = state.showServers || false;

                    const enhanceResolution = document.getElementById('enhanceResolution');
                    if (enhanceResolution) enhanceResolution.checked = state.enhanceResolution || false;

                    const enhanceDetails = document.getElementById('enhanceDetails');
                    if (enhanceDetails) enhanceDetails.checked = state.enhanceDetails || false;

                    const generateAudio = document.getElementById('generateAudio');
                    if (generateAudio) generateAudio.checked = state.generateAudio || false;

                    const positivePrompt = document.getElementById('positivePrompt');
                    if (positivePrompt) positivePrompt.value = state.positivePrompt || '';

                    const negativePrompt = document.getElementById('negativePrompt');
                    if (negativePrompt) negativePrompt.value = state.negativePrompt || '';

                    const positiveAudioPrompt = document.getElementById('positiveAudioPrompt');
                    if (positiveAudioPrompt) positiveAudioPrompt.value = state.positiveAudioPrompt || '';

                    const negativeAudioPrompt = document.getElementById('negativeAudioPrompt');
                    if (negativeAudioPrompt) negativeAudioPrompt.value = state.negativeAudioPrompt || '';

                    document.querySelectorAll('.nav-links .text').forEach(link => {
                        if (state.activeLinks.includes(link.getAttribute('for'))) {
                            link.classList.add('active');

                            const targetSection = document.getElementById(link.getAttribute('for'));
                            if (targetSection) {
                                targetSection.style.display = 'flex';
                            }
                        }
                    });

                    const multiboxQuery = document.querySelectorAll('.multibox');
                    multiboxQuery.forEach((multibox, id) => {
                        const btnText = multibox.querySelector('.multibox-text');
                        const items = multibox.querySelectorAll('.item');

                        if (state.multiboxes && state.multiboxes[id]) {
                            if (btnText) btnText.innerText = state.multiboxes[id].text || '';

                            if (state.multiboxes[id].open) {
                                multibox.classList.add('open');
                                const listItems = multibox.querySelector('.list-items');
                                if (listItems) listItems.style.display = 'flex';
                            } else {
                                multibox.classList.remove('open');
                                const listItems = multibox.querySelector('.list-items');
                                if (listItems) listItems.style.display = 'none';
                            }

                            state.multiboxes[id].items.forEach((itemState, itemIndex) => {
                                if (itemIndex < items.length) {
                                    const checkbox = items[itemIndex].querySelector('input[type="checkbox"]');
                                    if (checkbox) {
                                        checkbox.checked = itemState.checked;
                                        items[itemIndex].classList.toggle('checked', checkbox.checked);
                                    }
                                }
                            });
                        }
                    });

                    const comboboxQuery = document.querySelectorAll('.combobox');
                    comboboxQuery.forEach((combobox, id) => {
                        const btnText = combobox.querySelector('.combobox-text');
                        const items = combobox.querySelectorAll('.item');

                        if (state.comboboxes && state.comboboxes[id]) {
                            if (btnText) btnText.innerText = state.comboboxes[id].text || '';

                            if (state.comboboxes[id].open) {
                                combobox.classList.add('open');
                                const listItems = combobox.querySelector('.list-items');
                                if (listItems) listItems.style.display = 'flex';
                            } else {
                                combobox.classList.remove('open');
                                const listItems = combobox.querySelector('.list-items');
                                if (listItems) listItems.style.display = 'none';
                            }

                            state.comboboxes[id].items.forEach((itemState, itemIndex) => {
                                if (itemIndex < items.length) {
                                    const checkbox = items[itemIndex].querySelector('input[type="checkbox"]');
                                    if (checkbox) {
                                        checkbox.checked = itemState.checked;
                                        items[itemIndex].classList.toggle('checked', checkbox.checked);
                                    }
                                }
                            });
                        }
                    });
                } else {
                    const checkboxIds = [
                        'enhanceResolution',
                        'enhanceDetails',
                        'generateAudio',
                    ];

                    checkboxIds.forEach(id => {
                        const checkbox = document.getElementById(id);
                        if (checkbox) {
                            checkbox.checked = true;
                            setTimeout(() => { checkbox.dispatchEvent(new Event('change')); }, 0);
                        }
                    });
                }
            }

            const databases = [
                { indexName: `outputDB-${pageName}`, objectStore: 'outputs' }
            ];

            window.addEventListener('beforeunload', async () => { await saveCountIndex(databases); });
            window.addEventListener('pagehide', async () => { await saveCountIndex(databases); });

            document.addEventListener('click', async () => { await saveCountIndex(databases); });
            document.addEventListener('touchend', async () => { await saveCountIndex(databases); });

            checkServerStatus(databases, userData?.uid);
            setDynamicInterval(databases, userData?.uid);

            async function loadPage() {
                const removeDataButton = document.getElementById('removeData');
                if (removeDataButton)
                    removeDataButton.addEventListener('click', () => cleanSiteData(false));

                document.querySelectorAll('.question-mark').forEach(questionMark => {
                    questionMark.addEventListener('click', (event) => {
                        event.stopPropagation();
                    });
                });

                document.querySelector('.outputs').addEventListener('click', async function (event) {
                    await handleFileContainerEvents(event, `outputDB-${pageName}`, 'outputs', document.querySelector('.outputs'), databases);
                });

                const showServers = document.getElementById('showServers');
                const serverListContainer = document.getElementById('serverList');
                serverListContainer.style.display = showServers.checked ? 'block' : 'none';

                showServers.addEventListener('click', async () => {
                    serverListContainer.style.display = showServers.checked ? 'block' : 'none';
                });

                databases.forEach(db => initDB(db.indexName, db.objectStore, handleDownload, databases));
                createSectionAndElements();

                const removeBannerCheckbox = document.getElementById("removeBanner");
                if (removeBannerCheckbox && userDoc?.paid && localStorage.getItem(`bannerChecked_${pageName}`) === null) {
                    removeBannerCheckbox.checked = true;
                    localStorage.setItem(`bannerChecked_${pageName}`, "true");
                }

                const negativeSVG = document.getElementById('negativeSVG');
                const negativePrompt = document.getElementById('negativePrompt');

                if (!localStorage.getItem('negativePromptSet')) {
                    if (negativePrompt) {
                        negativePrompt.value = `bright colors, overexposed, static, blurred details, subtitles, style, artwork, painting, picture, still, overall gray, worst quality, low quality, JPEG compression residue, ugly, incomplete, extra fingers, poorly drawn hands, poorly drawn faces, deformed, disfigured, malformed limbs, fused fingers, still picture, cluttered background, three legs, walking backwards`;
                        localStorage.setItem('negativePromptSet', '1');
                    }
                }

                let isNegativeVisible = localStorage.getItem('negativePromptVisible') !== 'false';
                updateVisibility(isNegativeVisible, negativeSVG, negativePrompt, false); // Initial load without transition

                negativeSVG.addEventListener('click', () => {
                    isNegativeVisible = !isNegativeVisible;
                    localStorage.setItem('negativePromptVisible', isNegativeVisible);
                    updateVisibility(isNegativeVisible, negativeSVG, negativePrompt, true); // Apply transition on interaction
                });

                const negativeAudioPrompt = document.getElementById('negativeAudioPrompt');
                const negativeAudioSVG = document.getElementById('negativeAudioSVG');

                let isAudioVisible = localStorage.getItem('negativePromptVisible') !== 'false';
                updateVisibility(isAudioVisible, negativeAudioSVG, negativeAudioPrompt, false); // Initial load without transition

                negativeAudioSVG.addEventListener('click', () => {
                    isAudioVisible = !isAudioVisible;
                    localStorage.setItem('negativeAudioPromptVisible', isAudioVisible);
                    updateVisibility(isAudioVisible, negativeAudioSVG, negativeAudioPrompt, true); // Apply transition on interaction
                });

                function updateVisibility(isVisible, negativeSVG, negativePrompt, withTransition) {
                    negativePrompt.style.display = isVisible ? 'block' : 'none';
                    negativeSVG.style.transform = isVisible ? 'rotate(0deg)' : 'rotate(180deg)';
                    if (withTransition) {
                        negativeSVG.style.transition = 'transform 0.3s ease';
                    } else {
                        negativeSVG.style.transition = 'none';
                    }
                }

                const startProcessBtn = document.getElementById('startProcessBtn');

                function updateGenerateButtonText() {
                    const quality = +getCheckedCheckboxIdFromCombobox('quality', 1);
                    const duration = +getCheckedCheckboxIdFromCombobox('duration', 3);

                    const removeBanner = document.getElementById('removeBanner').checked;
                    const enhanceResolution = document.getElementById('enhanceResolution').checked;
                    const enhanceDetails = document.getElementById('enhanceDetails').checked;
                    const generateAudio = document.getElementById('generateAudio').checked;
                    const audioContainer = document.getElementById('audioContainer');
                    audioContainer.style.display = !generateAudio ? 'none' : 'unset';

                    let neededCredits = 2;
                    neededCredits *= duration;

                    if (removeBanner) neededCredits *= 2;

                    neededCredits = Math.max(1, Math.ceil(neededCredits));

                    const span = document.getElementById('startProcessBtn')?.querySelector('span');
                    if (span) {
                        span.textContent = `Generate (${neededCredits} Credit${neededCredits > 1 ? 's' : ''})`;
                    }
                }

                updateGenerateButtonText();

                ['removeBanner', 'enhanceResolution', 'enhanceDetails', 'generateAudio'].forEach(id => {
                    const el = document.getElementById(id);
                    if (el) el.addEventListener('change', updateGenerateButtonText);
                });

                ['quality', 'duration', 'aspectRatio'].forEach(id => {
                    const box = document.getElementById(id);
                    if (box) {
                        box.addEventListener('click', e => {
                            if (e.target.closest('li.item')) {
                                setTimeout(updateGenerateButtonText, 0);
                            }
                        });
                    }
                });

                async function startProcess() {
                    startProcessBtn.disabled = true;

                    try {
                        showNotification(`Starting the process...`, 'Process - Information', 'information');

                        if (typeof userData !== 'object' || !userData?.uid) {
                            const openSignInContainer = document.getElementById('openSignInContainer');
                            if (openSignInContainer)
                                openSignInContainer.click();
                            startProcessBtn.disabled = false;
                            showNotification(`Please sign in or create an account to use our AI services with free (daily) trial.`, 'Warning - No User Found', 'warning-important');
                            return;
                        }

                        const dataContainer = document.createElement('div');
                        dataContainer.className = 'data-container';

                        const processText = document.createElement('div');
                        processText.className = 'process-text';
                        dataContainer.appendChild(processText);

                        const outputs = document.querySelector('.outputs');
                        outputs.style.display = 'flex';
                        outputs.insertBefore(dataContainer, outputs.firstChild);

                        if (!userData.emailVerified) {
                            setClientStatus('Verify Your Email');
                            showNotification(`Please verify your email.`, 'Warning - No Input Selected', 'warning-important');
                            startProcessBtn.disabled = false;
                            return;
                        }

                        const downloadTab = document.querySelector('.tab[for="downloadTab"]');
                        if (!downloadTab.classList.contains('active')) {
                            const processTabChild = document.getElementById('processTab');
                            processTabChild.style.display = 'none';

                            const downloadTabChild = document.getElementById('downloadTab');
                            downloadTabChild.style.display = 'flex';

                            const processTab = document.querySelector('.tab[for="processTab"]');
                            processTab.classList.remove('active');
                            downloadTab.classList.add('active');
                        }

                        userDoc = await getUserDoc();

                        const quality = getCheckedCheckboxIdFromCombobox('quality', 1);
                        const duration = getCheckedCheckboxIdFromCombobox('duration', 3);
                        const aspectRatio = getCheckedCheckboxIdFromCombobox('aspectRatio', '16:9');

                        const removeBanner = document.getElementById('removeBanner').checked;
                        const enhanceResolution = document.getElementById('enhanceResolution').checked;
                        const enhanceDetails = document.getElementById('enhanceDetails').checked;
                        const generateAudio = document.getElementById('generateAudio').checked;

                        let neededCredits = 2;
                        neededCredits *= duration;

                        if (removeBanner)
                            neededCredits *= 2;

                        neededCredits = Math.max(1, neededCredits);

                        async function getServerAddresses() {
                            try {
                                const snapshotPromise = getDocsSnapshot('servers');
                                const keepSlowServers = true;

                                return await fetchServerAddresses(snapshotPromise, keepSlowServers);
                            } catch (error) {
                                showNotification(`Failed to get server addresses.`, 'Warning', 'warning');
                                return null;
                            }
                        }

                        let userInternetProtocol, userUniqueBrowserId, serverAddresses;

                        const timeoutDuration = 15000;
                        let remainingTime = timeoutDuration / 1000;

                        const countdownInterval = setInterval(() => {
                            setClientStatus(`Creating ID... ${remainingTime}`);
                            remainingTime--;
                        }, 1000);

                        const timeout = new Promise((_, reject) =>
                            setTimeout(() => reject(new Error('Process took longer than 15 seconds.')), timeoutDuration)
                        );

                        try {
                            setClientStatus('Creating ID...');
                            showNotification("Creating ID's...", 'Process - Information', 'information');

                            [userInternetProtocol, userUniqueBrowserId, serverAddresses] = await Promise.race([
                                Promise.all([
                                    getUserInternetProtocol(),
                                    ensureUniqueId(),
                                    getServerAddresses()
                                ]),
                                timeout
                            ]);
                        } catch (error) {
                            showNotification(
                                `Failed to create IDs. Consider disabling extensions or Adblockers. ${error.message}`,
                                'Warning',
                                'warning'
                            );
                            return;
                        } finally {
                            clearInterval(countdownInterval);
                        }

                        const proxyNotifications = {
                            isTOR: {
                                message: "TOR users restricted due to multi-accounting concerns. Disable TOR to avoid issues.",
                                title: 'Warning - Proxy',
                                type: 'warning-important'
                            },
                            isVPN: {
                                message: "Using a VPN may cause errors, slow processes, and affect downloads. Consider disabling your VPN for improved performance.",
                                title: 'Warning - VPN',
                                type: 'warning-important'
                            },
                            isProxy: {
                                message: "Using a proxy may cause errors, slow processes, and affect downloads. Consider disabling your proxy for better performance.",
                                title: 'Warning - Proxy',
                                type: 'warning-important'
                            }
                        };

                        for (const [key, { message, title, type }] of Object.entries(proxyNotifications)) {
                            if (userInternetProtocol[key]) {
                                showNotification(message, title, type);
                            }
                        }

                        const suffixOrder = ["s", "d", "f", "g", "h", "j", "k", "l"];
                        const serverId = serverID().toLowerCase();

                        const parsedServers = serverAddresses.map(addr => {
                            const regex = new RegExp(`https:\/\/([^/]+)-(\\d+)-${serverId}\\.deepany\\.ai`, "i");
                            const match = addr.match(regex);
                            if (!match) {
                                return { addr, major: 0, minor: 0, index: Infinity, suffix: "" };
                            }
                            const [, model, indexStr] = match;
                            const index = parseInt(indexStr, 10);
                            const parts = model.split('-');
                            const gpuNumber = parseInt(parts[0], 10);
                            const suffix = parts[1] ? parts[1].toLowerCase() : "";

                            const major = Math.floor(gpuNumber / 100);
                            const minor = gpuNumber % 100;

                            return { addr, major, minor, index, suffix };
                        });

                        function getSuffixRank(s) {
                            if (!s) return -1;
                            const pos = suffixOrder.indexOf(s);
                            return pos === -1 ? -1 : (suffixOrder.length - pos);
                        }

                        parsedServers.sort((a, b) => {
                            if (a.index !== b.index) return a.index - b.index;
                            if (a.major !== b.major) return b.major - a.major;
                            if (a.minor !== b.minor) return b.minor - a.minor;
                            return getSuffixRank(b.suffix) - getSuffixRank(a.suffix);
                        });

                        let sortedServerAddresses = parsedServers.map(p => p.addr.toLowerCase());
                        let serverQueueResults = await Promise.all(
                            sortedServerAddresses.map(server => checkServerQueue(server))
                        );

                        function getGroupKey(addr) {
                            const match = addr.match(/https:\/\/(\d+)(?:-([a-z]+))?-/i);
                            if (!match) return '';
                            const gpu = match[1];
                            const suffix = match[2] ? match[2].toLowerCase() : "";
                            return suffix ? `${gpu}-${suffix}` : gpu;
                        }

                        const groupAggregates = {};
                        sortedServerAddresses.forEach((server, i) => {
                            const key = getGroupKey(server);
                            if (!groupAggregates[key]) groupAggregates[key] = 0;
                            if (serverQueueResults[i])
                                groupAggregates[key] += 1;
                        });

                        function effectiveQueue(server) {
                            const key = getGroupKey(server);
                            const groupQ = (groupAggregates[key] || 0);
                            return groupQ;
                        }

                        const adjustQueue = (server) => {
                            return serverQueueResults[sortedServerAddresses.indexOf(server)] + (effectiveQueue(server) / 2);
                        };

                        const adjustedQueues = sortedServerAddresses.map(server => adjustQueue(server));

                        const minQueueIndex = adjustedQueues.reduce((minIndex, queue, id, arr) =>
                            queue < arr[minIndex] ? id : minIndex,
                            0
                        );

                        if (adjustedQueues[minQueueIndex] === Infinity) {
                            startProcessBtn.disabled = false;
                            setClientStatus("Offline");
                            showNotification(
                                `Cannot fetch the server. A VPN could cause this or our server is currently offline. Contact an admin for more information.`,
                                "Warning - Process Failed",
                                "warning-important"
                            );
                            return;
                        }

                        const userName = userDoc.username.replace(/[^a-zA-Z0-9_]/g, '');
                        const fileOutputId = `${Math.random().toString(36).substring(2, 15)}_${userName}_${neededCredits}_${0}`;

                        setFetchableServerAdresses([sortedServerAddresses[minQueueIndex]]);
                        const serverAddress = getFetchableServerAdresses()[0];
                        setFetchableServerAdresses([serverAddress]);
                        setClientStatus(`Connecting`);
                        showNotification(`Connecting to ${serverAddress}...`, "Process - Information", "information");

                        const positivePrompt = document.getElementById("positivePrompt").value;
                        if (!positivePrompt) {
                            startProcessBtn.disabled = false;
                            setClientStatus('Enter Prompt');
                            showNotification(`Please enter a prompt before proceeding.`, 'Error - Missing Prompt', 'error');
                            return;
                        }

                        const positiveAudioPrompt = document.getElementById("positiveAudioPrompt").value;
                        const negativeAudioPrompt = document.getElementById("negativeAudioPrompt").value;
                        const negativePrompt = document.getElementById("negativePrompt").value;

                        const formData = new FormData();
                        formData.append('userId', userData.uid);
                        formData.append('userInternetProtocolAddress', userInternetProtocol.userInternetProtocolAddress);
                        formData.append('userUniqueInternetProtocolId', userInternetProtocol.userUniqueInternetProtocolId);
                        formData.append('userUniqueBrowserId', userUniqueBrowserId);
                        formData.append('fileOutputId', fileOutputId);
                        formData.append('generateAudio', generateAudio);
                        formData.append('enhanceResolution', enhanceResolution);
                        formData.append('enhanceDetails', enhanceDetails);
                        formData.append('positiveAudioPrompt', positiveAudioPrompt);
                        formData.append('negativeAudioPrompt', negativeAudioPrompt);
                        formData.append('positivePrompt', positivePrompt);
                        formData.append('negativePrompt', negativePrompt);
                        formData.append('quality', quality);
                        formData.append('duration', duration);
                        formData.append('aspectRatio', aspectRatio);
                        formData.append('removeBanner', removeBanner);

                        showNotification(`Sending your configuration to the server...`, 'Upload', 'information');
                        setClientStatus('Configurating...');

                        const response = await fetchWithRandom(`${serverAddress}/start-process`, {
                            method: 'POST',
                            body: formData
                        });

                        if (response.status !== STATUS_OK) {
                            const data = await response.json();
                            throw new Error(data.server);
                        }

                        const result = await response.json();
                        showNotification(`Creating output database using IndexedDB...`, 'Database - IndexedDB', 'information');

                        const db = await openDB(`outputDB-${pageName}`, 'outputs');
                        const url = serverAddress + '/download-output/' + fileOutputId;
                        const firstChild = outputs.firstChild;

                        if (firstChild && !firstChild.dataset.created) {
                            firstChild.dataset.created = true;
                            firstChild.innerHTML = `<div class="process-text">Indexing</div>`;

                            await addToDB(db, [null, url]);
                            await saveCountIndex(databases);

                            const data = await getFromDB(db);
                            const entry = data.find(item => item.url === url);
                            firstChild.innerHTML = `<initial url="${entry.url}" id="${entry.id}" timestamp="${entry.timestamp}" processing></initial><div class="process-text">Indexing</div><div class="delete-icon"></div>`;
                        }

                        showNotification(`Starting the process...`, 'Upload', 'information');
                        setClientStatus('Starting...');
                        updateDownloadFile(true, databases, userData.uid);
                        return result;
                    } catch (error) {
                        startProcessBtn.disabled = false;
                        setClientStatus(error.message);
                        cancelProcess(false);
                    }
                }

                if (startProcessBtn)
                    startProcessBtn.addEventListener('click', async () => {
                        await startProcess();
                    });

                const cancelProcessBtn = document.getElementById('cancelProcessBtn');
                if (cancelProcessBtn)
                    cancelProcessBtn.addEventListener('click', async () => {
                        await cancelProcess(true);
                    });

                const downloadOutput = document.getElementById('downloadOutput');
                if (downloadOutput) {
                    const activeDataContainer = document.querySelector(".outputs .data-container.active");
                    if (!activeDataContainer) {
                        downloadOutput.disabled = true;
                        //showNotification(`Maintaince for IOS downloads (Not important if you are not IOS).`, 'Warning - Download', 'warning');
                    }

                    downloadOutput.addEventListener('click', async () => {
                        const activeDataContainer = document.querySelector(".outputs .data-container.active");
                        if (!activeDataContainer) {
                            showNotification(`No active output container selected.`, 'Warning - Download', 'warning');
                            return;
                        }

                        const activeInput = activeDataContainer.querySelector('img, video, initial');
                        if (!activeInput) {
                            showNotification(`No active input element found.`, 'Warning - Download', 'warning');
                            return;
                        }

                        if (downloadOutput.textContent === "Pause") {
                            const abortController = getAbortController();
                            if (abortController) {
                                abortController.abort();
                                resetAbortController();
                                setDownloadCancelled(true);
                                showNotification(`Download paused successfully.`, 'Download - Paused', 'info');
                            } else {
                                showNotification(`No active download to pause.`, 'Warning - Pause', 'warning');
                            }

                            downloadOutput.textContent = "Resume";
                            downloadOutput.classList.add("important");
                            return;
                        }

                        if (downloadOutput.textContent === "Resume") {
                            const selectedOutputInfo = {
                                db: await openDB(`outputDB-${pageName}`, 'outputs'),
                                url: activeInput.getAttribute('url'),
                                timestamp: parseInt(activeInput.getAttribute('timestamp')),
                                element: activeInput.parentElement,
                                id: parseInt(activeInput.getAttribute('id')),
                                active: activeInput.getAttribute('active'),
                            };

                            showNotification(`Resuming download for output ID: ${selectedOutputInfo.id}.`, 'Download - Resuming', 'info');
                            return await handleDownload(selectedOutputInfo);
                        }

                        if (activeInput) {
                            const id = activeInput.getAttribute('id');
                            const fileName = 'output_' + `${id}.${activeInput.tagName === 'VIDEO' ? 'mp4' : 'png'}`;

                            const domIndex = parseInt(activeInput.getAttribute('id'));
                            const db = await openDB(`outputDB-${pageName}`, 'outputs');
                            const items = await getFromDB(db);
                            const item = items.find(item => item.id === domIndex);
                            if (!item || !item.blob) {
                                throw new Error(`No blob found for ID: ${domIndex}`);
                            }

                            let type = '';
                            if (activeInput) {
                                if (activeInput.tagName === 'IMG') {
                                    type = 'image/png';
                                } else if (activeInput.tagName === 'VIDEO') {
                                    type = 'video/mp4';
                                } else {
                                    showNotification('Error: Unsupported element type for download.', 'Error - Download', 'error');
                                    return;
                                }
                            }
                            let methodUsed = 0;
                            try {
                                if (window.showSaveFilePicker) {
                                    methodUsed = 1;
                                    showNotification('Attempting to use showSaveFilePicker...', 'Download - Info', 'info');

                                    const fileHandle = await window.showSaveFilePicker({
                                        suggestedName: fileName,
                                        types: [
                                            { description: 'Video Files', accept: { 'video/mp4': ['.mp4'], 'video/webm': ['.webm'] } },
                                            { description: 'Image Files', accept: { 'image/png': ['.png'], 'image/jpeg': ['.jpg'] } },
                                        ],
                                    });

                                    const writableStream = await fileHandle.createWritable();
                                    await writableStream.write(item.blob);
                                    await writableStream.close();
                                    showNotification(`File saved successfully: ${fileName}`, 'Download - Success', 'success');
                                } else if (navigator.share) {
                                    methodUsed = 2;
                                    showNotification('Attempting to use navigator.share...', 'Download - Info', 'info');

                                    const fileToShare = new File([item.blob], fileName, { type });
                                    await navigator.share({ title: fileName, files: [fileToShare] });
                                    showNotification(`File shared successfully: ${fileName}`, 'Download - Shared', 'success');
                                } else {
                                    methodUsed = 3;
                                    showNotification('Attempting to use <a> tag for download...', 'Download - Info', 'info');

                                    const objectURL = URL.createObjectURL(item.blob);
                                    const a = document.createElement('a');
                                    a.href = objectURL;
                                    a.download = fileName;
                                    document.body.appendChild(a);
                                    a.click();
                                    document.body.removeChild(a);
                                    URL.revokeObjectURL(objectURL);
                                    showNotification(`File downloaded successfully: ${fileName}`, 'Download - Success', 'success');
                                }
                            } catch (error) {
                                if (error.name === 'AbortError') {
                                    showNotification(`Download was aborted for: ${fileName}`, 'Error - Aborted', 'error');
                                    return;
                                }

                                showNotification(`First method failed (Error: ${error.message} - Method: ${methodUsed}), retrying in 1000ms for file: ${fileName}...`, 'Error - Download', 'error');
                                setTimeout(() => {
                                    const objectURL = URL.createObjectURL(item.blob);
                                    const a = document.createElement('a');
                                    a.href = objectURL;
                                    a.download = fileName;

                                    if (!iosMobileCheck()) {  // Only execute this on non-iOS devices
                                        try {
                                            document.body.appendChild(a);
                                            a.click();
                                            document.body.removeChild(a);
                                            URL.revokeObjectURL(objectURL);
                                            showNotification(`File downloaded successfully: ${fileName}`, 'Download - Success', 'success');
                                        } catch (error) {
                                            showNotification(`Failed to download the file (Error: ${error.message})`, 'Error - Download', 'error');
                                        }
                                    } else {
                                        showNotification(`Skipping download method for iOS devices: ${fileName}`, 'Download - Info', 'info');
                                        try {
                                            const newTab = window.open(objectURL, '_blank');
                                            if (!newTab) {
                                                showNotification(`Failed to open the file in a new tab for: ${fileName}`, 'Error - Open Tab', 'error');
                                            } else {
                                                setTimeout(() => {
                                                    URL.revokeObjectURL(objectURL);
                                                }, 1000);
                                            }
                                        } catch (tabError) {
                                            showNotification(`Failed to open in a new tab (Error: ${tabError.message})`, 'Error - Tab Open', 'error');
                                        }
                                    }
                                }, 1000);
                            }
                        } else {
                            showNotification(`No output is selected.`, 'Warning - Download', 'warning');
                        }
                    });
                }

                const viewOutput = document.getElementById('viewOutput');
                if (viewOutput) {
                    const activeDataContainer = document.querySelector(".outputs .data-container.active");
                    if (!activeDataContainer) viewOutput.disabled = true;

                    viewOutput.addEventListener('click', async () => {
                        const activeDataContainer = document.querySelector(".outputs .data-container.active");
                        const activeInput = activeDataContainer.querySelector('img, video, initial');

                        if (activeInput) {
                            if (viewOutput.textContent === 'Fetch') {
                                const abortController = getAbortController();
                                if (abortController) {
                                    abortController.abort();
                                    resetAbortController();
                                    downloadOutput.textContent = "Resume";
                                    setDownloadCancelled(true);
                                }

                                return window.open(activeInput.getAttribute('url'), '_blank');
                            }

                            if (activeInput.tagName === 'INITIAL') {
                                alert('Initial element cannot be viewed.');
                                return;
                            }

                            const existingWrapper = document.getElementById('wrapper');
                            if (existingWrapper) return;

                            const wrapper = document.createElement('div');
                            wrapper.id = 'wrapper';

                            const backgroundContainer = document.createElement('div');
                            backgroundContainer.className = 'background-container';

                            const backgroundDotContainer = document.createElement('a');
                            backgroundDotContainer.className = 'background-dot-container';

                            const backgroundDotContent = document.createElement('div');
                            backgroundDotContent.className = 'background-dot-container-content';
                            backgroundDotContent.style.padding = '0';

                            const innerContainer = document.createElement('div');
                            innerContainer.className = 'background-container';
                            innerContainer.style.display = 'contents';
                            innerContainer.id = 'innerContainer';

                            let mediaElement;

                            if (activeInput.tagName === 'VIDEO') {
                                mediaElement = document.createElement('video');
                                mediaElement.controls = true;
                                mediaElement.loop = true;
                                mediaElement.src = activeInput.querySelector('source').src;
                                mediaElement.style.maxWidth = '100vw';
                                mediaElement.style.maxHeight = '94vh';
                                mediaElement.style.borderRadius = 'var(--border-radius)';
                                mediaElement.style.objectFit = 'cover';
                            } else if (activeInput.tagName === 'IMG') {
                                mediaElement = document.createElement('img');
                                mediaElement.src = activeInput.src;
                                mediaElement.style.maxWidth = '100vw';
                                mediaElement.style.maxHeight = '94vh';
                                mediaElement.style.borderRadius = 'var(--border-radius)';
                                mediaElement.style.objectFit = 'cover';
                            }

                            if (!mediaElement.src) {
                                wrapper.remove();
                                alert('Media source not found.');
                                return;
                            }

                            // Close Button
                            const closeButton = document.createElement('button');
                            closeButton.className = 'close-button';
                            closeButton.style.position = 'absolute';
                            closeButton.style.top = '1vh';
                            closeButton.style.right = '1vh';
                            closeButton.style.cursor = 'pointer';
                            closeButton.style.width = '4vh';
                            closeButton.style.height = '4vh';
                            closeButton.style.padding = '0';
                            closeButton.style.margin = '0';

                            const closeButtonIcon = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
                            closeButtonIcon.setAttribute('xmlns', 'http://www.w3.org/2000/svg');
                            closeButtonIcon.setAttribute('viewBox', '0 0 24 24');
                            closeButtonIcon.setAttribute('fill', 'none');
                            closeButtonIcon.setAttribute('stroke', 'currentColor');
                            closeButtonIcon.setAttribute('stroke-width', '2');
                            closeButtonIcon.setAttribute('stroke-linecap', 'round');
                            closeButtonIcon.setAttribute('stroke-linejoin', 'round');
                            closeButtonIcon.style.margin = '0';
                            closeButtonIcon.style.width = 'calc((3.5vh * var(--scale-factor-h)))';
                            closeButtonIcon.classList.add('lucide', 'lucide-x');

                            const path1 = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                            path1.setAttribute('d', 'M18 6 6 18');
                            const path2 = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                            path2.setAttribute('d', 'm6 6 12 12');

                            closeButtonIcon.appendChild(path1);
                            closeButtonIcon.appendChild(path2);

                            closeButton.appendChild(closeButtonIcon);
                            closeButton.addEventListener('click', () => {
                                wrapper.remove();
                            });

                            const reportButton = document.createElement('button');
                            reportButton.className = 'report-button';
                            reportButton.style.position = 'absolute';
                            reportButton.style.bottom = '1vh';
                            reportButton.style.right = '1vh';

                            reportButton.innerHTML = 'Report Content';
                            reportButton.addEventListener('click', () => {
                                showNotification(
                                    `Thank you for reporting inappropriate content. Our moderation team will review the report and take appropriate action.`,
                                    'Reported Content',
                                    'warning-important'
                                );
                                wrapper.remove();
                                const deleteIconParent = activeDataContainer.querySelector('.delete-icon');
                                if (deleteIconParent) {
                                    deleteIconParent.click();
                                }
                            });

                            innerContainer.appendChild(mediaElement);
                            innerContainer.appendChild(closeButton);
                            //innerContainer.appendChild(reportButton);

                            backgroundDotContent.appendChild(innerContainer);
                            backgroundDotContainer.appendChild(backgroundDotContent);
                            backgroundContainer.appendChild(backgroundDotContainer);
                            wrapper.appendChild(backgroundContainer);
                            document.body.appendChild(wrapper);
                        }
                    });
                }

                if (getScreenMode() !== ScreenMode.PC) {
                    const baseContainer = document.getElementById('baseContainer');
                    if (baseContainer)
                        baseContainer.style.gridTemplateColumns = '';
                }
            }

            let previousScreenMode = null;

            async function sizeBasedElements() {
                setMaxWidth();
                const screenMode = getScreenMode();
                const shouldUpdate = previousScreenMode !== screenMode;
                previousScreenMode = screenMode;
                if (!shouldUpdate)
                    return;

                loadPageState();
                loadPage();
            }

            sizeBasedElements();

            window.addEventListener('resize', sizeBasedElements);
        });
    </script>
<script src="scripts/autoTranslate.js"></script></body>
</html>
