<!DOCTYPE html>
<html lang="en" style="background: rgba(24, 24, 24, 1);" class="loading-screen">
<head>
    <link rel="dns-prefetch" href="//deepany.ai">
    <link rel="preconnect" href="https://deepany.ai" crossorigin>

    <title>AI Inpainting: Image & Video Editing | Free & Online</title>
    <link rel="canonical" href="https://deepany.ai/inpaint">

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="DeepAny.AI offers free AI inpainting for images & videos. Restore, remove, or edit objects seamlessly with precision AI toolsâ€”no experience needed. Start editing online today!">
    <meta name="keywords" content="AI inpainting, video inpainting, DeepAny, free inpainting tool, online photo editor, video editor, AI-powered editing, image & video restoration, object removal, seamless edits with AI">
    <meta name="apple-mobile-web-app-title" content="AI Inpaint" />

    <meta property="og:type" content="website">
    <meta property="og:url" content="https://deepany.ai/inpaint">
    <meta property="og:locale" content="en_US">
    <meta property="og:site_name" content="DeepAny.AI">
    <meta property="og:title" content="DeepAny.AI | AI Inpainting for Images & Videos">
    <meta property="og:description" content="Seamlessly restore and edit images & videos with AI-powered inpainting. Free online tool for object removal, restoration, and creative edits.">
    <meta property="og:image" content="https://deepany.ai/assets/brand.png">
    <meta property="og:image:alt" content="DeepAny.AI | AI Inpainting Tool">

    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://deepany.ai/inpaint">
    <meta property="twitter:title" content="DeepAny.AI | AI Inpainting for Images & Videos">
    <meta property="twitter:description" content="Edit images & videos online with AI-driven inpainting. Remove objects, restore details, and make seamless adjustments effortlessly.">
    <meta property="twitter:image" content="https://deepany.ai/assets/brand.png">


    <style id="loading-stylesheet">
        .loading-screen {
            position: fixed;
            top: 50%;
            left: 50%;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #ff7300;
            z-index: 999999;
            border-radius: 50%;
            width: 50px !important;
            height: 50px !important;
            animation: spin 2s linear infinite
        }

        @keyframes spin {
            0% {
                transform: translate(-50%, -50%) rotate(0deg);
            }

            100% {
                transform: translate(-50%, -50%) rotate(360deg);
            }
        }
    </style>
    <link rel="stylesheet" href="css/styles.css?v=5.3.5">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
    <link rel="shortcut icon" href="/favicon.ico?v=5.3.5" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="manifest" href="/site.webmanifest" />
    <script>
        (() => {
            if (!localStorage.getItem('version')) {
                localStorage.setItem('version', '5.3.5');
                return;
            }

            let version = localStorage.getItem('version');
            let url = new URL(window.location.href);
            let urlParams = url.searchParams;
            let urlVersionEncoded = urlParams.get('v');

            if (!urlVersionEncoded || urlVersionEncoded !== version) {
                urlParams.set('v', version);
                url.search = urlParams.toString();
                window.history.replaceState(null, '', url.toString());
            }

            let checkEnabled = true;
            let isInitialLoad = true;

            const checkVersion = async () => {
                if (!checkEnabled) return;

                try {
                    version = localStorage.getItem('version');

                    const response = await fetch(`${window.location.origin}/version?nocache=${Math.random()}`, { cache: 'no-store' });
                    const fetchedVersion = (await response.text()).trim();

                    localStorage.setItem('version', fetchedVersion);

                    if (!urlVersionEncoded || urlVersionEncoded != fetchedVersion || version != fetchedVersion) {
                        if (isInitialLoad) {
                            urlParams.set('v', fetchedVersion);
                            url.search = urlParams.toString();
                            window.location.href = url.toString();
                        } else {
                            const confirmed = confirm(`New version available (${fetchedVersion}). Would you like to reload now?`);
                            if (confirmed) {
                                urlParams.set('v', fetchedVersion);
                                url.search = urlParams.toString();
                                window.location.href = url.toString();
                            } else {
                                checkEnabled = false;
                            }
                        }
                    }
                } catch (err) {
                    console.error('Version check failed:', err);
                }

                isInitialLoad = false;
            };

            checkVersion(); //.then(() => history.replaceState(null, '', location.pathname + location.search.replace(/([?&])v=[^&]*(&|$)/, (m, sep, end) => sep === '?' && end ? '?' : sep === '&' && end ? '' : '')));
            setInterval(checkVersion, 1 * 60 * 1000);
        })();
    </script>
    <style>
        :root {
            --input-size: calc(12vh * var(--scale-factor-h));
            --input-margin: calc(4vh * var(--scale-factor-h));
        }
    </style>
</head>
<body lang="en">
    <script type="module" defer>
        const version = new URLSearchParams(window.location.search).get('version') || localStorage.getItem('version') || '5.3.5';

        async function loadModule(url) {
            return import(`${url}?v=${version}`);
        }

        document.addEventListener('DOMContentLoaded', async function () {
            const functions = await loadModule('./scripts/functions.js');
            const { cannotBeBanned, serverID, fetchWithRandom, hasSubscriptionPlan, getCheckedCheckboxIdFromCombobox, setDownloadCancelled, getAbortController, resetAbortController, pageName, setFetchableServerAdresses, getFetchableServerAdresses, checkServerStatus, setDynamicInterval, updateDownloadFile, cancelProcess, fetchUploadedChunks, processDataToFile, createSectionAndElements, setMaxWidth, saveCountIndex, handleDownload, handleFileContainerEvents, handleUpload, setupFileUpload, setClientStatus, customFetch, checkServerQueue, showNotification, openDB, addToDB, getFromDB, initDB, setUser, getUserData, getUserDoc, setAuthentication, getFirebaseModules, getDocSnapshot, getDocsSnapshot, getScreenMode, getCurrentMain, updateContent, ScreenMode, createPages, setNavbar, setSidebar, showSidebar, removeSidebar, getSidebarActive, moveMains, setupMainSize, loadScrollingAndMain, showZoomIndicator, setScaleFactors, clamp, loadPageContent, retrieveImageFromURL, fetchServerAddress, ensureUniqueId, getUserInternetProtocol, fetchServerAddresses } = functions;

            if (!window.indexedDB) {
                alert('Your browser does not support IndexedDB.');
            }

            function savePageState() {
                const requiredIds = [
                    'removeBanner',
                    'showServers',
                    'losslessEncoder',
                    'randomizeSeed',
                    'promptOptimizations',
                    'invertMask',
                    'depthDetection',
                    'poseDetection',
                    'analyzeImage',
                ];

                if (!requiredIds.every(id => document.getElementById(id))) {
                    return;
                }

                const getCheckboxState = id => document.getElementById(id)?.checked || false; const activeLinks = Array.from(document.querySelectorAll('.nav-links .active')).map(link => link.getAttribute('for') || '');

                const selectedRectangles = Array.from(document.querySelectorAll('.rectangle.selected')).map(rectangle => rectangle.id);

                const state = {
                    invertMask: getCheckboxState('invertMask'),
                    promptOptimizations: getCheckboxState('promptOptimizations'),
                    depthDetection: getCheckboxState('depthDetection'),
                    poseDetection: getCheckboxState('poseDetection'),
                    analyzeImage: getCheckboxState('analyzeImage'),
                    removeBanner: getCheckboxState('removeBanner'),
                    showServers: getCheckboxState('showServers'),
                    losslessEncoder: getCheckboxState('losslessEncoder'),
                    randomizeSeed: getCheckboxState('randomizeSeed'),
                    positivePrompt: document.getElementById('positivePrompt').value,
                    negativePrompt: document.getElementById('negativePrompt').value,
                    maskCustomPositivePrompt: document.getElementById('maskCustomPositivePrompt').value,
                    activeLinks: activeLinks,
                    selectedRectangles: selectedRectangles,
                    rectangles: Array.from(document.querySelectorAll('.rectangle')).map(rectangle => ({
                        text: rectangle.querySelector('h4')?.innerText || '',
                        open: rectangle.classList.contains('open'),
                        items: Array.from(rectangle.querySelectorAll('.item')).map(item => ({
                            checked: item.querySelector('input[type="checkbox"]')?.checked || false,
                        })),
                    })),
                    multiboxes: Array.from(document.querySelectorAll('.multibox')).map(multibox => ({
                        text: multibox.querySelector('.multibox-text')?.innerText || '',
                        open: multibox.classList.contains('open'),
                        items: Array.from(multibox.querySelectorAll('.item')).map(item => ({
                            checked: item.querySelector('input[type="checkbox"]')?.checked || false,
                        })),
                    })),
                    comboboxes: Array.from(document.querySelectorAll('.combobox')).map(combobox => ({
                        text: combobox.querySelector('.combobox-text')?.innerText || '',
                        open: combobox.classList.contains('open'),
                        items: Array.from(combobox.querySelectorAll('.item')).map(item => ({
                            checked: item.querySelector('input[type="checkbox"]')?.checked || false,
                        })),
                    })),
                };

                localStorage.setItem(pageName, JSON.stringify(state));
            }

            let userData = await getUserData();
            let userDoc = await getUserDoc();

            function updateMainContent(screenMode, pageContent) {
                pageContent.length = 0;
                if (screenMode !== 1) {
                    pageContent.push(`
                                                        <div style="position: absolute;">
                                                            <div class="background-container hidden" style="flex-direction: column;align-items: stretch;width: inherit;height: inherit;" id="upload-options-modal-input-upload">
                                                                <div class="background-dot-container">
                                                                    <div class="background-dot-container-content" style="padding: 0;">
                                                                        <h4 class="upload-option" id="upload-device-input-upload">Upload from device...</h4>
                                                                    </div>
                                                                </div>
                                                                <div class="background-dot-container disabled">
                                                                   <div class="background-dot-container-content disabled" style="padding: 0;">
                                                                       <h4 class="upload-option disabled" id="upload-link-input-upload">Upload via link...</h4>
                                                                       <input type="url" id="link-upload-input-upload" class="hidden disabled" placeholder="Paste link here...">
                                                                   </div>
                                                               </div>
                                                            </div>
                                                        </div>
                                                        <div style="position: absolute;">
                                                            <div class="background-container hidden" style="flex-direction: column;align-items: stretch;width: inherit;height: inherit;" id="upload-options-modal-last-frame-upload">
                                                                <div class="background-dot-container">
                                                                    <div class="background-dot-container-content" style="padding: 0;">
                                                                        <h4 class="upload-option" id="upload-device-last-frame-upload">Upload from device...</h4>
                                                                    </div>
                                                                </div>
                                                                <div class="background-dot-container disabled">
                                                                   <div class="background-dot-container-content disabled" style="padding: 0;">
                                                                       <h4 class="upload-option disabled" id="upload-link-last-frame-upload">Upload via link...</h4>
                                                                       <input type="url" id="link-upload-last-frame-upload" class="hidden disabled" placeholder="Paste link here...">
                                                                   </div>
                                                               </div>
                                                            </div>
                                                        </div>
                                                        <div id="baseContainer" style="display: grid; grid-template-columns: 8fr 3fr; width: 100%; height: 100%;gap: calc(2vh* var(--scale-factor-h));">
                                                            <div class="background-container" style="display: flex; flex-direction: column; align-items: stretch; width: 100%; height: 100%;">
                                                                <div style="display: grid;grid-template-rows: 1fr auto;height: 100%;">
                                                                    <div class="background-dot-container">
                                                                        <div class="background-dot-container-content" style="--degree: 45deg; border-color: white; display: flex;gap: 0; flex-direction: column; padding: 0;">
                                                                            <div class="tab-container">
                                                                                <div class="section-tabs">
                                                                                    <div class="tab active" for="processTab">
                                                                                        <div class="svg-tag">
                                                                                            <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 256 256" height="1em" width="1em"><path d="M197.58,129.06l-51.61-19-19-51.65a15.92,15.92,0,0,0-29.88,0L78.07,110l-51.65,19a15.92,15.92,0,0,0,0,29.88L78,178l19,51.62a15.92,15.92,0,0,0,29.88,0l19-51.61,51.65-19a15.92,15.92,0,0,0,0-29.88ZM140.39,163a15.87,15.87,0,0,0-9.43,9.43l-19,51.46L93,172.39A15.87,15.87,0,0,0,83.61,163h0L32.15,144l51.46-19A15.87,15.87,0,0,0,93,115.61l19-51.46,19,51.46a15.87,15.87,0,0,0,9.43,9.43l51.46,19ZM144,40a8,8,0,0,1,8-8h16V16a8,8,0,0,1,16,0V32h16a8,8,0,0,1,0,16H184V64a8,8,0,0,1-16,0V48H152A8,8,0,0,1,144,40ZM248,88a8,8,0,0,1-8,8h-8v8a8,8,0,0,1-16,0V96h-8a8,8,0,0,1,0-16h8V72a8,8,0,0,1,16,0v8h8A8,8,0,0,1,248,88Z"></path></svg>
                                                                                        </div>
                                                                                        <span>Generate</span>
                                                                                    </div>
                                                                                    <div class="tab" for="advancedTab">
                                                                                        <div class="svg-tag">
                                                                                            <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 256 256" height="1em" width="1em"><path d="M197.58,129.06l-51.61-19-19-51.65a15.92,15.92,0,0,0-29.88,0L78.07,110l-51.65,19a15.92,15.92,0,0,0,0,29.88L78,178l19,51.62a15.92,15.92,0,0,0,29.88,0l19-51.61,51.65-19a15.92,15.92,0,0,0,0-29.88ZM140.39,163a15.87,15.87,0,0,0-9.43,9.43l-19,51.46L93,172.39A15.87,15.87,0,0,0,83.61,163h0L32.15,144l51.46-19A15.87,15.87,0,0,0,93,115.61l19-51.46,19,51.46a15.87,15.87,0,0,0,9.43,9.43l51.46,19ZM144,40a8,8,0,0,1,8-8h16V16a8,8,0,0,1,16,0V32h16a8,8,0,0,1,0,16H184V64a8,8,0,0,1-16,0V48H152A8,8,0,0,1,144,40ZM248,88a8,8,0,0,1-8,8h-8v8a8,8,0,0,1-16,0V96h-8a8,8,0,0,1,0-16h8V72a8,8,0,0,1,16,0v8h8A8,8,0,0,1,248,88Z"></path></svg>
                                                                                        </div>
                                                                                        <span>Advanced</span>
                                                                                    </div>
                                                                                    <div class="tab" for="downloadTab">
                                                                                        <div class="svg-tag">
                                                                                            <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 256 256" height="1em" width="1em"><path d="M197.58,129.06l-51.61-19-19-51.65a15.92,15.92,0,0,0-29.88,0L78.07,110l-51.65,19a15.92,15.92,0,0,0,0,29.88L78,178l19,51.62a15.92,15.92,0,0,0,29.88,0l19-51.61,51.65-19a15.92,15.92,0,0,0,0-29.88ZM140.39,163a15.87,15.87,0,0,0-9.43,9.43l-19,51.46L93,172.39A15.87,15.87,0,0,0,83.61,163h0L32.15,144l51.46-19A15.87,15.87,0,0,0,93,115.61l19-51.46,19,51.46a15.87,15.87,0,0,0,9.43,9.43l51.46,19ZM144,40a8,8,0,0,1,8-8h16V16a8,8,0,0,1,16,0V32h16a8,8,0,0,1,0,16H184V64a8,8,0,0,1-16,0V48H152A8,8,0,0,1,144,40ZM248,88a8,8,0,0,1-8,8h-8v8a8,8,0,0,1-16,0V96h-8a8,8,0,0,1,0-16h8V72a8,8,0,0,1,16,0v8h8A8,8,0,0,1,248,88Z"></path></svg>
                                                                                        </div>
                                                                                        <span>Download</span>
                                                                                    </div>
                                                                                </div>

                                                                                <div id="processTab" class="content-section" style="display: flex;flex-direction: column;justify-content: space-between;flex: 1 1 auto;padding: calc(1.5vh * var(--scale-factor-h));padding-right: calc(.75vh * var(--scale-factor-h));gap: calc(1.5vh * var(--scale-factor-h));">
                                                                                    <div id="featuresContainer" style="display: flex;flex-direction: column;gap: calc(1.5vh * var(--scale-factor-h));flex: 1 1 auto;overflow-y: auto;overflow-x: hidden;max-height: 100%;padding-right: calc(0.75vh* var(--scale-factor-h));height: 0;">
                                                                                        <div style="display: grid;width: 100%;height: 100%;gap: calc(0.75vh * var(--scale-factor-h));">
                                                                                            <h4 class="non-bold">Upload Input</h4>
                                                                                            <div class="card-container background-non-hover-for-card" style="display: table;height: 100%;width: 100%;">
                                                                                                <div class="card remove-border card-dash-outline" style="position: relative;">
                                                                                                    <div class="card-content" style="--degree: 45deg;justify-content: center;border-color: white;">
                                                                                                        <input type="file" accept="video/*,image/*" id="input-upload" style="display: none" multiple>
                                                                                                        <div style="display: flex;">
                                                                                                            <div><div class="circular-button circular-button-no-text circular-button-input-upload" style="margin: calc(var(--input-margin)/ 4);"></div></div>
                                                                                                            <div class="inputs" style="width: revert-layer;min-width: fit-content;flex-direction: row;justify-content: flex-start;overflow: scroll;display: flex;align-items: center;flex-wrap: wrap;"></div>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>
                                                                                        <div class="line"></div>
                                                                                        <div class="rectangle-container" id="mode-selection">
                                                                                             <div class="rectangle" id="realistic">
                                                                                                 <img src="assets/img1.png" alt="Image 1">
                                                                                                 <h4 class="text non-bold" title="Realistic" default="Any 1.5"></h4>
                                                                                                 <span class="arrow-dwn"></span>
                                                                                                 <ul class="list-items">
                                                                                                     <li class="item">
                                                                                                         <label class="checkbox">
                                                                                                             <input type="checkbox" id="realistic any 1.5"><span>Any 1.5</span>
                                                                                                         </label>
                                                                                                     </li>
                                                                                                  </ul>
                                                                                             </div>
                                                                                             <div class="rectangle" id="anime">
                                                                                                 <img src="assets/img2.png" alt="Image 2">
                                                                                                 <h4 class="text non-bold" title="Animation" default="Any 1.5"></h4>
                                                                                                 <span class="arrow-dwn"></span>
                                                                                                 <ul class="list-items">
                                                                                                     <li class="item">
                                                                                                         <label class="checkbox">
                                                                                                             <input type="checkbox" id="anime any 1.5"><span>Any 1.5</span>
                                                                                                         </label>
                                                                                                     </li>
                                                                                                 </ul>
                                                                                             </div>
                                                                                        </div>
                                                                                        <div class="line"></div>
                                                                                        <div>
                                                                                            <h4 class="non-bold">Mask Settings</h4>
                                                                                            <div id="positiveMaskPrompt" class="combobox" tooltip style="gap: calc(1vh* var(--scale-factor-h));">
                                                                                                <div class="tooltip">
                                                                                                    Detect and isolate specific objects in the image to modify or enhance them using SAM (Segment Anything Model). Use positive prompts to specify what should be changed.
                                                                                                </div>
                                                                                                <span class="combobox-text" title="Change" default="Clothes"></span>
                                                                                                <span class="arrow-dwn"></span>
                                                                                                <ul class="list-items">
                                                                                                    <li class="item">
                                                                                                        <label class="checkbox" tooltip>
                                                                                                            <input type="checkbox" id="clothes"><span>Clothes</span>
                                                                                                            <div class="tooltip">Automatically detect and modify clothing items in the image.</div>
                                                                                                        </label>
                                                                                                    </li>
                                                                                                    <li class="item">
                                                                                                        <label class="checkbox" style="padding-left: 0" tooltip>
                                                                                                            <textarea id="maskCustomPositivePrompt" placeholder="Enter positive mask prompt..."></textarea>
                                                                                                            <div class="tooltip">Type a custom object you want to detect and modify in the image.</div>
                                                                                                        </label>
                                                                                                    </li>
                                                                                                </ul>
                                                                                            </div>
                                                                                        </div>
                                                                                        <div>
                                                                                            <div id="negativeMaskPrompt" class="combobox" tooltip style="gap: calc(1vh* var(--scale-factor-h));">
                                                                                                <div class="tooltip">
                                                                                                    Detect objects that should remain unchanged or excluded from modifications using SAM. Use negative prompts to protect specific areas during processing.
                                                                                                </div>
                                                                                                <span class="combobox-text" title="Keep" default="None"></span>
                                                                                                <span class="arrow-dwn"></span>
                                                                                                <ul class="list-items">
                                                                                                    <li class="item">
                                                                                                        <label class="checkbox" tooltip>
                                                                                                            <input type="checkbox" id="face"><span>Face</span>
                                                                                                            <div class="tooltip">Protect the face in the image from modifications.</div>
                                                                                                        </label>
                                                                                                    </li>
                                                                                                    <li class="item">
                                                                                                        <label class="checkbox" style="padding-left: 0" tooltip>
                                                                                                            <textarea id="maskCustomNegativePrompt" placeholder="Enter negative mask prompt..."></textarea>
                                                                                                            <div class="tooltip">Type a custom object you want to exclude from modification.</div>
                                                                                                        </label>
                                                                                                    </li>
                                                                                                </ul>
                                                                                            </div>
                                                                                        </div>
                                                                                        <div class="line"></div>
                                                                                        <div>
                                                                                            <h4 class="non-bold">Inpainting</h4>
                                                                                            <div id="referenceMethod" class="combobox" tooltip>
                                                                                                <span class="combobox-text" title="Use" default="Prompting Method"></span>
                                                                                                <span class="arrow-dwn"></span>
                                                                                                <ul class="list-items">
                                                                                                    <li class="item">
                                                                                                        <label class="checkbox" tooltip>
                                                                                                            <input type="checkbox" id="promptMethod"><span>Prompting Method</span>
                                                                                                            <div class="tooltip">
                                                                                                                Generates an image based on your Positive and Negative Prompts and uses it for video generation.
                                                                                                            </div>
                                                                                                        </label>
                                                                                                    </li>
                                                                                                    <li class="item">
                                                                                                        <label class="checkbox" tooltip>
                                                                                                            <input type="checkbox" id="referenceImageMethod"><span>Reference Image</span>
                                                                                                            <div class="tooltip">
                                                                                                                Uses an existing image provided by you to generate the video, replacing the object while preserving other details.
                                                                                                            </div>
                                                                                                        </label>
                                                                                                    </li>
                                                                                                </ul>
                                                                                            </div>
                                                                                        </div>
                                                                                        <div>
                                                                                            <h4 class="non-bold">Positive Prompt</h4>
                                                                                            <div style="font-size: 0px; font-weight: 400;" tooltip>
                                                                                                <div class="tooltip">Enter the things you want to the object to be changed with in your home language.</div>
                                                                                                <textarea id="positivePrompt" placeholder="Enter the things you want to the object to be replaced with..." maxlength="2000" style="width: 100%;height: calc(12vh* var(--scale-factor-h));"></textarea>
                                                                                            </div>
                                                                                        </div>
                                                                                        <div>
                                                                                            <div style="display: flex;align-items: center;justify-content: space-between;">
                                                                                                <div style="display: flex;align-items: center;">
                                                                                                    <h4 class="non-bold">Negative Prompt</h4>
                                                                                                    &nbsp;
                                                                                                    <h4 class="non-bold" style="opacity: 0.5;">(Optional)</h4>
                                                                                                </div>
                                                                                                <svg id="negativeSVG" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="rgba(var(--white),1)" version="1.1" id="Layer_1" viewBox="0 0 330 330" xml:space="preserve" style="width: calc(4vh* var(--scale-factor-h));">
                                                                                                    <path id="XMLID_225_" d="M325.607,79.393c-5.857-5.857-15.355-5.858-21.213,0.001l-139.39,139.393L25.607,79.393  c-5.857-5.857-15.355-5.858-21.213,0.001c-5.858,5.858-5.858,15.355,0,21.213l150.004,150c2.813,2.813,6.628,4.393,10.606,4.393  s7.794-1.581,10.606-4.394l149.996-150C331.465,94.749,331.465,85.251,325.607,79.393z"></path>
                                                                                                </svg>
                                                                                            </div>
                                                                                            <div style="font-size: 0px; font-weight: 400;" tooltip>
                                                                                                <div class="tooltip">Enter the things you do not want to happen in the video in your home language.</div>
                                                                                                <textarea id="negativePrompt" placeholder="Enter the things you do not want to the object to be replaced with..." maxlength="2000" style="width: 100%;height: calc(12vh* var(--scale-factor-h));"></textarea>
                                                                                            </div>
                                                                                        </div>
                                                                                        <div id="referenceImageContainer" style="display: grid;width: 100%;height: 100%;gap: calc(0.75vh * var(--scale-factor-h));">
                                                                                            <div class="card-container background-non-hover-for-card" style="display: table;height: 100%;width: 100%;">
                                                                                                <div class="card remove-border card-dash-outline" style="position: relative;">
                                                                                                    <div class="card-content" style="--degree: 45deg;justify-content: center;border-color: white;">
                                                                                                        <input type="file" accept="image/*" id="start-frame-upload" style="display: none" multiple>
                                                                                                        <div style="display: flex;">
                                                                                                            <div><div class="circular-button circular-button-no-text circular-button-start-frame-upload" style="margin: calc(var(--input-margin)/ 4);"></div></div>
                                                                                                            <div class="start-frames" style="width: revert-layer;min-width: fit-content;flex-direction: row;justify-content: flex-start;overflow: scroll;display: flex;align-items: center;flex-wrap: wrap;"></div>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>
                                                                                        <div class="line"></div>
                                                                                        <div>
                                                                                            <h4 class="non-bold">Video Quality Settings</h4>
                                                                                            <div id="quality" class="combobox" tooltip>
                                                                                                <div class="tooltip">
                                                                                                    Adjust the video detail quality. Higher quality improves visual fidelity but may increase generation time.
                                                                                                </div>
                                                                                                <span class="combobox-text" title="Quality" default="High"></span>
                                                                                                <span class="arrow-dwn"></span>
                                                                                                <ul class="list-items">
                                                                                                    <li class="item">
                                                                                                        <label class="checkbox" tooltip>
                                                                                                            <input type="checkbox" id="1"><span>Low</span>
                                                                                                            <div class="tooltip">Low quality: faster generation, less detail.</div>
                                                                                                        </label>
                                                                                                    </li>
                                                                                                    <li class="item">
                                                                                                        <label class="checkbox" tooltip>
                                                                                                            <input type="checkbox" id="2"><span>Medium</span>
                                                                                                            <div class="tooltip">Medium quality: balance between speed and detail.</div>
                                                                                                        </label>
                                                                                                    </li>
                                                                                                    <li class="item">
                                                                                                        <label class="checkbox" tooltip>
                                                                                                            <input type="checkbox" id="3"><span>High</span>
                                                                                                            <div class="tooltip">High quality: best detail, longer generation time.</div>
                                                                                                        </label>
                                                                                                    </li>
                                                                                                </ul>
                                                                                            </div>
                                                                                        </div>
                                                                                        <div>
                                                                                            <div id="duration" class="combobox" tooltip>
                                                                                                <div class="tooltip">
                                                                                                    Choose the max video duration in seconds. The total number of frames depends on the selected FPS (frames per second).
                                                                                                </div>
                                                                                                <span class="combobox-text" title="Max Duration" default="5s"></span>
                                                                                                <span class="arrow-dwn"></span>
                                                                                                <ul class="list-items">
                                                                                                    <li class="item">
                                                                                                        <label class="checkbox" tooltip>
                                                                                                            <input type="checkbox" id="1"><span>1s</span>
                                                                                                            <div class="tooltip">Set video max duration to 1 second.</div>
                                                                                                        </label>
                                                                                                    </li>
                                                                                                    <li class="item">
                                                                                                        <label class="checkbox" tooltip>
                                                                                                            <input type="checkbox" id="3"><span>3s</span>
                                                                                                            <div class="tooltip">Set video max duration to 3 seconds.</div>
                                                                                                        </label>
                                                                                                    </li>
                                                                                                    <li class="item">
                                                                                                        <label class="checkbox" tooltip>
                                                                                                            <input type="checkbox" id="5"><span>5s</span>
                                                                                                            <div class="tooltip">Set video max duration to 5 seconds.</div>
                                                                                                        </label>
                                                                                                    </li>
                                                                                                </ul>
                                                                                            </div>
                                                                                        </div>
                                                                                        <div class="line"></div>
                                                                                        <div>
                                                                                            <label class="checkbox" tooltip>
                                                                                                <input type="checkbox" id="removeBanner"><span>Remove Banner</span>
                                                                                                <div class="tooltip">Removes any branding or footer banners from the final video.</div>
                                                                                            </label>
                                                                                        </div>
                                                                                        <div>
                                                                                            <label class="checkbox" tooltip>
                                                                                                <input type="checkbox" id="randomizeSeed"><span>Randomize Seed</span>
                                                                                                <div class="tooltip">You will get a different output even if your settings are same.</div>
                                                                                            </label>
                                                                                        </div>
                                                                                        <div>
                                                                                            <label class="checkbox" tooltip>
                                                                                                <input type="checkbox" id="losslessEncoder"><span>Lossless Encoder</span>
                                                                                                <div class="tooltip">Encodes the video in MP4 format without any quality loss with increased file size.</div>
                                                                                            </label>
                                                                                        </div>
                                                                                        <div>
                                                                                            <div id="showServersContainer">
                                                                                                <label class="checkbox">
                                                                                                    <input type="checkbox" id="showServers">Server List</input>
                                                                                                </label>
                                                                                            </div>
                                                                                            <div id="serverList" style="display: flex;justify-content: space-evenly;flex-wrap: wrap;align-content: stretch;flex-direction: column;"></div>
                                                                                        </div>
                                                                                    </div>
                                                                                    <div style="display: flex;gap: calc(1.45vh * var(--scale-factor-h));padding-right: calc(0.75vh * var(--scale-factor-h));flex-direction: column;">
                                                                                        <div class="line"></div>
                                                                                        <div style="display: flex;gap: calc(1.5vh * var(--scale-factor-h));flex-direction: row;">
                                                                                            <button class="wide important" id="handleProcessBtn">
                                                                                                <svg style="opacity: 1;" stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 256 256" class="w-5 h-5" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M197.58,129.06l-51.61-19-19-51.65a15.92,15.92,0,0,0-29.88,0L78.07,110l-51.65,19a15.92,15.92,0,0,0,0,29.88L78,178l19,51.62a15.92,15.92,0,0,0,29.88,0l19-51.61,51.65-19a15.92,15.92,0,0,0,0-29.88ZM140.39,163a15.87,15.87,0,0,0-9.43,9.43l-19,51.46L93,172.39A15.87,15.87,0,0,0,83.61,163h0L32.15,144l51.46-19A15.87,15.87,0,0,0,93,115.61l19-51.46,19,51.46a15.87,15.87,0,0,0,9.43,9.43l51.46,19ZM144,40a8,8,0,0,1,8-8h16V16a8,8,0,0,1,16,0V32h16a8,8,0,0,1,0,16H184V64a8,8,0,0,1-16,0V48H152A8,8,0,0,1,144,40ZM248,88a8,8,0,0,1-8,8h-8v8a8,8,0,0,1-16,0V96h-8a8,8,0,0,1,0-16h8V72a8,8,0,0,1,16,0v8h8A8,8,0,0,1,248,88Z"></path></svg>
                                                                                                <span>Generate</span>
                                                                                            </button>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                                <div id="advancedTab" class="content-section" style="flex-direction: column;justify-content: space-between;flex: 1 1 auto;padding: calc(1.5vh * var(--scale-factor-h));gap: calc(1.5vh * var(--scale-factor-h));">
                                                                                    <div id="featuresContainer" style="display: flex;flex-direction: column;gap: calc(1.5vh * var(--scale-factor-h));flex: 1 1 auto;overflow-y: auto;overflow-x: hidden;max-height: 100%;padding-right: calc(0.75vh* var(--scale-factor-h));height: 0;">
                                                                                        <div>
                                                                                            <label class="checkbox" tooltip>
                                                                                                <input type="checkbox" id="analyzeImage"><span>Analyze Image</span>
                                                                                            </label>
                                                                                        </div>
                                                                                        <div>
                                                                                            <label class="checkbox" tooltip>
                                                                                                <input type="checkbox" id="promptOptimizations"><span>Prompt optimizations</span>
                                                                                                <div class="tooltip">Adds new prompts based on the image automatically.</div>
                                                                                            </label>
                                                                                        </div>
                                                                                        <div>
                                                                                            <label class="checkbox" tooltip>
                                                                                                <input type="checkbox" id="invertMask"><span>Invert mask</span>
                                                                                                <div class="tooltip">Inpainting will occur in unmasked areas.</div>
                                                                                            </label>
                                                                                        </div>
                                                                                        <div>
                                                                                            <label class="checkbox" tooltip>
                                                                                                <input type="checkbox" id="depthDetection"><span>Depth detection</span>
                                                                                                <div class="tooltip">Tries to keep depth of the image.</div>
                                                                                            </label>
                                                                                        </div>
                                                                                        <div>
                                                                                            <label class="checkbox" tooltip>
                                                                                                <input type="checkbox" id="poseDetection"><span>Human-pose detection</span>
                                                                                                <div class="tooltip">Try to keep the pose of people in the input provided.</div>
                                                                                            </label>
                                                                                        </div>
                                                                                        <div class="line"></div>
                                                                                        <div>
                                                                                            <div id="denoiseSkippingPercentage" class="combobox" tooltip style="gap: calc(1vh* var(--scale-factor-h));">
                                                                                                <div class="tooltip">Helps fixing AI artifacts, too much skipping might cause issues.</div>
                                                                                                <span class="combobox-text" title="Denoise Skip" default="Skip 0%"></span>
                                                                                                <span class="arrow-dwn"></span>
                                                                                                <ul class="list-items">
                                                                                                    <li class="item">
                                                                                                        <label class="checkbox">
                                                                                                            <input type="checkbox" id="0"><span>Skip 0%</span>
                                                                                                        </label>
                                                                                                    </li>
                                                                                                    <li class="item">
                                                                                                        <label class="checkbox">
                                                                                                            <input type="checkbox" id="1"><span>Skip 1%</span>
                                                                                                        </label>
                                                                                                    </li>
                                                                                                    <li class="item">
                                                                                                        <label class="checkbox">
                                                                                                            <input type="checkbox" id="5"><span>Skip 5%</span>
                                                                                                        </label>
                                                                                                    </li>
                                                                                                    <li class="item">
                                                                                                        <label class="checkbox">
                                                                                                            <input type="checkbox" id="10"><span>Skip 10%</span>
                                                                                                        </label>
                                                                                                    </li>
                                                                                                    <li class="item">
                                                                                                        <label class="checkbox">
                                                                                                            <input type="checkbox" id="25"><span>Skip 25%</span>
                                                                                                        </label>
                                                                                                    </li>
                                                                                                    <li class="item">
                                                                                                        <label class="checkbox">
                                                                                                            <input type="checkbox" id="50"><span>Skip 50%</span>
                                                                                                        </label>
                                                                                                    </li>
                                                                                                </ul>
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>

                                                                                <div id="downloadTab" class="content-section" style="display: none;flex-direction: column;justify-content: space-between;flex: 1 1 auto;padding: calc(1.5vh * var(--scale-factor-h));gap: calc(1.5vh * var(--scale-factor-h));">
                                                                                    <div id="featuresContainer" style="display: flex;flex-direction: column;gap: calc(1.5vh * var(--scale-factor-h));flex: 1 1 auto;overflow-y: auto;overflow-x: hidden;max-height: 100%;padding-right: calc(0.75vh* var(--scale-factor-h));height: 0;">
                                                                                        <div id="outputSection" style="--degree: 135deg;height: 100%;display: grid;grid-template-rows: 1fr auto;gap: calc(2vh* var(--scale-factor-h));border-color: white;">
                                                                                            <div class="card-container background-non-hover-for-card" style="display: block;height: 100%;width: 100%;">
                                                                                                <div class="card" style="position: relative;">
                                                                                                    <div class="card-content card-remove-hover" style="--degree: -135deg;justify-content: center;padding: 0;border-color: white;">
                                                                                                        <div id="outputs_beforeInit"  style="width: 100%;height: 100%;display: flex;justify-content: center;align-items: center;">
                                                                                                            <div style="display: flex;align-items: center;gap: calc(1vh * var(--scale-factor-h));flex-direction: column;">
                                                                                                                <svg style="width: 6vh;" viewBox="0 0 49 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M44.5393 33.64L38.2793 19C37.1393 16.32 35.4393 14.8 33.4993 14.7C31.5793 14.6 29.7193 15.94 28.2993 18.5L24.4993 25.32C23.6993 26.76 22.5593 27.62 21.3193 27.72C20.0593 27.84 18.7993 27.18 17.7793 25.88L17.3393 25.32C15.9193 23.54 14.1593 22.68 12.3593 22.86C10.5593 23.04 9.0193 24.28 7.9993 26.3L4.5393 33.2C3.2993 35.7 3.4193 38.6 4.8793 40.96C6.3393 43.32 8.8793 44.74 11.6593 44.74H37.1793C39.8593 44.74 42.3593 43.4 43.8393 41.16C45.3593 38.92 45.5993 36.1 44.5393 33.64Z" fill="#EFF6FF" fill-opacity="0.25"></path><path d="M14.4402 16.76C18.1736 16.76 21.2002 13.7334 21.2002 9.99999C21.2002 6.26655 18.1736 3.23999 14.4402 3.23999C10.7067 3.23999 7.68018 6.26655 7.68018 9.99999C7.68018 13.7334 10.7067 16.76 14.4402 16.76Z" fill="#EFF6FF" fill-opacity="0.25"></path></svg>
                                                                                                                <small style="color: grey;">Your output will display here!</small>
                                                                                                            </div>
                                                                                                        </div>
                                                                                                        <div id="outputs_afterInit" style="display: none; width: 100%; height: 100%; justify-content: center;"></div>
                                                                                                    </div>
                                                                                                </div>
                                                                                            </div>
                                                                                            <div class="card-container background-non-hover-for-card" style="display: block;height: 100%;width: 100%;">
                                                                                                <div class="card" style="position: relative;">
                                                                                                    <div class="card-content card-remove-hover" style="--degree: -45deg;justify-content: center;border-color: white;min-height: calc(var(--input-size) + (var(--input-margin)));padding: 0;justify-content: flex-start;">
                                                                                                        <div style="display: flex;width: 100%;height: 100%;align-items: center;">
                                                                                                            <div class="outputs" style="overflow-x: hidden;overflow-y: auto;display: flex;max-width: none;"></div>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                    <div style="display: flex;gap: calc(1.5vh * var(--scale-factor-h));flex-direction: column;">
                                                                                        <div class="line"></div>
                                                                                        <div style="display: flex;gap: calc(1.5vh * var(--scale-factor-h));flex-direction: row;">
                                                                                            <button disabled class="wide" id="viewOutput">
                                                                                                <span>Preview</span>
                                                                                            </button>
                                                                                            <button class="wide important" id="downloadOutput">
                                                                                                <span>Download</span>
                                                                                            </button>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    `);
                    return;
                }

                pageContent.push(`
                                                         <div style="position: absolute;">
                                                            <div class="background-container hidden" style="flex-direction: column;align-items: stretch;width: inherit;height: inherit;" id="upload-options-modal-input-upload">
                                                                <div class="background-dot-container">
                                                                    <div class="background-dot-container-content" style="padding: 0;">
                                                                        <h4 class="upload-option" id="upload-device-input-upload">Upload from device...</h4>
                                                                    </div>
                                                                </div>
                                                                <div class="background-dot-container disabled">
                                                                   <div class="background-dot-container-content disabled" style="padding: 0;">
                                                                       <h4 class="upload-option disabled" id="upload-link-input-upload">Upload via link...</h4>
                                                                       <input type="url" id="link-upload-input-upload" class="hidden disabled" placeholder="Paste link here...">
                                                                   </div>
                                                               </div>
                                                            </div>
                                                        </div>
                                                         <div style="position: absolute;">
                                                            <div class="background-container hidden" style="flex-direction: column;align-items: stretch;width: inherit;height: inherit;" id="upload-options-modal-start-frame-upload">
                                                                <div class="background-dot-container">
                                                                    <div class="background-dot-container-content" style="padding: 0;">
                                                                        <h4 class="upload-option" id="upload-device-start-frame-upload">Upload from device...</h4>
                                                                    </div>
                                                                </div>
                                                                <div class="background-dot-container disabled">
                                                                   <div class="background-dot-container-content disabled" style="padding: 0;">
                                                                       <h4 class="upload-option disabled" id="upload-link-start-frame-upload">Upload via link...</h4>
                                                                       <input type="url" id="link-upload-start-frame-upload" class="hidden disabled" placeholder="Paste link here...">
                                                                   </div>
                                                               </div>
                                                            </div>
                                                        </div>
                                                        <div style="position: absolute;">
                                                            <div class="background-container hidden" style="flex-direction: column;align-items: stretch;width: inherit;height: inherit;" id="upload-options-modal-last-frame-upload">
                                                                <div class="background-dot-container">
                                                                    <div class="background-dot-container-content" style="padding: 0;">
                                                                        <h4 class="upload-option" id="upload-device-last-frame-upload">Upload from device...</h4>
                                                                    </div>
                                                                </div>
                                                                <div class="background-dot-container disabled">
                                                                   <div class="background-dot-container-content disabled" style="padding: 0;">
                                                                       <h4 class="upload-option disabled" id="upload-link-last-frame-upload">Upload via link...</h4>
                                                                       <input type="url" id="link-upload-last-frame-upload" class="hidden disabled" placeholder="Paste link here...">
                                                                   </div>
                                                               </div>
                                                            </div>
                                                        </div>
                                                        <div id="baseContainer" style="display: grid; grid-template-columns: 2fr 5fr; width: 100%; height: 100%;gap: calc(2vh* var(--scale-factor-h));">
                                                            <div class="background-container" style="display: flex; flex-direction: column; align-items: stretch; width: 100%; height: 100%;">
                                                                <div style="display: grid;grid-template-rows: 1fr auto;height: 100%;">
                                                                    <div class="background-dot-container">
                                                                        <div class="background-dot-container-content" style="--degree: 45deg; border-color: white; display: flex;gap: 0; flex-direction: column; padding: 0;">
                                                                            <div class="tab-container">
                                                                                <div class="section-tabs">
                                                                                    <div class="tab active" for="processTab">
                                                                                        <div class="svg-tag">
                                                                                            <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 256 256" height="1em" width="1em"><path d="M197.58,129.06l-51.61-19-19-51.65a15.92,15.92,0,0,0-29.88,0L78.07,110l-51.65,19a15.92,15.92,0,0,0,0,29.88L78,178l19,51.62a15.92,15.92,0,0,0,29.88,0l19-51.61,51.65-19a15.92,15.92,0,0,0,0-29.88ZM140.39,163a15.87,15.87,0,0,0-9.43,9.43l-19,51.46L93,172.39A15.87,15.87,0,0,0,83.61,163h0L32.15,144l51.46-19A15.87,15.87,0,0,0,93,115.61l19-51.46,19,51.46a15.87,15.87,0,0,0,9.43,9.43l51.46,19ZM144,40a8,8,0,0,1,8-8h16V16a8,8,0,0,1,16,0V32h16a8,8,0,0,1,0,16H184V64a8,8,0,0,1-16,0V48H152A8,8,0,0,1,144,40ZM248,88a8,8,0,0,1-8,8h-8v8a8,8,0,0,1-16,0V96h-8a8,8,0,0,1,0-16h8V72a8,8,0,0,1,16,0v8h8A8,8,0,0,1,248,88Z"></path></svg>
                                                                                        </div>
                                                                                        <span>Generate</span>
                                                                                    </div>
                                                                                    <div class="tab" for="advancedTab">
                                                                                        <div class="svg-tag">
                                                                                            <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 256 256" height="1em" width="1em"><path d="M197.58,129.06l-51.61-19-19-51.65a15.92,15.92,0,0,0-29.88,0L78.07,110l-51.65,19a15.92,15.92,0,0,0,0,29.88L78,178l19,51.62a15.92,15.92,0,0,0,29.88,0l19-51.61,51.65-19a15.92,15.92,0,0,0,0-29.88ZM140.39,163a15.87,15.87,0,0,0-9.43,9.43l-19,51.46L93,172.39A15.87,15.87,0,0,0,83.61,163h0L32.15,144l51.46-19A15.87,15.87,0,0,0,93,115.61l19-51.46,19,51.46a15.87,15.87,0,0,0,9.43,9.43l51.46,19ZM144,40a8,8,0,0,1,8-8h16V16a8,8,0,0,1,16,0V32h16a8,8,0,0,1,0,16H184V64a8,8,0,0,1-16,0V48H152A8,8,0,0,1,144,40ZM248,88a8,8,0,0,1-8,8h-8v8a8,8,0,0,1-16,0V96h-8a8,8,0,0,1,0-16h8V72a8,8,0,0,1,16,0v8h8A8,8,0,0,1,248,88Z"></path></svg>
                                                                                        </div>
                                                                                        <span>Advanced</span>
                                                                                    </div>
                                                                                </div>

                                                                                <div id="processTab" class="content-section" style="display: flex;flex-direction: column;justify-content: space-between;flex: 1 1 auto;padding: calc(1.5vh * var(--scale-factor-h));padding-right: calc(.75vh * var(--scale-factor-h));gap: calc(1.5vh * var(--scale-factor-h));">
                                                                                    <div id="featuresContainer" style="display: flex;flex-direction: column;gap: calc(1.5vh * var(--scale-factor-h));flex: 1 1 auto;overflow-y: auto;overflow-x: hidden;max-height: 100%;padding-right: calc(0.75vh* var(--scale-factor-h));height: 0;">
                                                                                        <div style="display: grid;width: 100%;height: 100%;gap: calc(0.75vh * var(--scale-factor-h));">
                                                                                            <h4 class="non-bold">Upload Input</h4>
                                                                                            <div class="card-container background-non-hover-for-card" style="display: table;height: 100%;width: 100%;">
                                                                                                <div class="card remove-border card-dash-outline" style="position: relative;">
                                                                                                    <div class="card-content" style="--degree: 45deg;justify-content: center;border-color: white;">
                                                                                                        <input type="file" accept="video/*,image/*" id="input-upload" style="display: none" multiple>
                                                                                                        <div style="display: flex;">
                                                                                                            <div><div class="circular-button circular-button-no-text circular-button-input-upload" style="margin: calc(var(--input-margin)/ 4);"></div></div>
                                                                                                            <div class="inputs" style="width: revert-layer;min-width: fit-content;flex-direction: row;justify-content: flex-start;overflow: scroll;display: flex;align-items: center;flex-wrap: wrap;"></div>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>
                                                                                        <div class="line"></div>
                                                                                        <div class="rectangle-container" id="mode-selection">
                                                                                             <div class="rectangle" id="realistic">
                                                                                                 <img src="assets/img1.png" alt="Image 1">
                                                                                                 <h4 class="text non-bold" title="Realistic" default="Any 1.5"></h4>
                                                                                                 <span class="arrow-dwn"></span>
                                                                                                 <ul class="list-items">
                                                                                                     <li class="item">
                                                                                                         <label class="checkbox">
                                                                                                             <input type="checkbox" id="realistic any 1.5"><span>Any 1.5</span>
                                                                                                         </label>
                                                                                                     </li>
                                                                                                  </ul>
                                                                                             </div>
                                                                                             <div class="rectangle" id="anime">
                                                                                                 <img src="assets/img2.png" alt="Image 2">
                                                                                                 <h4 class="text non-bold" title="Animation" default="Any 1.5"></h4>
                                                                                                 <span class="arrow-dwn"></span>
                                                                                                 <ul class="list-items">
                                                                                                     <li class="item">
                                                                                                         <label class="checkbox">
                                                                                                             <input type="checkbox" id="anime any 1.5"><span>Any 1.5</span>
                                                                                                         </label>
                                                                                                     </li>
                                                                                                 </ul>
                                                                                             </div>
                                                                                        </div>
                                                                                        <div class="line"></div>
                                                                                        <div>
                                                                                            <h4 class="non-bold">Mask Settings</h4>
                                                                                            <div id="positiveMaskPrompt" class="combobox" tooltip style="gap: calc(1vh* var(--scale-factor-h));">
                                                                                                <div class="tooltip">
                                                                                                    Detect and isolate specific objects in the image to modify or enhance them using SAM (Segment Anything Model). Use positive prompts to specify what should be changed.
                                                                                                </div>
                                                                                                <span class="combobox-text" title="Change" default="Clothes"></span>
                                                                                                <span class="arrow-dwn"></span>
                                                                                                <ul class="list-items">
                                                                                                    <li class="item">
                                                                                                        <label class="checkbox" tooltip>
                                                                                                            <input type="checkbox" id="clothes"><span>Clothes</span>
                                                                                                            <div class="tooltip">Automatically detect and modify clothing items in the image.</div>
                                                                                                        </label>
                                                                                                    </li>
                                                                                                    <li class="item">
                                                                                                        <label class="checkbox" style="padding-left: 0" tooltip>
                                                                                                            <textarea id="maskCustomPositivePrompt" placeholder="Enter positive mask prompt..."></textarea>
                                                                                                            <div class="tooltip">Type a custom object you want to detect and modify in the image.</div>
                                                                                                        </label>
                                                                                                    </li>
                                                                                                </ul>
                                                                                            </div>
                                                                                        </div>
                                                                                        <div>
                                                                                            <div id="negativeMaskPrompt" class="combobox" tooltip style="gap: calc(1vh* var(--scale-factor-h));">
                                                                                                <div class="tooltip">
                                                                                                    Detect objects that should remain unchanged or excluded from modifications using SAM. Use negative prompts to protect specific areas during processing.
                                                                                                </div>
                                                                                                <span class="combobox-text" title="Keep" default="None"></span>
                                                                                                <span class="arrow-dwn"></span>
                                                                                                <ul class="list-items">
                                                                                                    <li class="item">
                                                                                                        <label class="checkbox" tooltip>
                                                                                                            <input type="checkbox" id="face"><span>Face</span>
                                                                                                            <div class="tooltip">Protect the face in the image from modifications.</div>
                                                                                                        </label>
                                                                                                    </li>
                                                                                                    <li class="item">
                                                                                                        <label class="checkbox" style="padding-left: 0" tooltip>
                                                                                                            <textarea id="maskCustomNegativePrompt" placeholder="Enter negative mask prompt..."></textarea>
                                                                                                            <div class="tooltip">Type a custom object you want to exclude from modification.</div>
                                                                                                        </label>
                                                                                                    </li>
                                                                                                </ul>
                                                                                            </div>
                                                                                        </div>
                                                                                        <div class="line"></div>
                                                                                        <div>
                                                                                            <h4 class="non-bold">Inpainting</h4>
                                                                                            <div id="referenceMethod" class="combobox" tooltip>
                                                                                                <span class="combobox-text" title="Use" default="Prompting Method"></span>
                                                                                                <span class="arrow-dwn"></span>
                                                                                                <ul class="list-items">
                                                                                                    <li class="item">
                                                                                                        <label class="checkbox" tooltip>
                                                                                                            <input type="checkbox" id="promptMethod"><span>Prompting Method</span>
                                                                                                            <div class="tooltip">
                                                                                                                Generates an image based on your Positive and Negative Prompts and uses it for video generation.
                                                                                                            </div>
                                                                                                        </label>
                                                                                                    </li>
                                                                                                    <li class="item">
                                                                                                        <label class="checkbox" tooltip>
                                                                                                            <input type="checkbox" id="referenceImageMethod"><span>Reference Image</span>
                                                                                                            <div class="tooltip">
                                                                                                                Uses an existing image provided by you to generate the video, replacing the object while preserving other details.
                                                                                                            </div>
                                                                                                        </label>
                                                                                                    </li>
                                                                                                </ul>
                                                                                            </div>
                                                                                        </div>
                                                                                        <div>
                                                                                            <h4 class="non-bold">Positive Prompt</h4>
                                                                                            <div style="font-size: 0px; font-weight: 400;" tooltip>
                                                                                                <div class="tooltip">Enter the things you want to the object to be changed with in your home language.</div>
                                                                                                <textarea id="positivePrompt" placeholder="Enter the things you want to the object to be replaced with..." maxlength="2000" style="width: 100%;height: calc(12vh* var(--scale-factor-h));"></textarea>
                                                                                            </div>
                                                                                        </div>
                                                                                        <div>
                                                                                            <div style="display: flex;align-items: center;justify-content: space-between;">
                                                                                                <div style="display: flex;align-items: center;">
                                                                                                    <h4 class="non-bold">Negative Prompt</h4>
                                                                                                    &nbsp;
                                                                                                    <h4 class="non-bold" style="opacity: 0.5;">(Optional)</h4>
                                                                                                </div>
                                                                                                <svg id="negativeSVG" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="rgba(var(--white),1)" version="1.1" id="Layer_1" viewBox="0 0 330 330" xml:space="preserve" style="width: calc(4vh* var(--scale-factor-h));">
                                                                                                    <path id="XMLID_225_" d="M325.607,79.393c-5.857-5.857-15.355-5.858-21.213,0.001l-139.39,139.393L25.607,79.393  c-5.857-5.857-15.355-5.858-21.213,0.001c-5.858,5.858-5.858,15.355,0,21.213l150.004,150c2.813,2.813,6.628,4.393,10.606,4.393  s7.794-1.581,10.606-4.394l149.996-150C331.465,94.749,331.465,85.251,325.607,79.393z"></path>
                                                                                                </svg>
                                                                                            </div>
                                                                                            <div style="font-size: 0px; font-weight: 400;" tooltip>
                                                                                                <div class="tooltip">Enter the things you do not want to happen in the video in your home language.</div>
                                                                                                <textarea id="negativePrompt" placeholder="Enter the things you do not want to the object to be replaced with..." maxlength="2000" style="width: 100%;height: calc(12vh* var(--scale-factor-h));"></textarea>
                                                                                            </div>
                                                                                        </div>
                                                                                        <div id="referenceImageContainer" style="display: grid;width: 100%;height: 100%;gap: calc(0.75vh * var(--scale-factor-h));">
                                                                                            <div class="card-container background-non-hover-for-card" style="display: table;height: 100%;width: 100%;">
                                                                                                <div class="card remove-border card-dash-outline" style="position: relative;">
                                                                                                    <div class="card-content" style="--degree: 45deg;justify-content: center;border-color: white;">
                                                                                                        <input type="file" accept="image/*" id="start-frame-upload" style="display: none" multiple>
                                                                                                        <div style="display: flex;">
                                                                                                            <div><div class="circular-button circular-button-no-text circular-button-start-frame-upload" style="margin: calc(var(--input-margin)/ 4);"></div></div>
                                                                                                            <div class="start-frames" style="width: revert-layer;min-width: fit-content;flex-direction: row;justify-content: flex-start;overflow: scroll;display: flex;align-items: center;flex-wrap: wrap;"></div>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>
                                                                                        <div class="line"></div>
                                                                                        <div>
                                                                                            <h4 class="non-bold">Video Quality Settings</h4>
                                                                                            <div id="quality" class="combobox" tooltip>
                                                                                                <div class="tooltip">
                                                                                                    Adjust the video detail quality. Higher quality improves visual fidelity but may increase generation time.
                                                                                                </div>
                                                                                                <span class="combobox-text" title="Quality" default="High"></span>
                                                                                                <span class="arrow-dwn"></span>
                                                                                                <ul class="list-items">
                                                                                                    <li class="item">
                                                                                                        <label class="checkbox" tooltip>
                                                                                                            <input type="checkbox" id="1"><span>Low</span>
                                                                                                            <div class="tooltip">Low quality: faster generation, less detail.</div>
                                                                                                        </label>
                                                                                                    </li>
                                                                                                    <li class="item">
                                                                                                        <label class="checkbox" tooltip>
                                                                                                            <input type="checkbox" id="2"><span>Medium</span>
                                                                                                            <div class="tooltip">Medium quality: balance between speed and detail.</div>
                                                                                                        </label>
                                                                                                    </li>
                                                                                                    <li class="item">
                                                                                                        <label class="checkbox" tooltip>
                                                                                                            <input type="checkbox" id="3"><span>High</span>
                                                                                                            <div class="tooltip">High quality: best detail, longer generation time.</div>
                                                                                                        </label>
                                                                                                    </li>
                                                                                                </ul>
                                                                                            </div>
                                                                                        </div>
                                                                                        <div>
                                                                                            <div id="duration" class="combobox" tooltip>
                                                                                                <div class="tooltip">
                                                                                                    Choose the max video duration in seconds. The total number of frames depends on the selected FPS (frames per second).
                                                                                                </div>
                                                                                                <span class="combobox-text" title="Max Duration" default="5s"></span>
                                                                                                <span class="arrow-dwn"></span>
                                                                                                <ul class="list-items">
                                                                                                    <li class="item">
                                                                                                        <label class="checkbox" tooltip>
                                                                                                            <input type="checkbox" id="1"><span>1s</span>
                                                                                                            <div class="tooltip">Set video max duration to 1 second.</div>
                                                                                                        </label>
                                                                                                    </li>
                                                                                                    <li class="item">
                                                                                                        <label class="checkbox" tooltip>
                                                                                                            <input type="checkbox" id="3"><span>3s</span>
                                                                                                            <div class="tooltip">Set video max duration to 3 seconds.</div>
                                                                                                        </label>
                                                                                                    </li>
                                                                                                    <li class="item">
                                                                                                        <label class="checkbox" tooltip>
                                                                                                            <input type="checkbox" id="5"><span>5s</span>
                                                                                                            <div class="tooltip">Set video max duration to 5 seconds.</div>
                                                                                                        </label>
                                                                                                    </li>
                                                                                                </ul>
                                                                                            </div>
                                                                                        </div>
                                                                                        <div class="line"></div>
                                                                                        <div>
                                                                                            <label class="checkbox" tooltip>
                                                                                                <input type="checkbox" id="removeBanner"><span>Remove Banner</span>
                                                                                                <div class="tooltip">Removes any branding or footer banners from the final video.</div>
                                                                                            </label>
                                                                                        </div>
                                                                                        <div>
                                                                                            <label class="checkbox" tooltip>
                                                                                                <input type="checkbox" id="randomizeSeed"><span>Randomize Seed</span>
                                                                                                <div class="tooltip">You will get a different output even if your settings are same.</div>
                                                                                            </label>
                                                                                        </div>
                                                                                        <div>
                                                                                            <label class="checkbox" tooltip>
                                                                                                <input type="checkbox" id="losslessEncoder"><span>Lossless Encoder</span>
                                                                                                <div class="tooltip">Encodes the video in MP4 format without any quality loss with increased file size.</div>
                                                                                            </label>
                                                                                        </div>
                                                                                        <div>
                                                                                            <div id="showServersContainer">
                                                                                                <label class="checkbox">
                                                                                                    <input type="checkbox" id="showServers">Server List</input>
                                                                                                </label>
                                                                                            </div>
                                                                                            <div id="serverList" style="display: flex;justify-content: space-evenly;flex-wrap: wrap;align-content: stretch;flex-direction: column;"></div>
                                                                                        </div>
                                                                                    </div>
                                                                                    <div style="display: flex;gap: calc(1.45vh * var(--scale-factor-h));padding-right: calc(0.75vh * var(--scale-factor-h));flex-direction: column;">
                                                                                        <div class="line"></div>
                                                                                        <div style="display: flex;gap: calc(1.5vh * var(--scale-factor-h));flex-direction: row;">
                                                                                            <button class="wide important" id="handleProcessBtn">
                                                                                                <svg style="opacity: 1;" stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 256 256" class="w-5 h-5" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M197.58,129.06l-51.61-19-19-51.65a15.92,15.92,0,0,0-29.88,0L78.07,110l-51.65,19a15.92,15.92,0,0,0,0,29.88L78,178l19,51.62a15.92,15.92,0,0,0,29.88,0l19-51.61,51.65-19a15.92,15.92,0,0,0,0-29.88ZM140.39,163a15.87,15.87,0,0,0-9.43,9.43l-19,51.46L93,172.39A15.87,15.87,0,0,0,83.61,163h0L32.15,144l51.46-19A15.87,15.87,0,0,0,93,115.61l19-51.46,19,51.46a15.87,15.87,0,0,0,9.43,9.43l51.46,19ZM144,40a8,8,0,0,1,8-8h16V16a8,8,0,0,1,16,0V32h16a8,8,0,0,1,0,16H184V64a8,8,0,0,1-16,0V48H152A8,8,0,0,1,144,40ZM248,88a8,8,0,0,1-8,8h-8v8a8,8,0,0,1-16,0V96h-8a8,8,0,0,1,0-16h8V72a8,8,0,0,1,16,0v8h8A8,8,0,0,1,248,88Z"></path></svg>
                                                                                                <span>Generate</span>
                                                                                            </button>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                                <div id="advancedTab" class="content-section" style="flex-direction: column;justify-content: space-between;flex: 1 1 auto;padding: calc(1.5vh * var(--scale-factor-h));gap: calc(1.5vh * var(--scale-factor-h));">
                                                                                    <div id="featuresContainer" style="display: flex;flex-direction: column;gap: calc(1.5vh * var(--scale-factor-h));flex: 1 1 auto;overflow-y: auto;overflow-x: hidden;max-height: 100%;padding-right: calc(0.75vh* var(--scale-factor-h));height: 0;">
                                                                                        <div>
                                                                                            <label class="checkbox" tooltip>
                                                                                                <input type="checkbox" id="analyzeImage"><span>Keep original details</span>
                                                                                            </label>
                                                                                        </div>
                                                                                        <div>
                                                                                            <label class="checkbox" tooltip>
                                                                                                <input type="checkbox" id="promptOptimizations"><span>Prompt optimizations</span>
                                                                                                <div class="tooltip">Adds new prompts based on the image automatically.</div>
                                                                                            </label>
                                                                                        </div>
                                                                                        <div>
                                                                                            <label class="checkbox" tooltip>
                                                                                                <input type="checkbox" id="invertMask"><span>Invert mask</span>
                                                                                                <div class="tooltip">Inpainting will occur in unmasked areas.</div>
                                                                                            </label>
                                                                                        </div>
                                                                                        <div>
                                                                                            <label class="checkbox" tooltip>
                                                                                                <input type="checkbox" id="depthDetection"><span>Depth detection</span>
                                                                                                <div class="tooltip">Tries to keep depth of the image.</div>
                                                                                            </label>
                                                                                        </div>
                                                                                        <div>
                                                                                            <label class="checkbox" tooltip>
                                                                                                <input type="checkbox" id="poseDetection"><span>Human-pose detection</span>
                                                                                                <div class="tooltip">Try to keep the pose of people in the input provided.</div>
                                                                                            </label>
                                                                                        </div>
                                                                                        <div class="line"></div>
                                                                                        <div>
                                                                                            <div id="denoiseSkippingPercentage" class="combobox" tooltip style="gap: calc(1vh* var(--scale-factor-h));">
                                                                                                <div class="tooltip">Helps fixing AI artifacts, too much skipping might cause issues.</div>
                                                                                                <span class="combobox-text" title="Denoise Skip" default="Skip 0%"></span>
                                                                                                <span class="arrow-dwn"></span>
                                                                                                <ul class="list-items">
                                                                                                    <li class="item">
                                                                                                        <label class="checkbox">
                                                                                                            <input type="checkbox" id="0"><span>Skip 0%</span>
                                                                                                        </label>
                                                                                                    </li>
                                                                                                    <li class="item">
                                                                                                        <label class="checkbox">
                                                                                                            <input type="checkbox" id="1"><span>Skip 1%</span>
                                                                                                        </label>
                                                                                                    </li>
                                                                                                    <li class="item">
                                                                                                        <label class="checkbox">
                                                                                                            <input type="checkbox" id="5"><span>Skip 5%</span>
                                                                                                        </label>
                                                                                                    </li>
                                                                                                    <li class="item">
                                                                                                        <label class="checkbox">
                                                                                                            <input type="checkbox" id="10"><span>Skip 10%</span>
                                                                                                        </label>
                                                                                                    </li>
                                                                                                    <li class="item">
                                                                                                        <label class="checkbox">
                                                                                                            <input type="checkbox" id="25"><span>Skip 25%</span>
                                                                                                        </label>
                                                                                                    </li>
                                                                                                    <li class="item">
                                                                                                        <label class="checkbox">
                                                                                                            <input type="checkbox" id="50"><span>Skip 50%</span>
                                                                                                        </label>
                                                                                                    </li>
                                                                                                </ul>
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="background-container" style="display: flex; flex-direction: column; align-items: stretch; width: 100%; height: 100%;">
                                                                <div style="display: grid;grid-template-rows: 1fr auto;height: 100%;">
                                                                    <div class="background-dot-container">
                                                                        <div class="background-dot-container-content" style="--degree: 45deg; border-color: white; display: flex;gap: 0; flex-direction: column; padding: 0;">
                                                                            <div class="tab-container">
                                                                                <div class="section-tabs">
                                                                                    <div class="tab" for="downloadTab">
                                                                                        <div class="svg-tag">
                                                                                            <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 256 256" height="1em" width="1em"><path d="M197.58,129.06l-51.61-19-19-51.65a15.92,15.92,0,0,0-29.88,0L78.07,110l-51.65,19a15.92,15.92,0,0,0,0,29.88L78,178l19,51.62a15.92,15.92,0,0,0,29.88,0l19-51.61,51.65-19a15.92,15.92,0,0,0,0-29.88ZM140.39,163a15.87,15.87,0,0,0-9.43,9.43l-19,51.46L93,172.39A15.87,15.87,0,0,0,83.61,163h0L32.15,144l51.46-19A15.87,15.87,0,0,0,93,115.61l19-51.46,19,51.46a15.87,15.87,0,0,0,9.43,9.43l51.46,19ZM144,40a8,8,0,0,1,8-8h16V16a8,8,0,0,1,16,0V32h16a8,8,0,0,1,0,16H184V64a8,8,0,0,1-16,0V48H152A8,8,0,0,1,144,40ZM248,88a8,8,0,0,1-8,8h-8v8a8,8,0,0,1-16,0V96h-8a8,8,0,0,1,0-16h8V72a8,8,0,0,1,16,0v8h8A8,8,0,0,1,248,88Z"></path></svg>
                                                                                        </div>
                                                                                        <span>Download</span>
                                                                                    </div>
                                                                                </div>

                                                                                <div id="downloadTab" class="content-section" style="display: flex;flex-direction: column;justify-content: space-between;flex: 1 1 auto;padding: calc(1.5vh * var(--scale-factor-h));gap: calc(1.5vh * var(--scale-factor-h));">
                                                                                    <div id="featuresContainer" style="display: flex;flex-direction: column;gap: calc(1.5vh * var(--scale-factor-h));flex: 1 1 auto;overflow-y: auto;overflow-x: hidden;max-height: 100%;padding-right: calc(0.75vh* var(--scale-factor-h));height: 0;">
                                                                                        <div id="outputSection" style="--degree: 135deg;height: 100%;display: grid;grid-template-rows: 1fr auto;gap: calc(2vh* var(--scale-factor-h));border-color: white;">
                                                                                            <div class="card-container background-non-hover-for-card" style="display: block;height: 100%;width: 100%;">
                                                                                                <div class="card" style="position: relative;">
                                                                                                    <div class="card-content card-remove-hover" style="--degree: -135deg;justify-content: center;padding: 0;border-color: white;">
                                                                                                        <div id="outputs_beforeInit"  style="width: 100%;height: 100%;display: flex;justify-content: center;align-items: center;">
                                                                                                            <div style="display: flex;align-items: center;gap: calc(1vh * var(--scale-factor-h));flex-direction: column;">
                                                                                                                <svg style="width: 6vh;" viewBox="0 0 49 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M44.5393 33.64L38.2793 19C37.1393 16.32 35.4393 14.8 33.4993 14.7C31.5793 14.6 29.7193 15.94 28.2993 18.5L24.4993 25.32C23.6993 26.76 22.5593 27.62 21.3193 27.72C20.0593 27.84 18.7993 27.18 17.7793 25.88L17.3393 25.32C15.9193 23.54 14.1593 22.68 12.3593 22.86C10.5593 23.04 9.0193 24.28 7.9993 26.3L4.5393 33.2C3.2993 35.7 3.4193 38.6 4.8793 40.96C6.3393 43.32 8.8793 44.74 11.6593 44.74H37.1793C39.8593 44.74 42.3593 43.4 43.8393 41.16C45.3593 38.92 45.5993 36.1 44.5393 33.64Z" fill="#EFF6FF" fill-opacity="0.25"></path><path d="M14.4402 16.76C18.1736 16.76 21.2002 13.7334 21.2002 9.99999C21.2002 6.26655 18.1736 3.23999 14.4402 3.23999C10.7067 3.23999 7.68018 6.26655 7.68018 9.99999C7.68018 13.7334 10.7067 16.76 14.4402 16.76Z" fill="#EFF6FF" fill-opacity="0.25"></path></svg>
                                                                                                                <small style="color: grey;">Your output will display here!</small>
                                                                                                            </div>
                                                                                                        </div>
                                                                                                        <div id="outputs_afterInit" style="display: none; width: 100%; height: 100%; justify-content: center;"></div>
                                                                                                    </div>
                                                                                                </div>
                                                                                            </div>
                                                                                            <div class="card-container background-non-hover-for-card" style="display: block;height: 100%;width: 100%;">
                                                                                                <div class="card" style="position: relative;">
                                                                                                    <div class="card-content card-remove-hover" style="--degree: -45deg;justify-content: center;border-color: white;min-height: calc(var(--input-size) + (var(--input-margin)));padding: 0;justify-content: flex-start;">
                                                                                                        <div style="display: flex;width: 100%;height: 100%;align-items: center;">
                                                                                                            <div class="outputs" style="overflow-x: hidden;overflow-y: auto;display: flex;max-width: none;"></div>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                    <div style="display: flex;gap: calc(1.5vh * var(--scale-factor-h));flex-direction: column;">
                                                                                        <div class="line"></div>
                                                                                        <div style="display: flex;gap: calc(1.5vh * var(--scale-factor-h));flex-direction: row;">
                                                                                            <button disabled class="wide" id="viewOutput">
                                                                                                <span>Preview</span>
                                                                                            </button>
                                                                                            <button class="wide important" id="downloadOutput">
                                                                                                <span>Download</span>
                                                                                            </button>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    `);
            }

            loadPageContent(setUser, retrieveImageFromURL, getUserInternetProtocol, ensureUniqueId, fetchServerAddress, getFirebaseModules, getDocSnapshot, getScreenMode, getCurrentMain, updateContent, createPages, setNavbar, setSidebar, showSidebar, removeSidebar, getSidebarActive, moveMains, setupMainSize, loadScrollingAndMain, showZoomIndicator, setScaleFactors, clamp, setAuthentication, updateMainContent, savePageState);

            const mainContainers = document.querySelectorAll('.main-container');
            mainContainers.forEach((mainContainer, id) => {
                mainContainer.style.justifyContent = 'flex-start';
            });

            window.addEventListener('beforeunload', () => { savePageState(); });
            window.addEventListener('pagehide', () => { savePageState(); });

            document.addEventListener('click', () => { savePageState(); });
            document.addEventListener('touchend', () => { savePageState(); });

            const creditPerTotalFrames = 30;
            const STATUS_OK = 200;

            function loadPageState() {
                setMaxWidth();

                document.querySelectorAll('.tab-container').forEach((container, containerIndex) => {
                    const tabs = container.querySelectorAll('.tab');
                    const storageKey = `activeTab_${containerIndex}_${pageName}`;

                    // Determine which tab should be active: saved state, then current active class, then default to the first tab.
                    let defaultTabId = localStorage.getItem(storageKey);
                    if (!defaultTabId) {
                        const activeTab = container.querySelector('.tab.active');
                        defaultTabId = activeTab ? activeTab.getAttribute('for') : tabs[0].getAttribute('for');
                    }

                    // Set the active state on tabs based on defaultTabId.
                    tabs.forEach(tab => {
                        const tabFor = tab.getAttribute('for');
                        tab.classList.toggle('active', tabFor === defaultTabId);
                    });

                    // Display the appropriate content section.
                    container.querySelectorAll('.content-section').forEach(section => {
                        section.style.display = (section.id === defaultTabId) ? 'flex' : 'none';
                    });

                    // Add click event listeners to update state and persist the active tab.
                    tabs.forEach(tab => {
                        tab.onclick = () => {
                            // Remove active class from all tabs and add it to the clicked one.
                            tabs.forEach(t => t.classList.remove('active'));
                            tab.classList.add('active');

                            // Determine the target content section id.
                            const targetId = tab.getAttribute('for');

                            // Update content section display based on the clicked tab.
                            container.querySelectorAll('.content-section').forEach(section => {
                                section.style.display = (section.id === targetId) ? 'flex' : 'none';
                            });

                            // Save the active tab state.
                            localStorage.setItem(storageKey, targetId);
                        };
                    });
                });


                const pageData = localStorage.getItem(pageName) || null;
                if (pageData) {
                    const state = JSON.parse(pageData || '{}') || {};

                    if (state.selectedRectangles) {
                        state.selectedRectangles.forEach(selectedId => {
                            const rectangle = document.getElementById(selectedId);
                            if (rectangle) {
                                rectangle.classList.add('selected');
                            }
                        });
                    }

                    const rectangleQuery = document.querySelectorAll('.rectangle');
                    rectangleQuery.forEach((rectangle, id) => {
                        const btnText = rectangle.querySelector('h4');
                        const items = rectangle.querySelectorAll('.item');

                        if (state.rectangles && state.rectangles[id]) {
                            if (btnText) btnText.innerText = state.rectangles[id].text || '';

                            if (state.rectangles[id].open) {
                                rectangle.classList.add('open');
                                const listItems = rectangle.querySelector('.list-items');
                                if (listItems) listItems.style.display = 'flex';
                            } else {
                                rectangle.classList.remove('open');
                                const listItems = rectangle.querySelector('.list-items');
                                if (listItems) listItems.style.display = 'none';
                            }

                            state.rectangles[id].items.forEach((itemState, itemIndex) => {
                                if (itemIndex < items.length) {
                                    const checkbox = items[itemIndex].querySelector('input[type="checkbox"]');
                                    if (checkbox) {
                                        checkbox.checked = itemState.checked;
                                        items[itemIndex].classList.toggle('checked', checkbox.checked);
                                    }
                                }
                            });
                        }
                    });

                    const promptOptimizations = document.getElementById('promptOptimizations');
                    if (promptOptimizations) promptOptimizations.checked = state.promptOptimizations || false;

                    const invertMask = document.getElementById('invertMask');
                    if (invertMask) invertMask.checked = state.invertMask || false;

                    const depthDetection = document.getElementById('depthDetection');
                    if (depthDetection) depthDetection.checked = state.depthDetection || false;

                    const poseDetection = document.getElementById('poseDetection');
                    if (poseDetection) poseDetection.checked = state.poseDetection || false;

                    const analyzeImage = document.getElementById('analyzeImage');
                    if (analyzeImage) analyzeImage.checked = state.analyzeImage || false;

                    const removeBanner = document.getElementById('removeBanner');
                    if (removeBanner) removeBanner.checked = state.removeBanner || false;

                    const emailOutput = document.getElementById('emailOutput');
                    if (emailOutput) emailOutput.checked = state.emailOutput || false;

                    const showServers = document.getElementById('showServers');
                    if (showServers) showServers.checked = state.showServers || false;

                    const setShift = document.getElementById('setShift');
                    if (setShift) setShift.checked = state.setShift || false;

                    const shiftValue = document.getElementById('shiftValue');
                    if (shiftValue) shiftValue.value = state.shiftValue || 3;

                    const torchAccumulation = document.getElementById('torchAccumulation');
                    if (torchAccumulation) torchAccumulation.checked = state.torchAccumulation || false;

                    const torchCompiler = document.getElementById('torchCompiler');
                    if (torchCompiler) torchCompiler.checked = state.torchCompiler || false;

                    const enhanceDetails = document.getElementById('enhanceDetails');
                    if (enhanceDetails) enhanceDetails.checked = state.enhanceDetails || false;

                    const temporalAttentionRefinement = document.getElementById('temporalAttentionRefinement');
                    if (temporalAttentionRefinement) temporalAttentionRefinement.checked = state.temporalAttentionRefinement || false;

                    const classifierFreeGuidance = document.getElementById('classifierFreeGuidance');
                    if (classifierFreeGuidance) classifierFreeGuidance.checked = state.classifierFreeGuidance || false;

                    const classifierFreeGuidanceValue = document.getElementById('classifierFreeGuidanceSlider');
                    if (classifierFreeGuidanceValue) classifierFreeGuidanceValue.value = state.classifierFreeGuidanceValue || 0;

                    const losslessEncoder = document.getElementById('losslessEncoder');
                    if (losslessEncoder) losslessEncoder.checked = state.losslessEncoder || false;

                    const randomizeSeed = document.getElementById('randomizeSeed');
                    if (randomizeSeed) randomizeSeed.checked = state.randomizeSeed || false;

                    const generateAudio = document.getElementById('generateAudio');
                    if (generateAudio) generateAudio.checked = state.generateAudio || false;

                    const positivePrompt = document.getElementById('positivePrompt');
                    if (positivePrompt) positivePrompt.value = state.positivePrompt || '';

                    const negativePrompt = document.getElementById('negativePrompt');
                    if (negativePrompt) negativePrompt.value = state.negativePrompt || '';

                    const maskCustomPositivePrompt = document.getElementById('maskCustomPositivePrompt');
                    if (maskCustomPositivePrompt) maskCustomPositivePrompt.value = state.maskCustomPositivePrompt || '';

                    const cfgMultiplier = document.getElementById('cfgMultiplier');
                    if (cfgMultiplier) cfgMultiplier.value = state.cfgMultiplier || '';

                    const positiveAudioPrompt = document.getElementById('positiveAudioPrompt');
                    if (positiveAudioPrompt) positiveAudioPrompt.value = state.positiveAudioPrompt || '';

                    const negativeAudioPrompt = document.getElementById('negativeAudioPrompt');
                    if (negativeAudioPrompt) negativeAudioPrompt.value = state.negativeAudioPrompt || '';

                    document.querySelectorAll('.nav-links .text').forEach(link => {
                        if (state.activeLinks.includes(link.getAttribute('for'))) {
                            link.classList.add('active');

                            const targetSection = document.getElementById(link.getAttribute('for'));
                            if (targetSection) {
                                targetSection.style.display = 'flex';
                            }
                        }
                    });

                    const multiboxQuery = document.querySelectorAll('.multibox');
                    multiboxQuery.forEach((multibox, id) => {
                        const btnText = multibox.querySelector('.multibox-text');
                        const items = multibox.querySelectorAll('.item');

                        if (state.multiboxes && state.multiboxes[id]) {
                            if (btnText) btnText.innerText = state.multiboxes[id].text || '';

                            if (state.multiboxes[id].open) {
                                multibox.classList.add('open');
                                const listItems = multibox.querySelector('.list-items');
                                if (listItems) listItems.style.display = 'flex';
                            } else {
                                multibox.classList.remove('open');
                                const listItems = multibox.querySelector('.list-items');
                                if (listItems) listItems.style.display = 'none';
                            }

                            state.multiboxes[id].items.forEach((itemState, itemIndex) => {
                                if (itemIndex < items.length) {
                                    const checkbox = items[itemIndex].querySelector('input[type="checkbox"]');
                                    if (checkbox) {
                                        checkbox.checked = itemState.checked;
                                        items[itemIndex].classList.toggle('checked', checkbox.checked);
                                    }
                                }
                            });
                        }
                    });

                    const comboboxQuery = document.querySelectorAll('.combobox');
                    comboboxQuery.forEach((combobox, id) => {
                        const btnText = combobox.querySelector('.combobox-text');
                        const items = combobox.querySelectorAll('.item');

                        if (state.comboboxes && state.comboboxes[id]) {
                            if (btnText) btnText.innerText = state.comboboxes[id].text || '';

                            if (state.comboboxes[id].open) {
                                combobox.classList.add('open');
                                const listItems = combobox.querySelector('.list-items');
                                if (listItems) listItems.style.display = 'flex';
                            } else {
                                combobox.classList.remove('open');
                                const listItems = combobox.querySelector('.list-items');
                                if (listItems) listItems.style.display = 'none';
                            }

                            state.comboboxes[id].items.forEach((itemState, itemIndex) => {
                                if (itemIndex < items.length) {
                                    const checkbox = items[itemIndex].querySelector('input[type="checkbox"]');
                                    if (checkbox) {
                                        checkbox.checked = itemState.checked;
                                        items[itemIndex].classList.toggle('checked', checkbox.checked);
                                    }
                                }
                            });
                        }
                    });
                } else {
                    const checkboxIds = [
                        'losslessEncoder'
                    ];

                    checkboxIds.forEach(id => {
                        const checkbox = document.getElementById(id);
                        if (checkbox) {
                            checkbox.checked = true;
                            setTimeout(() => { checkbox.dispatchEvent(new Event('change')); }, 0);
                        }
                    });
                }
            }

            const databases = [
                { indexName: `outputDB-${pageName}`, objectStore: 'outputs' },
                { indexName: `start-frameDB-${pageName}`, objectStore: 'start-frames' },
                { indexName: `inputDB-${pageName}`, objectStore: 'inputs' }
            ];

            window.addEventListener('beforeunload', async () => { await saveCountIndex(databases); });
            window.addEventListener('pagehide', async () => { await saveCountIndex(databases); });

            document.addEventListener('click', async () => { await saveCountIndex(databases); });
            document.addEventListener('touchend', async () => { await saveCountIndex(databases); });

            checkServerStatus(databases, userData?.uid);
            setDynamicInterval(databases, userData?.uid);

            const fileUploads = [
                { buttonId: 'circular-button-start-frame-upload', inputId: 'start-frame-upload', dataBaseIndexName: `start-frameDB-${pageName}`, dataBaseObjectStoreName: 'start-frames', databases },
                { buttonId: 'circular-button-input-upload', inputId: 'input-upload', dataBaseIndexName: `inputDB-${pageName}`, dataBaseObjectStoreName: 'inputs', databases },
            ];

            const maskCustomPositivePrompt = document.getElementById('maskCustomPositivePrompt');
            if (maskCustomPositivePrompt) {
                let lastValue = '';

                maskCustomPositivePrompt.addEventListener('input', () => {
                    let value = maskCustomPositivePrompt.value;
                    let newChar = value.length > lastValue.length ? value[value.length - 1] : '';
                    if (newChar === ' ' || newChar === ',') {
                        let words = value.slice(0, -1).split(/,\s*/).filter(Boolean).slice(0, 3);
                        words = words.map(w => w.charAt(0).toUpperCase() + w.slice(1).toLowerCase());
                        value = words.join(', ');
                        if (words.length < 3) value += ', ';
                    } else {
                        let words = value.split(/,\s*/).filter(Boolean).slice(0, 3);
                        words = words.map(w => w.charAt(0).toUpperCase() + w.slice(1).toLowerCase());
                        value = words.join(', ');
                        if (maskCustomPositivePrompt.value.endsWith(', ') && words.length < 3) value += ', ';
                    }

                    maskCustomPositivePrompt.value = value;
                    lastValue = value;
                });
            }

            const maskCustomNegativePrompt = document.getElementById('maskCustomNegativePrompt');
            if (maskCustomNegativePrompt) {
                let lastValue = '';

                maskCustomNegativePrompt.addEventListener('input', () => {
                    let value = maskCustomNegativePrompt.value;
                    let newChar = value.length > lastValue.length ? value[value.length - 1] : '';
                    if (newChar === ' ' || newChar === ',') {
                        let words = value.slice(0, -1).split(/,\s*/).filter(Boolean).slice(0, 3);
                        words = words.map(w => w.charAt(0).toUpperCase() + w.slice(1).toLowerCase());
                        value = words.join(', ');
                        if (words.length < 3) value += ', ';
                    } else {
                        let words = value.split(/,\s*/).filter(Boolean).slice(0, 3);
                        words = words.map(w => w.charAt(0).toUpperCase() + w.slice(1).toLowerCase());
                        value = words.join(', ');
                        if (maskCustomNegativePrompt.value.endsWith(', ') && words.length < 3) value += ', ';
                    }

                    maskCustomNegativePrompt.value = value;
                    lastValue = value;
                });
            }

            async function loadPage() {
                databases.forEach(db => initDB(db.indexName, db.objectStore, handleDownload, databases));

                const removeDataButton = document.getElementById('removeData');
                if (removeDataButton)
                    removeDataButton.addEventListener('click', () => cleanSiteData(false));

                const startFrames = document.querySelector('.start-frames');
                if (startFrames) {
                    ['click', 'touchend'].forEach(evt =>
                        startFrames.addEventListener(evt, async function (event) {
                            await handleFileContainerEvents(event, `start-frameDB-${pageName}`, 'start-frames', startFrames, databases);
                        })
                    );
                }

                const inputs = document.querySelector('.inputs');
                if (inputs) {
                    ['click', 'touchend'].forEach(evt =>
                        inputs.addEventListener(evt, async function (event) {
                            await handleFileContainerEvents(event, `inputDB-${pageName}`, 'inputs', inputs, databases);
                        })
                    );
                }

                const outputs = document.querySelector('.outputs');
                if (outputs) {
                    ['click', 'touchend'].forEach(evt =>
                        outputs.addEventListener(evt, async function (event) {
                            await handleFileContainerEvents(event, `outputDB-${pageName}`, 'outputs', outputs, databases);
                        })
                    );
                }

                document.querySelectorAll('.question-mark').forEach(questionMark => {
                    questionMark.addEventListener('click', (event) => {
                        event.stopPropagation();
                    });
                });

                const promptMethodCheckbox = document.getElementById('promptMethod');
                const referenceImageCheckbox = document.getElementById('referenceImageMethod');

                const positivePromptDiv = document.getElementById('positivePrompt').parentElement.parentElement;
                const negativePromptDiv = document.getElementById('negativePrompt').parentElement.parentElement;
                const referenceImageContainer = document.getElementById('referenceImageContainer');

                function togglePrompts() {
                    if (referenceImageCheckbox.checked) {
                        positivePromptDiv.style.display = 'none';
                        negativePromptDiv.style.display = 'none';
                        referenceImageContainer.style.display = 'unset';
                    } else {
                        positivePromptDiv.style.display = '';
                        negativePromptDiv.style.display = '';
                        referenceImageContainer.style.display = 'none';
                    }

                    setTimeout(() => {
                        if (referenceImageCheckbox.checked) {
                            positivePromptDiv.style.display = 'none';
                            negativePromptDiv.style.display = 'none';
                            referenceImageContainer.style.display = 'unset';
                        } else {
                            positivePromptDiv.style.display = '';
                            negativePromptDiv.style.display = '';
                            referenceImageContainer.style.display = 'none';
                        }
                    }, 1);
                }

                promptMethodCheckbox.addEventListener('change', togglePrompts);
                referenceImageCheckbox.addEventListener('change', togglePrompts);

                togglePrompts();

                let model = null;

                const rectangles = document.querySelectorAll(".rectangle");

                rectangles.forEach((rectangle) => {
                    if (rectangle.classList.contains('selected')) {
                        const checked = rectangle.querySelector('input[type="checkbox"]:checked');
                        if (checked) {
                            model = checked.id;
                        } else {
                            model = rectangle.id;
                        }
                    }

                    rectangle.addEventListener("click", () => {
                        rectangles.forEach((rect) => rect.classList.remove("selected"));
                        rectangle.classList.add("selected");

                        const checked = rectangle.querySelector('input[type="checkbox"]:checked');
                        if (checked) {
                            model = checked.id;
                        } else {
                            model = rectangle.id; 
                        }
                    });
                });

                if (!model)
                    model = 'realistic 1.5';

                const showServers = document.getElementById('showServers');
                const serverListContainer = document.getElementById('serverList');
                serverListContainer.style.display = showServers.checked ? 'block' : 'none';

                showServers.addEventListener('click', async () => {
                    serverListContainer.style.display = showServers.checked ? 'block' : 'none';
                });

                fileUploads.forEach(config => setupFileUpload({ ...config, changeHandler: handleUpload }));
                createSectionAndElements();

                const removeBannerCheckbox = document.getElementById("removeBanner");
                if (removeBannerCheckbox && userDoc?.paid && localStorage.getItem(`bannerChecked_${pageName}`) === null) {
                    removeBannerCheckbox.checked = true;
                    localStorage.setItem(`bannerChecked_${pageName}`, "true");
                }

                const negativeSVG = document.getElementById('negativeSVG');
                const negativePrompt = document.getElementById('negativePrompt');

                if (!localStorage.getItem('negativePromptSet')) {
                    if (negativePrompt) {
                        negativePrompt.value = `bright colors, overexposed, static, blurred details, subtitles, style, artwork, painting, picture, still, overall gray, worst quality, low quality, JPEG compression residue, ugly, incomplete, extra fingers, poorly drawn hands, poorly drawn faces, deformed, disfigured, malformed limbs, fused fingers, still picture, cluttered background, three legs, walking backwards`;
                        localStorage.setItem('negativePromptSet', '1');
                    }
                }

                let isNegativeVisible = localStorage.getItem('negativePromptVisible') !== 'false';
                updateVisibility(isNegativeVisible, negativeSVG, negativePrompt, false); // Initial load without transition

                negativeSVG.addEventListener('click', () => {
                    isNegativeVisible = !isNegativeVisible;
                    localStorage.setItem('negativePromptVisible', isNegativeVisible);
                    updateVisibility(isNegativeVisible, negativeSVG, negativePrompt, true); // Apply transition on interaction
                });

                function updateVisibility(isVisible, negativeSVG, negativePrompt, withTransition) {
                    if (negativePrompt)
                        negativePrompt.style.display = isVisible ? 'block' : 'none';
                    if (negativeSVG) {
                        negativeSVG.style.transform = isVisible ? 'rotate(0deg)' : 'rotate(180deg)';
                        if (withTransition) {
                            negativeSVG.style.transition = 'transform 0.3s ease';
                        } else {
                            negativeSVG.style.transition = 'none';
                        }
                    }
                }

                const handleProcessBtn = document.getElementById('handleProcessBtn');
                const handleProcessText = handleProcessBtn.querySelector('span');

                async function handleProcess() {
                    if (handleProcessBtn.getAttribute('processing') === 'true') {
                        handleProcessBtn.disabled = true;
                        handleProcessText.textContent = 'Cancelling...'
                        updateDownloadFile(false, databases, userData.uid);
                        return await cancelProcess(true);
                    }

                    handleProcessBtn.disabled = true;

                    try {
                        showNotification(`Starting the process...`, 'Process - Information', 'information');

                        if (typeof userData !== 'object' || !userData?.uid) {
                            const openSignInContainer = document.getElementById('openSignInContainer');
                            if (openSignInContainer)
                                openSignInContainer.click();
                            handleProcessBtn.disabled = false;
                            showNotification(`Please sign in or create an account to use our AI services with free (daily) trial.`, 'Warning - No User Found', 'warning-important');
                            return;
                        }

                        const dataContainer = document.createElement('div');
                        dataContainer.className = 'data-container';

                        const processText = document.createElement('div');
                        processText.className = 'process-text';
                        dataContainer.appendChild(processText);

                        const outputs = document.querySelector('.outputs');
                        outputs.style.display = 'flex';
                        outputs.insertBefore(dataContainer, outputs.firstChild);

                        if (!userData.emailVerified) {
                            setClientStatus('Verify Your Email');
                            showNotification(`Please verify your email.`, 'Warning - No Input Selected', 'warning-important');
                            handleProcessBtn.disabled = false;
                            return;
                        }

                        const downloadTab = document.querySelector('.tab[for="downloadTab"]');
                        if (!downloadTab.classList.contains('active')) {
                            const processTabChild = document.getElementById('processTab');
                            processTabChild.style.display = 'none';

                            const downloadTabChild = document.getElementById('downloadTab');
                            downloadTabChild.style.display = 'flex';

                            const processTab = document.querySelector('.tab[for="processTab"]');
                            processTab.classList.remove('active');
                            downloadTab.classList.add('active');
                        }

                        userDoc = await getUserDoc();

                        const denoiseSkippingPercentage = getCheckedCheckboxIdFromCombobox('denoiseSkippingPercentage', 0);
                        const quality = getCheckedCheckboxIdFromCombobox('quality', 3);
                        const duration = getCheckedCheckboxIdFromCombobox('duration', 3);

                        const maskCustomPositivePrompt = document.getElementById('maskCustomPositivePrompt');
                        const maskCustomPositivePromptValue = maskCustomPositivePrompt.value.trim();
                        const maskCustomPositivePromptValueKeyCount = maskCustomPositivePromptValue.replace(/[, ]/g, '').length;

                        const maskPromptPositiveSelection = getCheckedCheckboxIdFromCombobox('positiveMaskPrompt', maskCustomPositivePromptValueKeyCount <= 1 ? 'clothes' : '');
                        let positiveMaskPrompt = maskPromptPositiveSelection;
                        if (maskCustomPositivePromptValueKeyCount > 1) {
                            positiveMaskPrompt += maskPromptPositiveSelection ? ', ' + maskCustomPositivePromptValue : maskCustomPositivePromptValue;
                        }

                        positiveMaskPrompt = positiveMaskPrompt.toLowerCase();

                        const maskCustomNegativePrompt = document.getElementById('maskCustomNegativePrompt');
                        const maskCustomNegativePromptValue = maskCustomNegativePrompt.value.trim();
                        const maskCustomNegativePromptValueKeyCount = maskCustomNegativePromptValue.replace(/[, ]/g, '').length;

                        const maskPromptNegativeSelection = getCheckedCheckboxIdFromCombobox('negativeMaskPrompt', maskCustomNegativePromptValueKeyCount <= 1 ? 'none' : '');
                        let negativeMaskPrompt = maskPromptNegativeSelection;
                        if (maskCustomNegativePromptValueKeyCount > 1) {
                            negativeMaskPrompt += maskPromptNegativeSelection ? ', ' + maskCustomNegativePromptValue : maskCustomNegativePromptValue;
                        }

                        negativeMaskPrompt = negativeMaskPrompt.toLowerCase();

                        const invertMask = document.getElementById('invertMask').checked;
                        const promptOptimizations = document.getElementById('promptOptimizations').checked;
                        const depthDetection = document.getElementById('depthDetection').checked;
                        const poseDetection = document.getElementById('poseDetection').checked;
                        const analyzeImage = document.getElementById('analyzeImage').checked;
                        const removeBanner = document.getElementById('removeBanner').checked;
                        const losslessEncoder = document.getElementById('losslessEncoder').checked;
                        const randomizeSeed = document.getElementById('randomizeSeed').checked;

                        let neededCredits = 1;
                        neededCredits *= Number(duration);
                        neededCredits *= 1 + (Number(quality) - 1) * 0.5;

                        if (removeBanner) neededCredits *= 2;
                        neededCredits = Math.max(1, Math.round(neededCredits));

                        async function getServerAddresses() {
                            try {
                                const snapshotPromise = getDocsSnapshot('servers');
                                const keepSlowServers = true;

                                return await fetchServerAddresses(snapshotPromise, keepSlowServers);
                            } catch (error) {
                                showNotification(`Failed to get server addresses.`, 'Warning', 'warning');
                                return null;
                            }
                        }

                        let inputFile = 'null';
                        let inputFileName = 'null';

                        const activePhotoInput = document.querySelector(".inputs .data-container.active img");

                        async function isGifImage(imgEl) {
                            if (!imgEl) return false;
                            const src = imgEl.src;

                            if (src.toLowerCase().endsWith('.gif') || src.startsWith('data:image/gif')) {
                                return true;
                            }

                            if (src.startsWith('blob:')) {
                                const response = await fetch(src);
                                const blob = await response.blob();
                                return blob.type === 'image/gif';
                            }

                            return false;
                        }

                        const activeVideoInput = document.querySelector(".inputs .data-container.active video");
                        const isVideo = (await isGifImage(activePhotoInput)) || !!activeVideoInput;
                        const activeInput = activePhotoInput ? activePhotoInput : activeVideoInput;
                        const src = activeInput.querySelector('source')?.src ? activeInput.querySelector('source')?.src : activeInput?.src;

                        const extension = isVideo ? 'mp4' : 'png';
                        const typeIndicator = isVideo ? '0' : '1';

                        if (activeInput) {
                            const timestamp = activeInput?.getAttribute('timestamp');
                            const id = activeInput?.getAttribute('id');

                            if (!timestamp || !id) {
                                setClientStatus(`Timestamp or id is missing.`);
                                showNotification(`Timestamp or id is missing. Cannot create input file name. Please contact an administrator.`, 'Warning - Process Failed', 'warning-important');
                                return;
                            }

                            function sanitizeFilenamePart(str) {
                                return String(str).replace(/[^a-zA-Z0-9_-]/g, '');
                            }

                            const userName = sanitizeFilenamePart(userDoc.username);
                            const timestampStr = sanitizeFilenamePart(timestamp);
                            const idStr = sanitizeFilenamePart(id);
                            inputFileName = `${userName}_${neededCredits}_${timestampStr}_${idStr}_${typeIndicator}.${extension}`;
                            inputFile = await processDataToFile(src, inputFileName);

                            if (!inputFile) {
                                handleProcessBtn.disabled = false;
                                setClientStatus(`Blob to file failed`);
                                showNotification(`Failed to create files.`, 'Warning - Process Failed', 'warning-important');
                                return;
                            }

                            const MAX_FILE_SIZE_MB = 50;

                            if (inputFile.size > MAX_FILE_SIZE_MB * 1024 * 1024) {
                                handleProcessBtn.disabled = false;
                                setClientStatus(`Size exceeds ${MAX_FILE_SIZE_MB}MB limit`);
                                showNotification(`Size exceeds ${MAX_FILE_SIZE_MB}MB limit`, 'Process - Information', 'warning-important');
                                return;
                            }
                        }

                        let startFrameFile = 'null';
                        let startFrameFileName = 'null';

                        const referenceInput = document.querySelector(".start-frames .data-container.active img");

                        if (referenceInput && referenceImageCheckbox.checked) {
                            const timestamp = referenceInput?.getAttribute('timestamp');
                            const id = referenceInput?.getAttribute('id');

                            if (!timestamp || !id) {
                                setClientStatus(`Timestamp or id is missing.`);
                                showNotification(`Timestamp or id is missing. Cannot create input file name. Please contact an administrator.`, 'Warning - Process Failed', 'warning-important');
                                return;
                            }

                            function sanitizeFilenamePart(str) {
                                return String(str).replace(/[^a-zA-Z0-9_-]/g, '');
                            }

                            const userName = sanitizeFilenamePart(userDoc.username);
                            const timestampStr = sanitizeFilenamePart(timestamp);
                            const idStr = sanitizeFilenamePart(id);
                            startFrameFileName = `${userName}_${neededCredits}_${timestampStr}_${idStr}_start_frame_1.png`;
                            startFrameFile = await processDataToFile(referenceInput.src, startFrameFileName);

                            if (!startFrameFile) {
                                handleProcessBtn.disabled = false;
                                setClientStatus(`Blob to file failed`);
                                showNotification(`Failed to create files.`, 'Warning - Process Failed', 'warning-important');
                                return;
                            }

                            const MAX_FILE_SIZE_MB = 50;

                            if (startFrameFile.size > MAX_FILE_SIZE_MB * 1024 * 1024) {
                                handleProcessBtn.disabled = false;
                                setClientStatus(`Size exceeds ${MAX_FILE_SIZE_MB}MB limit`);
                                showNotification(`Size exceeds ${MAX_FILE_SIZE_MB}MB limit`, 'Process - Information', 'warning-important');
                                return;
                            }
                        }

                        let userInternetProtocol, userUniqueBrowserId, serverAddresses;

                        const timeoutDuration = 15000;
                        let remainingTime = timeoutDuration / 1000;

                        setClientStatus(`Creating ID... ${remainingTime}`);

                        const countdownInterval = setInterval(() => {
                            remainingTime--;
                            if (remainingTime <= 0) {
                                clearInterval(countdownInterval);
                                return;
                            }
                            setClientStatus(`Creating ID... ${remainingTime}`);
                        }, 1000);

                        const timeout = new Promise((_, reject) =>
                            setTimeout(() => {
                                clearInterval(countdownInterval);
                                reject(new Error('Process took longer than 15 seconds.'));
                            }, timeoutDuration)
                        );

                        try {
                            showNotification("Creating ID's...", 'Process - Information', 'information');

                            if (!cannotBeBanned(userDoc)) {
                                [userInternetProtocol, userUniqueBrowserId, serverAddresses] = await Promise.race([
                                    (async () => {
                                        setClientStatus("Protocol ID's...");
                                        userInternetProtocol = await getUserInternetProtocol();

                                        setClientStatus("Unique ID's...");
                                        userUniqueBrowserId = await ensureUniqueId();

                                        setClientStatus("Connecting Servers...");
                                        serverAddresses = await getServerAddresses();

                                        return [userInternetProtocol, userUniqueBrowserId, serverAddresses];
                                    })(),
                                    timeout
                                ]);
                            } else {
                                [serverAddresses] = await Promise.race([
                                    (async () => {
                                        setClientStatus("Connecting Servers...");
                                        serverAddresses = await getServerAddresses();
                                        return [serverAddresses];
                                    })(),
                                    timeout
                                ]);
                            }
                        } catch (error) {
                            setClientStatus("Connection Failed...");
                            showNotification(
                                `Failed to create IDs. Consider disabling extensions or Adblockers. ${error.message}`,
                                'Warning',
                                'warning'
                            );
                            return;
                        } finally {
                            clearInterval(countdownInterval);
                        }

                        if (!cannotBeBanned(userDoc)) {
                            const proxyNotifications = {
                                isTOR: {
                                    message: "TOR users restricted due to multi-accounting concerns. Disable TOR to avoid issues.",
                                    title: 'Warning - Proxy',
                                    type: 'warning-important'
                                },
                                isVPN: {
                                    message: "Using a VPN may cause errors, slow processes, and affect downloads. Consider disabling your VPN for improved performance.",
                                    title: 'Warning - VPN',
                                    type: 'warning-important'
                                },
                                isProxy: {
                                    message: "Using a proxy may cause errors, slow processes, and affect downloads. Consider disabling your proxy for better performance.",
                                    title: 'Warning - Proxy',
                                    type: 'warning-important'
                                }
                            };

                            for (const [key, { message, title, type }] of Object.entries(proxyNotifications)) {
                                if (userInternetProtocol[key]) {
                                    showNotification(message, title, type);
                                }
                            }
                        }

                        const suffixOrder = ["s", "d", "f", "g", "h", "j", "k", "l"];
                        const serverId = serverID().toLowerCase();

                        const parsedServers = serverAddresses.map(addr => {
                            const regex = new RegExp(`https:\/\/([^/]+)-(\\d+)-${serverId}\\.deepany\\.top`, "i");
                            const match = addr.match(regex);
                            if (!match) {
                                return { addr, major: 0, minor: 0, index: Infinity, suffix: "" };
                            }
                            const [, model, indexStr] = match;
                            const index = parseInt(indexStr, 10);
                            const parts = model.split('-');
                            const gpuNumber = parseInt(parts[0], 10);
                            const suffix = parts[1] ? parts[1].toLowerCase() : "";

                            const major = Math.floor(gpuNumber / 100);
                            const minor = gpuNumber % 100;

                            return { addr, major, minor, index, suffix };
                        });

                        function getSuffixRank(s) {
                            if (!s) return -1;
                            const pos = suffixOrder.indexOf(s);
                            return pos === -1 ? -1 : (suffixOrder.length - pos);
                        }

                        parsedServers.sort((a, b) => {
                            if (a.index !== b.index) return a.index - b.index;
                            if (a.major !== b.major) return b.major - a.major;
                            if (a.minor !== b.minor) return b.minor - a.minor;
                            return getSuffixRank(b.suffix) - getSuffixRank(a.suffix);
                        });

                        let sortedServerAddresses = parsedServers.map(p => p.addr.toLowerCase());
                        let serverQueueResults = await Promise.all(
                            sortedServerAddresses.map(server => checkServerQueue(server))
                        );

                        function getGroupKey(addr) {
                            const match = addr.match(/https:\/\/(\d+)(?:-([a-z]+))?-/i);
                            if (!match) return '';
                            const gpu = match[1];
                            const suffix = match[2] ? match[2].toLowerCase() : "";
                            return suffix ? `${gpu}-${suffix}` : gpu;
                        }

                        const groupAggregates = {};
                        const isolatedServers = new Set([
                            "https://rtl-3-5090-1-dn.deepany.top",
                        ].map(s => s.toLowerCase()));

                        sortedServerAddresses.forEach((server, i) => {
                            const key = getGroupKey(server);
                            if (!groupAggregates[key]) groupAggregates[key] = 0;
                            if (serverQueueResults[i])
                                groupAggregates[key] += 1;
                        });

                        function effectiveQueue(server) {
                            const key = getGroupKey(server);
                            const groupQ = (groupAggregates[key] || 0);
                            return groupQ;
                        }

                        const adjustQueue = (server) => {
                            if (isVideo && isolatedServers.has(server))
                                return Infinity;

                            let effQ = serverQueueResults[sortedServerAddresses.indexOf(server)] + (effectiveQueue(server) / 2);
                            return effQ;
                        };

                        const adjustedQueues = sortedServerAddresses.map(server => adjustQueue(server));
                        const minQueueIndex = adjustedQueues.reduce((minIndex, queue, id, arr) =>
                            queue < arr[minIndex] ? id : minIndex,
                            0
                        );

                        if (adjustedQueues[minQueueIndex] === Infinity) {
                            handleProcessBtn.disabled = false;
                            setClientStatus("Offline");
                            showNotification(
                                `Cannot fetch the server. A VPN could cause this or our server is currently offline. Contact an admin for more information.`,
                                "Warning - Process Failed",
                                "warning-important"
                            );
                            return;
                        }

                        const userName = userDoc.username.replace(/[^a-zA-Z0-9_]/g, '');
                        const fileOutputId = `${Math.random().toString(36).substring(2, 15)}_${userName}_${neededCredits}_${typeIndicator}`;

                        setFetchableServerAdresses([sortedServerAddresses[minQueueIndex]]);
                        const serverAddress = getFetchableServerAdresses()[0];
                        setFetchableServerAdresses([serverAddress]);
                        setClientStatus(`Connecting`);
                        showNotification(`Connecting to ${serverAddress}...`, "Process - Information", "information");

                        const positivePrompt = document.getElementById("positivePrompt").value;
                        const negativePrompt = document.getElementById("negativePrompt").value;

                        const processToken = localStorage.getItem('processToken') || crypto.randomUUID();
                        localStorage.setItem('processToken', processToken);

                        const formData = new FormData();
                        formData.append('userId', userData.uid);
                        formData.append('processToken', processToken);
                        formData.append('imageFile', inputFile);
                        formData.append('referenceFile', startFrameFile);
                        formData.append('imageMask', 'null');
                        formData.append('modeSelector', model);
                        formData.append('quality', quality);
                        formData.append('denoiseSkippingPercentage', denoiseSkippingPercentage);
                        formData.append('duration', duration);
                        formData.append('positiveMaskPrompt', positiveMaskPrompt);
                        formData.append('negativeMaskPrompt', negativeMaskPrompt);
                        formData.append('losslessEncoder', losslessEncoder);
                        formData.append('randomizeSeed', randomizeSeed);
                        formData.append('removeBanner', removeBanner);
                        formData.append('analyzeImage', analyzeImage);
                        formData.append('promptOptimizations', promptOptimizations);
                        formData.append('invertMask', invertMask);
                        formData.append('depthDetection', depthDetection);
                        formData.append('poseDetection', poseDetection);
                        formData.append('positivePrompt', positivePrompt);
                        formData.append('negativePrompt', negativePrompt);
                        formData.append('userInternetProtocolAddress', userInternetProtocol?.userInternetProtocolAddress);
                        formData.append('userUniqueInternetProtocolId', userInternetProtocol?.userUniqueInternetProtocolId);
                        formData.append('fileOutputId', fileOutputId);
                        formData.append('userUniqueBrowserId', userUniqueBrowserId);

                        showNotification(`Sending your configuration to the server...`, 'Upload', 'information');
                        setClientStatus('Configurating...');

                        const response = await fetchWithRandom(`${serverAddress}/start-process`, {
                            method: 'POST',
                            body: formData
                        });

                        if (response.status !== STATUS_OK) {
                            const data = await response.json();
                            console.error(data.server);
                            throw new Error(data.server);
                        }

                        const result = await response.json();
                        showNotification(`Creating output database using IndexedDB...`, 'Database - IndexedDB', 'information');

                        const db = await openDB(`outputDB-${pageName}`, 'outputs');
                        const url = serverAddress + '/download-output/' + fileOutputId;
                        const firstChild = outputs.firstChild;

                        if (firstChild && !firstChild.dataset.created) {
                            firstChild.dataset.created = true;
                            firstChild.innerHTML = `<div class="process-text">Indexing</div>`;

                            function formDataToObject(formData) {
                                const obj = {};
                                const excludeKeys = new Set([
                                    'userId',
                                    'userInternetProtocolAddress',
                                    'userUniqueBrowserId',
                                    'userUniqueInternetProtocolId',
                                    'fileOutputId',
                                    'imageFile',
                                    'startFrameFile',
                                    'processToken'
                                ]);

                                formData.append('inputFileName', inputFileName);
                                formData.append('startFrameFileName', startFrameFileName);

                                for (const [key, value] of formData.entries()) {
                                    if (!(value instanceof File) && !excludeKeys.has(key)) {
                                        obj[key] = value;
                                    }
                                }
                                return obj;
                            }

                            const formDataObject = formDataToObject(formData);
                            localStorage.setItem(`${url}_formData`, JSON.stringify(formDataObject));

                            await addToDB(db, [null, url], false);
                            await saveCountIndex(databases);

                            const data = await getFromDB(db);
                            const entry = data.find(item => item.url === url);
                            firstChild.innerHTML = `<initial url="${entry.url}" id="${entry.id}" timestamp="${entry.timestamp}" processing></initial><div class="process-text">Indexing</div><div class="delete-icon"></div>`;
                        }

                        showNotification(`Starting the process...`, 'Upload', 'information');
                        setClientStatus('Starting...');
                        updateDownloadFile(true, databases, userData.uid);
                        return result;
                    } catch (error) {
                        console.error(error.message);
                        handleProcessBtn.disabled = false;
                        setClientStatus(error.message);
                        cancelProcess(false);
                    }
                }

                if (handleProcessBtn)
                    handleProcessBtn.addEventListener('click', async () => {
                        await handleProcess();
                    });

                const downloadOutput = document.getElementById('downloadOutput');
                if (downloadOutput) {
                    const activeDataContainer = document.querySelector(".outputs .data-container.active");
                    if (!activeDataContainer) {
                        downloadOutput.disabled = true;
                        //showNotification(`Maintaince for IOS downloads (Not important if you are not IOS).`, 'Warning - Download', 'warning');
                    }

                    downloadOutput.addEventListener('click', async () => {
                        const activeDataContainer = document.querySelector(".outputs .data-container.active");
                        if (!activeDataContainer) {
                            showNotification(`No active output container selected.`, 'Warning - Download', 'warning');
                            return;
                        }

                        const activeInput = activeDataContainer.querySelector('img, video, initial');
                        if (!activeInput) {
                            showNotification(`No active input element found.`, 'Warning - Download', 'warning');
                            return;
                        }

                        if (downloadOutput.textContent === "Pause") {
                            const abortController = getAbortController();
                            if (abortController) {
                                abortController.abort();
                                resetAbortController();
                                setDownloadCancelled(true);
                                showNotification(`Download paused successfully.`, 'Download - Paused', 'info');
                            } else {
                                showNotification(`No active download to pause.`, 'Warning - Pause', 'warning');
                            }

                            downloadOutput.textContent = "Resume";
                            downloadOutput.classList.add("important");
                            return;
                        }

                        if (downloadOutput.textContent === "Resume") {
                            const selectedOutputInfo = {
                                db: await openDB(`outputDB-${pageName}`, 'outputs'),
                                url: activeInput.getAttribute('url'),
                                timestamp: parseInt(activeInput.getAttribute('timestamp')),
                                element: activeInput.parentElement,
                                id: parseInt(activeInput.getAttribute('id')),
                                active: activeInput.getAttribute('active'),
                            };

                            showNotification(`Resuming download for output ID: ${selectedOutputInfo.id}.`, 'Download - Resuming', 'info');
                            return await handleDownload(selectedOutputInfo);
                        }

                        if (activeInput) {
                            const id = activeInput.getAttribute('id');
                            const fileName = 'output_' + `${id}.${activeInput.tagName === 'VIDEO' ? 'mp4' : 'png'}`;

                            const domIndex = parseInt(activeInput.getAttribute('id'));
                            const db = await openDB(`outputDB-${pageName}`, 'outputs');
                            const items = await getFromDB(db);
                            const item = items.find(item => item.id === domIndex);
                            if (!item || !item.blob) {
                                throw new Error(`No blob found for ID: ${domIndex}`);
                            }

                            let type = '';
                            if (activeInput) {
                                if (activeInput.tagName === 'IMG') {
                                    type = 'image/png';
                                } else if (activeInput.tagName === 'VIDEO') {
                                    type = 'video/mp4';
                                } else {
                                    showNotification('Error: Unsupported element type for download.', 'Error - Download', 'error');
                                    return;
                                }
                            }
                            let methodUsed = 0;
                            try {
                                if (window.showSaveFilePicker) {
                                    methodUsed = 1;
                                    showNotification('Attempting to use showSaveFilePicker...', 'Download - Info', 'info');

                                    const fileHandle = await window.showSaveFilePicker({
                                        suggestedName: fileName,
                                        types: [
                                            { description: 'Video Files', accept: { 'video/mp4': ['.mp4'], 'video/webm': ['.webm'] } },
                                            { description: 'Image Files', accept: { 'image/png': ['.png'], 'image/jpeg': ['.jpg'] } },
                                        ],
                                    });

                                    const writableStream = await fileHandle.createWritable();
                                    await writableStream.write(item.blob);
                                    await writableStream.close();
                                    showNotification(`File saved successfully: ${fileName}`, 'Download - Success', 'success');
                                } else if (navigator.share) {
                                    methodUsed = 2;
                                    showNotification('Attempting to use navigator.share...', 'Download - Info', 'info');

                                    const fileToShare = new File([item.blob], fileName, { type });
                                    await navigator.share({ title: fileName, files: [fileToShare] });
                                    showNotification(`File shared successfully: ${fileName}`, 'Download - Shared', 'success');
                                } else {
                                    methodUsed = 3;
                                    showNotification('Attempting to use <a> tag for download...', 'Download - Info', 'info');

                                    const objectURL = URL.createObjectURL(item.blob);
                                    const a = document.createElement('a');
                                    a.href = objectURL;
                                    a.download = fileName;
                                    document.body.appendChild(a);
                                    a.click();
                                    document.body.removeChild(a);
                                    URL.revokeObjectURL(objectURL);
                                    showNotification(`File downloaded successfully: ${fileName}`, 'Download - Success', 'success');
                                }
                            } catch (error) {
                                if (error.name === 'AbortError') {
                                    showNotification(`Download was aborted for: ${fileName}`, 'Error - Aborted', 'error');
                                    return;
                                }

                                showNotification(`First method failed (Error: ${error.message} - Method: ${methodUsed}), retrying in 1000ms for file: ${fileName}...`, 'Error - Download', 'error');
                                setTimeout(() => {
                                    const objectURL = URL.createObjectURL(item.blob);
                                    const a = document.createElement('a');
                                    a.href = objectURL;
                                    a.download = fileName;

                                    if (!iosMobileCheck()) {  // Only execute this on non-iOS devices
                                        try {
                                            document.body.appendChild(a);
                                            a.click();
                                            document.body.removeChild(a);
                                            URL.revokeObjectURL(objectURL);
                                            showNotification(`File downloaded successfully: ${fileName}`, 'Download - Success', 'success');
                                        } catch (error) {
                                            showNotification(`Failed to download the file (Error: ${error.message})`, 'Error - Download', 'error');
                                        }
                                    } else {
                                        showNotification(`Skipping download method for iOS devices: ${fileName}`, 'Download - Info', 'info');
                                        try {
                                            const newTab = window.open(objectURL, '_blank');
                                            if (!newTab) {
                                                showNotification(`Failed to open the file in a new tab for: ${fileName}`, 'Error - Open Tab', 'error');
                                            } else {
                                                setTimeout(() => {
                                                    URL.revokeObjectURL(objectURL);
                                                }, 1000);
                                            }
                                        } catch (tabError) {
                                            showNotification(`Failed to open in a new tab (Error: ${tabError.message})`, 'Error - Tab Open', 'error');
                                        }
                                    }
                                }, 1000);
                            }
                        } else {
                            showNotification(`No output is selected.`, 'Warning - Download', 'warning');
                        }
                    });
                }

                const viewOutput = document.getElementById('viewOutput');
                if (viewOutput) {
                    const activeDataContainer = document.querySelector(".outputs .data-container.active");
                    if (!activeDataContainer) viewOutput.disabled = true;

                    viewOutput.addEventListener('click', async () => {
                        const activeDataContainer = document.querySelector(".outputs .data-container.active");
                        const activeInput = activeDataContainer.querySelector('img, video, initial');

                        if (activeInput) {
                            if (viewOutput.textContent === 'Fetch') {
                                const abortController = getAbortController();
                                if (abortController) {
                                    abortController.abort();
                                    resetAbortController();
                                    downloadOutput.textContent = "Resume";
                                    setDownloadCancelled(true);
                                }

                                return window.open(activeInput.getAttribute('url'), '_blank');
                            }

                            if (activeInput.tagName === 'INITIAL') {
                                alert('Initial element cannot be viewed.');
                                return;
                            }

                            const existingWrapper = document.getElementById('wrapper');
                            if (existingWrapper) return;

                            const wrapper = document.createElement('div');
                            wrapper.id = 'wrapper';

                            const backgroundContainer = document.createElement('div');
                            backgroundContainer.className = 'background-container';

                            const backgroundDotContainer = document.createElement('a');
                            backgroundDotContainer.className = 'background-dot-container';

                            const backgroundDotContent = document.createElement('div');
                            backgroundDotContent.className = 'background-dot-container-content';
                            backgroundDotContent.style.padding = '0';

                            const innerContainer = document.createElement('div');
                            innerContainer.className = 'background-container';
                            innerContainer.style.display = 'contents';
                            innerContainer.id = 'innerContainer';

                            let mediaElement;

                            if (activeInput.tagName === 'VIDEO') {
                                mediaElement = document.createElement('video');
                                mediaElement.controls = true;
                                mediaElement.loop = true;
                                mediaElement.src = activeInput.querySelector('source')?.src ? activeInput.querySelector('source')?.src : activeInput?.src;
                                mediaElement.style.maxWidth = '100vw';
                                mediaElement.style.maxHeight = '94vh';
                                mediaElement.style.borderRadius = 'var(--border-radius)';
                                mediaElement.style.objectFit = 'cover';
                            } else if (activeInput.tagName === 'IMG') {
                                mediaElement = document.createElement('img');
                                mediaElement.src = activeInput.src;
                                mediaElement.style.maxWidth = '100vw';
                                mediaElement.style.maxHeight = '94vh';
                                mediaElement.style.borderRadius = 'var(--border-radius)';
                                mediaElement.style.objectFit = 'cover';
                            }

                            if (!mediaElement.src) {
                                wrapper.remove();
                                alert('Media source not found.');
                                return;
                            }

                            // Close Button
                            const closeButton = document.createElement('button');
                            closeButton.className = 'close-button';
                            closeButton.style.position = 'absolute';
                            closeButton.style.top = '1vh';
                            closeButton.style.right = '1vh';
                            closeButton.style.cursor = 'pointer';
                            closeButton.style.width = '4vh';
                            closeButton.style.height = '4vh';
                            closeButton.style.padding = '0';
                            closeButton.style.margin = '0';

                            const closeButtonIcon = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
                            closeButtonIcon.setAttribute('xmlns', 'http://www.w3.org/2000/svg');
                            closeButtonIcon.setAttribute('viewBox', '0 0 24 24');
                            closeButtonIcon.setAttribute('fill', 'none');
                            closeButtonIcon.setAttribute('stroke', 'currentColor');
                            closeButtonIcon.setAttribute('stroke-width', '2');
                            closeButtonIcon.setAttribute('stroke-linecap', 'round');
                            closeButtonIcon.setAttribute('stroke-linejoin', 'round');
                            closeButtonIcon.style.margin = '0';
                            closeButtonIcon.style.width = 'calc((3.5vh * var(--scale-factor-h)))';
                            closeButtonIcon.classList.add('lucide', 'lucide-x');

                            const path1 = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                            path1.setAttribute('d', 'M18 6 6 18');
                            const path2 = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                            path2.setAttribute('d', 'm6 6 12 12');

                            closeButtonIcon.appendChild(path1);
                            closeButtonIcon.appendChild(path2);

                            closeButton.appendChild(closeButtonIcon);
                            closeButton.addEventListener('click', () => {
                                wrapper.remove();
                            });

                            const reportButton = document.createElement('button');
                            reportButton.className = 'report-button';
                            reportButton.style.position = 'absolute';
                            reportButton.style.bottom = '1vh';
                            reportButton.style.right = '1vh';

                            reportButton.innerHTML = 'Report Content';
                            reportButton.addEventListener('click', () => {
                                showNotification(
                                    `Thank you for reporting inappropriate content. Our moderation team will review the report and take appropriate action.`,
                                    'Reported Content',
                                    'warning-important'
                                );
                                wrapper.remove();
                                const deleteIconParent = activeDataContainer.querySelector('.delete-icon');
                                if (deleteIconParent) {
                                    deleteIconParent.click();
                                }
                            });

                            innerContainer.appendChild(mediaElement);
                            innerContainer.appendChild(closeButton);
                            //innerContainer.appendChild(reportButton);

                            backgroundDotContent.appendChild(innerContainer);
                            backgroundDotContainer.appendChild(backgroundDotContent);
                            backgroundContainer.appendChild(backgroundDotContainer);
                            wrapper.appendChild(backgroundContainer);
                            document.body.appendChild(wrapper);
                        }
                    });
                }

                if (getScreenMode() !== ScreenMode.PC) {
                    const baseContainer = document.getElementById('baseContainer');
                    if (baseContainer)
                        baseContainer.style.gridTemplateColumns = '';
                }
            }

            let previousScreenMode = null;

            async function sizeBasedElements() {
                setMaxWidth();
                const screenMode = getScreenMode();
                const shouldUpdate = previousScreenMode !== screenMode;
                previousScreenMode = screenMode;
                if (!shouldUpdate)
                    return;

                loadPageState();
                loadPage();
            }

            sizeBasedElements();

            window.addEventListener('resize', sizeBasedElements);
        });
    </script>
</body>
</html>
