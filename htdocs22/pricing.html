<!DOCTYPE html>
<html lang="en" style="background: rgba(24, 24, 24, 1);" class="loading-screen">
<head>
    <link rel="dns-prefetch" href="//deepany.ai">
    <link rel="preconnect" href="https://deepany.ai" crossorigin>

    <title>Pricing: Variety Of Options Tailored To Your Needs</title>
    <link rel="canonical" href="https://deepany.ai/pricing">

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="Discover the best pricing plans for DeepAny.AI. Choose from a variety of options tailored to your needs, and get access to advanced AI tools and services at competitive rates.">
    <meta name="keywords" content="AI, DeepAny, bodyswap, technology, services, solutions">
    <meta name="apple-mobile-web-app-title" content="Pricing" />

    <style id="loading-stylesheet">
        .loading-screen {
            position: fixed;
            top: 50%;
            left: 50%;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #ff7300;
            z-index: 999999;
            border-radius: 50%;
            width: 50px !important;
            height: 50px !important;
            animation: spin 2s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: translate(-50%, -50%) rotate(0deg);
            }

            100% {
                transform: translate(-50%, -50%) rotate(360deg);
            }
        }
    </style>
    <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "AggregateOffer",
            "offerCount": "15",
            "lowPrice": "9.99",
            "highPrice": "1399.99",
            "priceCurrency": "USD",
            "offers": [
                {
                    "@type": "Offer",
                    "priceCurrency": "USD",
                    "price": "9.99",
                    "availability": "https://schema.org/InStock",
                    "url": "https://deepany.ai/face-swap",
                    "name": "100 Credits"
                },
                {
                    "@type": "Offer",
                    "priceCurrency": "USD",
                    "price": "19.99",
                    "availability": "https://schema.org/InStock",
                    "url": "https://deepany.ai/face-swap",
                    "name": "250 Credits"
                },
                {
                    "@type": "Offer",
                    "priceCurrency": "USD",
                    "price": "24.99",
                    "availability": "https://schema.org/InStock",
                    "url": "https://deepany.ai/face-swap",
                    "name": "500 Credits"
                },
                {
                    "@type": "Offer",
                    "priceCurrency": "USD",
                    "price": "44.99",
                    "availability": "https://schema.org/InStock",
                    "url": "https://deepany.ai/face-swap",
                    "name": "1000 Credits"
                },
                {
                    "@type": "Offer",
                    "priceCurrency": "USD",
                    "price": "99.99",
                    "availability": "https://schema.org/InStock",
                    "url": "https://deepany.ai/face-swap",
                    "name": "2500 Credits"
                },
                {
                    "@type": "Offer",
                    "priceCurrency": "USD",
                    "price": "174.99",
                    "availability": "https://schema.org/InStock",
                    "url": "https://deepany.ai/face-swap",
                    "name": "5000 Credits"
                },
                {
                    "@type": "Offer",
                    "priceCurrency": "USD",
                    "price": "299.99",
                    "availability": "https://schema.org/InStock",
                    "url": "https://deepany.ai/face-swap",
                    "name": "10000 Credits"
                },
                {
                    "@type": "Offer",
                    "priceCurrency": "USD",
                    "price": "624.99",
                    "availability": "https://schema.org/InStock",
                    "url": "https://deepany.ai/face-swap",
                    "name": "25000 Credits"
                },
                {
                    "@type": "Offer",
                    "priceCurrency": "USD",
                    "price": "999.99",
                    "availability": "https://schema.org/InStock",
                    "url": "https://deepany.ai/face-swap",
                    "name": "50000 Credits"
                },
                {
                    "@type": "Offer",
                    "priceCurrency": "USD",
                    "price": "19.99",
                    "availability": "https://schema.org/InStock",
                    "url": "https://deepany.ai/face-swap",
                    "name": "1 Day Subscription"
                },
                {
                    "@type": "Offer",
                    "priceCurrency": "USD",
                    "price": "69.99",
                    "availability": "https://schema.org/InStock",
                    "url": "https://deepany.ai/face-swap",
                    "name": "7 Day Subscription"
                },
                {
                    "@type": "Offer",
                    "priceCurrency": "USD",
                    "price": "149.99",
                    "availability": "https://schema.org/InStock",
                    "url": "https://deepany.ai/face-swap",
                    "name": "30 Day Subscription"
                },
                {
                    "@type": "Offer",
                    "priceCurrency": "USD",
                    "price": "269.99",
                    "availability": "https://schema.org/InStock",
                    "url": "https://deepany.ai/face-swap",
                    "name": "90 Day Subscription"
                },
                {
                    "@type": "Offer",
                    "priceCurrency": "USD",
                    "price": "726.99",
                    "availability": "https://schema.org/InStock",
                    "url": "https://deepany.ai/face-swap",
                    "name": "1 Year Subscription"
                },
                {
                    "@type": "Offer",
                    "priceCurrency": "USD",
                    "price": "1399.99",
                    "availability": "https://schema.org/InStock",
                    "url": "https://deepany.ai/face-swap",
                    "name": "Lifetime Subscription"
                }
            ]
        }
    </script>
    <link rel="stylesheet" href="css/styles.css?v=5.3.5">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
    <link rel="shortcut icon" href="/favicon.ico?v=5.3.5" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="manifest" href="/site.webmanifest" />
    <script>
        (() => {
            if (!localStorage.getItem('version')) {
                localStorage.setItem('version', '5.3.5');
                return;
            }

            let version = localStorage.getItem('version');
            let url = new URL(window.location.href);
            let urlParams = url.searchParams;
            let urlVersionEncoded = urlParams.get('v');

            if (!urlVersionEncoded || urlVersionEncoded !== version) {
                urlParams.set('v', version);
                url.search = urlParams.toString();
                window.history.replaceState(null, '', url.toString());
            }

            let checkEnabled = true;
            let isInitialLoad = true;

            const checkVersion = async () => {
                if (!checkEnabled) return;

                try {
                    version = localStorage.getItem('version');

                    const response = await fetch(`${window.location.origin}/version?nocache=${Math.random()}`, { cache: 'no-store' });
                    const fetchedVersion = (await response.text()).trim();

                    localStorage.setItem('version', fetchedVersion);

                    if (!urlVersionEncoded || urlVersionEncoded != fetchedVersion || version != fetchedVersion) {
                        if (isInitialLoad) {
                            urlParams.set('v', fetchedVersion);
                            url.search = urlParams.toString();
                            window.location.href = url.toString();
                        } else {
                            const confirmed = confirm(`New version available (${fetchedVersion}). Would you like to reload now?`);
                            if (confirmed) {
                                urlParams.set('v', fetchedVersion);
                                url.search = urlParams.toString();
                                window.location.href = url.toString();
                            } else {
                                checkEnabled = false;
                            }
                        }
                    }
                } catch (err) {
                    console.error('Version check failed:', err);
                }

                isInitialLoad = false;
            };

            checkVersion(); //.then(() => history.replaceState(null, '', location.pathname + location.search.replace(/([?&])v=[^&]*(&|$)/, (m, sep, end) => sep === '?' && end ? '?' : sep === '&' && end ? '' : '')));
            setInterval(checkVersion, 1 * 60 * 1000);
        })();
    </script>
</head>
<body lang="en">
    <div id="paymentContainer" style="margin: 0; padding: 0; overflow: hidden; display: none; width: 100%; height: 100vh; position: absolute; z-index: 99999;"></div>
    <script type="module" defer>
        const version = new URLSearchParams(window.location.search).get('version') || localStorage.getItem('version') || '5.3.5';

        async function loadModule(url) {
            return import(`${url}?v=${version}`);
        }

        document.addEventListener('DOMContentLoaded', async function () {
            const functions = await loadModule('./scripts/functions.js');
            const { fetchWithRandom, showNotification, createSectionAndElements, getUserData, setCache, getCache, getPageName, setUser, setAuthentication, fetchConversionRates, getFirebaseModules, getDocSnapshot, getScreenMode, getCurrentMain, updateContent, createPages, setNavbar, setSidebar, showSidebar, removeSidebar, getSidebarActive, moveMains, setupMainSize, loadScrollingAndMain, showZoomIndicator, setScaleFactors, clamp, loadPageContent, retrieveImageFromURL, fetchServerAddress, ensureUniqueId, getUserInternetProtocol } = functions;

            const pageName = getPageName();

            function updateMainContent(screenMode, pageContent) {
                pageContent.length = 0;
                pageContent.push(`<div id="baseContainer" class="centered-container long" style="gap: 0;">
                                                                                                                                <div style="display: flex;flex-direction: column; gap: calc(2vh* var(--scale-factor-h));">
                                                                                                                                                <div class="background-container">
                                                                                                                                                    <p class="background-dot-container-option" id="credits-mode">Credits</p>
                                                                                                                                                    <p class="background-dot-container-option" id="subscription-mode">Subscription</p>
                                                                                                                                                    <p class="background-dot-container-option not-available" id="renewal-mode">Renewal</p>
                                                                                                                                                </div>

                                                                                                                                                      <div>
                                                                                                                                                         <div id="packageSelection" class="combobox" tooltip style="background: #232426;">
                                                                                                                                                             <div class="tooltip" style="width: max-content;" style="width: max-content;">
                                                                                                                                                                 Select the service you want to buy.
                                                                                                                                                             </div>
                                                                                                                                                             <span class="combobox-text" style="font-weight: 700;font-size: calc((2.25vh* var(--scale-factor-h)));" title="Subscription Package" default="All in one"></span>
                                                                                                                                                             <span class="arrow-dwn"></span>
                                                                                                                                                             <ul class="list-items">
                                                                                                                                                                 <li class="item">
                                                                                                                                                                     <label class="checkbox" tooltip>
                                                                                                                                                                         <input type="checkbox" value="allInOne"><span>All in one</span>
                                                                                                                                                                         <div class="tooltip" style="width: max-content;">You can use every product with this plan.</div>
                                                                                                                                                                     </label>
                                                                                                                                                                 </li>
                                                                                                                                                                 <li class="item">
                                                                                                                                                                     <label class="checkbox" tooltip>
                                                                                                                                                                         <input type="checkbox" value="faceSwap"><span>Face Swap</span>
                                                                                                                                                                         <div class="tooltip" style="width: max-content;">You can only use face swap with this plan.</div>
                                                                                                                                                                     </label>
                                                                                                                                                                 </li>
                                                                                                                                                                 <li class="item">
                                                                                                                                                                     <label class="checkbox" tooltip>
                                                                                                                                                                         <input type="checkbox" value="videoGenerator"><span>Video Generator</span>
                                                                                                                                                                         <div class="tooltip" style="width: max-content;">You can only use video generator with this plan.</div>
                                                                                                                                                                     </label>
                                                                                                                                                                 </li>
                                                                                                                                                                 <li class="item">
                                                                                                                                                                     <label class="checkbox" tooltip>
                                                                                                                                                                         <input type="checkbox" value="inpaint"><span>Inpainter</span>
                                                                                                                                                                         <div class="tooltip" style="width: max-content;">You can only use inpainter with this plan.</div>
                                                                                                                                                                     </label>
                                                                                                                                                                 </li>
                                                                                                                                                                 <li class="item">
                                                                                                                                                                     <label class="checkbox" tooltip>
                                                                                                                                                                         <input type="checkbox" value="artGenerator"><span>Art Generator</span>
                                                                                                                                                                         <div class="tooltip" style="width: max-content;">You can only use art generator with this plan.</div>
                                                                                                                                                                     </label>
                                                                                                                                                                 </li>
                                                                                                                                                             </ul>
                                                                                                                                                         </div>
                                                                                                                                                     </div>

                                                                                                                                                <div class="background-container">
                                                                                                                                                    <p class="background-dot-container-option" payment-provider="STRIPE" translate="no">Stripe</p>
                                                                                                                                                    <p class="background-dot-container-option not-available" payment-provider="PAYPAL" translate="no">Paypal</p>
                                                                                                                                                    <p class="background-dot-container-option" payment-provider="COINBASE" translate="no">Coinbase</p>
                                                                                                                                                </div>


                                                                                                                                                <div class="background-container" style="display: none;">
                                                                                                                                                    <p class="background-dot-container-option" data-currency="USD" translate="no">$USD</p>
                                                                                                                                                    <p class="background-dot-container-option" data-currency="EUR" translate="no">€EUR</p>
                                                                                                                                                    <p class="background-dot-container-option" data-currency="GBP" translate="no">£GBP</p>
                                                                                                                                                    <p class="background-dot-container-option" data-currency="TRY" translate="no">₺TRY</p>
                                                                                                                                                </div>

                                                                                                                                    <div class="background-container" style="display: flex;flex-direction: column;align-items: stretch;height: 100%;">
                                                                                                                                        <div style="display: flex; gap: calc((1vh* var(--scale-factor-h) + 2vw / 2 * var(--scale-factor-w)));height: 100%;">
                                                                                                                                            <a class="background-dot-container">
                                                                                                                                                <div class="background-dot-container-content" style="min-width: calc((50vh* var(--scale-factor-h) + 50vw / 2 * var(--scale-factor-w)));">
                                                                                                                                                    <div class="background-container" style="grid: unset; display: grid;grid-template-columns: 1fr 1fr;">
                                                                                                                                                        <input type="range" id="slider" min="1" max="9" step="1" value="1"></input>
                                                                                                                                                        <p class="slider-value">1 day</p>
                                                                                                                                                    </div>

                                                                                                                                                        <div class="line"></div>
                                                                                                                                                        <div class="background-dot-container-header">
                                                                                                                                                          <p class="plans-name text-gradient" id="plan-name">Starter</p>
                                                                                                                                                          <div class="plans-popular" id="popular-tag">
                                                                                                                                                            <p class="plans-name text-gradient">Popular</p>
                                                                                                                                                          </div>
                                                                                                                                                        </div>
                                                                                                                                                    <div class="background-dot-container-price">
                                                                                                                                                        <h2 id="cost-per-day" translate="no">Loading...</h2>
                                                                                                                                                        <h4 id="cost-per-day-unit" style="opacity: 0.5;">/day</h4>
                                                                                                                                                    </div>
                                                                                                                                                    <div class="background-dot-container-link" id="purchase">Purchase</div>
                                                                                                                                                    <div>
                                                                                                                                                        <div class="line"></div>
                                                                                                                                                        <h4 id="discount-details" style="display: flex;justify-content: space-between;gap: calc(2vh* var(--scale-factor-h));">Loading...</h4>
                                                                                                                                                        <p class="discount-details" id="discount">Loading...</p>
                                                                                                                                                        <div class="line"></div>
                                                                                                                                                        <div style="display: flex;gap: 0.5vh;align-items: center;">
                                                                                                                                                            <p class="uppercase text-gradient">Privileges</p>
                                                                                                                                                        </div>
                                                                                                                                                        <div id="features-list"></div>
                                                                                                                                                        <div class="line"></div>
                                                                                                                                                        <div style="display: flex;gap: 0.5vh;align-items: center;">
                                                                                                                                                            <p class="uppercase text-gradient">Plan Capability</p>
                                                                                                                                                            <p id="toggle-description" class="text-gradient" style="cursor: pointer;">+</p>
                                                                                                                                                        </div>
                                                                                                                                                            <div style="display: grid;grid-template-columns: 1fr auto;align-items: center;gap: 1vh;">
                                                                                                                                                                <input type="range" id="fps-slider" min="15" max="60" step="1" value="30">
                                                                                                                                                                <p id="fps-value">30 faceSwapFPS</p>
                                                                                                                                                            </div>
                                                                                                                                                        <ul id="capability-list" style="display: flow;background: transparent;"></ul>
                                                                                                                                                    </div>
                                                                                                                                                </div>
                                                                                                                                            </a>
                                                                                                                                        </div>
                                                                                                                                    </div>
                                                                                                                                </div>
                                                                                                                            </div>
                                                                                                                        `);
            }

            loadPageContent(setUser, retrieveImageFromURL, getUserInternetProtocol, ensureUniqueId, fetchServerAddress, getFirebaseModules, getDocSnapshot, getScreenMode, getCurrentMain, updateContent, createPages, setNavbar, setSidebar, showSidebar, removeSidebar, getSidebarActive, moveMains, setupMainSize, loadScrollingAndMain, showZoomIndicator, setScaleFactors, clamp, setAuthentication, updateMainContent);
            //showNotification(`We will have Stripe in a week or so, until then please proceed with Coinbase until a verified solution.`, 'Warning', 'warning-important');

            let pricingData = {};

            function setPricingData(data) {
                pricingData = data || [];
            }

            const serverDocSnapshot = () => getDocSnapshot('servers', '3090-1');
            const [serverAddressAPI, serverAddressPayment] = await Promise.all([
                fetchServerAddress(serverDocSnapshot, 'API'),
                fetchServerAddress(serverDocSnapshot, 'PAYMENTS'),
            ]);

            async function getPricingData() {
                const cacheKey = `pricingData_${version}`;
                const cachedData = getCache(cacheKey);

                if (cachedData) {
                    setPricingData(cachedData);
                } else {
                    try {
                        const response = await fetchWithRandom(`${serverAddressPayment}/get-pricing`, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                            },
                            body: JSON.stringify({})
                        });

                        if (!response.ok) {
                            throw new Error(`HTTP error! status: ${response.status}`);
                        }

                        const responseData = await response.json();
                        setCache(cacheKey, responseData.data, 1 * 24 * 60 * 60 * 1000);
                        setPricingData(responseData.data);
                    } catch (error) {
                        alert('Error while calling the pricing endpoint: ' + error.message);
                    }
                }

                fetchPricingDataInBackground();
            }

            async function fetchPricingDataInBackground() {
                try {
                    const response = await fetchWithRandom(`${serverAddressPayment}/get-pricing`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({})
                    });

                    if (response.ok) {
                        const responseData = await response.json();
                        setCache(`pricingData_${version}`, responseData.data, 1 * 24 * 60 * 60 * 1000);
                        setPricingData(responseData.data);
                    }
                } catch (error) {
                    alert('Error while refreshing the pricing data: ' + error.message);
                }
            }

            await getPricingData();

            let conversionRates = await fetchConversionRates();

            window.addEventListener('beforeunload', () => {
                if (!conversionRates)
                    return;

                const slider = document.getElementById('slider');
                const state = {
                    selectedMode: document.querySelector('.background-dot-container-option.selected[id]')?.id || '',
                    selectedCurrency: document.querySelector('.background-dot-container-option.selected[data-currency]')?.getAttribute('data-currency') || '',
                    selectedPaymentProvider: document.querySelector('.background-dot-container-option.selected[payment-provider]')?.getAttribute('payment-provider') || '',
                    sliderValue: slider.value,
                    sliderMax: slider.max,
                    costPerDay: document.getElementById('cost-per-day').innerText,
                    discountDetails: document.getElementById('discount-details').innerText,
                    discount: document.getElementById('discount').innerText,
                    toggleDescriptionText: document.getElementById('toggle-description').textContent,
                    fpsSlider: document.getElementById('fps-slider').value,
                    fpsValueDisplay: document.getElementById('fps-value').textContent,
                    comboboxes: Array.from(document.querySelectorAll('.combobox')).map(combobox => ({
                        text: combobox.querySelector('.combobox-text')?.innerText || '',
                        open: combobox.classList.contains('open'),
                        items: Array.from(combobox.querySelectorAll('.item')).map(item => ({
                            checked: item.querySelector('input[type="checkbox"]')?.checked || false,
                        })),
                    })),
                };

                localStorage.setItem('pageState', JSON.stringify(state));
            });

            const state = JSON.parse(localStorage.getItem('pageState') || '{}');

            const comboboxQuery = document.querySelectorAll('.combobox');
            comboboxQuery.forEach((combobox, id) => {
                const btnText = combobox.querySelector('.combobox-text');
                const items = combobox.querySelectorAll('.item');

                if (state.comboboxes && state.comboboxes[id]) {
                    if (btnText) btnText.innerText = state.comboboxes[id].text || '';

                    if (state.comboboxes[id].open) {
                        combobox.classList.add('open');
                        const listItems = combobox.querySelector('.list-items');
                        if (listItems) listItems.style.display = 'flex';
                    } else {
                        combobox.classList.remove('open');
                        const listItems = combobox.querySelector('.list-items');
                        if (listItems) listItems.style.display = 'none';
                    }

                    state.comboboxes[id].items.forEach((itemState, itemIndex) => {
                        if (itemIndex < items.length) {
                            const checkbox = items[itemIndex].querySelector('input[type="checkbox"]');
                            if (checkbox) {
                                checkbox.checked = itemState.checked;
                                items[itemIndex].classList.toggle('checked', checkbox.checked);
                            }
                        }
                    });
                }
            });

            if (state.selectedMode) {
                document.querySelectorAll('.background-dot-container-option').forEach(el => el.classList.remove('selected'));
                document.getElementById(state.selectedMode).classList.add('selected');
            }

            if (state.selectedCurrency) {
                document.querySelectorAll('.background-dot-container-option[data-currency]').forEach(el => el.classList.remove('selected'));
                document.querySelector(`[data-currency="${state.selectedCurrency}"]`).classList.add('selected');
            }

            if (state.selectedPaymentProvider) {
                document.querySelectorAll('.background-dot-container-option[payment-provider]').forEach(el => el.classList.remove('selected'));
                document.querySelector(`[payment-provider="${state.selectedPaymentProvider}"]`).classList.add('selected');
            }

            const slider = document.getElementById('slider');
            if (slider) {
                slider.value = state.sliderValue || '1';
                slider.max = state.sliderMax || '9';
            }

            document.getElementById('cost-per-day').innerText = state.costPerDay || '';
            document.getElementById('discount-details').innerText = state.discountDetails || '';
            document.getElementById('discount').innerText = state.discount || '';
            document.getElementById('toggle-description').textContent = state.toggleDescriptionText || "+";
            document.getElementById('fps-slider').value = state.fpsSlider || 30;
            document.getElementById('fps-value').textContent = state.fpsValueDisplay || '30 faceSwapFPS';

            const checkmarkIcon = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M20 6 9 17l-5-5"></path></svg>`;
            const xIcon = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x plans_x__KKb0t"><path d="M18 6 6 18"></path><path d="m6 6 12 12"></path></svg>`;

            let isShortDescription = document.getElementById('toggle-description').textContent === "+";

            let faceSwapFPS = 30;
            const videoFPS = 16;

            function updateCapabilityList(price, currencySymbol, isSubscriptionMode = true, credits = 0, selectedPackage = "allInOne") {
                const capabilityListElement = document.getElementById("capability-list");
                capabilityListElement.innerHTML = "";

                /*----------------------------------------------
                 * General Constants
                 ----------------------------------------------*/
                const secondsPerMinute = 60;

                /*----------------------------------------------
                 * Constants for Face Swap Capability
                 ----------------------------------------------*/
                const SingleCreditForTotalFrameAmount = 120;
                const creditPerTotalFrames = 120;
                const creditVideo = creditPerTotalFrames / SingleCreditForTotalFrameAmount;

                /*----------------------------------------------
                 * Constants for Video Generator Capability
                 * (Using new logic: 1s = 2 credits and 16 frames per second)
                 ----------------------------------------------*/
                const videoCreditsPerSecond = 2;

                /*----------------------------------------------
                 * Credit multipliers for other features
                 ----------------------------------------------*/
                const creditPerInpaint = 2;
                const creditPerArtGeneration = 1;

                /*----------------------------------------------
                 * Price formatting helper: adjusts the price string based on a multiplier.
                 ----------------------------------------------*/
                const formatPrice = (price, multiplier, currencySymbol) => {
                    const hasTilde = price.includes('~');
                    const cleanedPrice = price
                        .replace(currencySymbol, '')
                        .replace(/,/g, '.')
                        .replace(/[^\d.]/g, '');
                    const numericalPart = parseFloat(cleanedPrice);
                    let formattedPrice = (numericalPart * multiplier).toFixed(2);
                    if (hasTilde) formattedPrice += '~';
                    return `${currencySymbol}${formattedPrice}`;
                };

                // Price display for face swap uses the computed creditVideo as multiplier.
                const creditVideoPrice = formatPrice(price, creditVideo, currencySymbol);
                const inpaintPrice = formatPrice(price, creditPerInpaint, currencySymbol);
                const artPrice = formatPrice(price, creditPerArtGeneration, currencySymbol);

                /*----------------------------------------------
                 * Capability Formula Functions
                 ----------------------------------------------*/

                // Face Swap uses its own constants and formula.
                const getFaceSwapFormula = (shortDescription, credits) => {
                    const minutes = Math.floor((credits * SingleCreditForTotalFrameAmount) / (faceSwapFPS * secondsPerMinute));
                    if (shortDescription) {
                        return `${minutes} mins`;
                    } else {
                        return `${creditVideo} credit (${creditVideoPrice})/${creditPerTotalFrames} fps (${minutes} mins)`;
                    }
                };

                // Image Face Swap remains similar to before.
                const getImageSwapFormula = (shortDescription, credits) => {
                    if (shortDescription) {
                        return `${Math.floor(credits)} process`;
                    } else {
                        return `1 cred (${currencySymbol}${price})/image (${Math.floor(credits)})`;
                    }
                };

                // Video Generator (with new logic: 1s = 2 credits and 16 frames per second)
                const getVideoGeneratorFormula = (shortDescription, credits) => {
                    const durationSeconds = credits / videoCreditsPerSecond;
                    const durationMinutes = Math.floor(durationSeconds / secondsPerMinute);
                    const remainingSeconds = Math.floor(durationSeconds % secondsPerMinute);
                    const totalFrames = durationSeconds * videoFPS;
                    if (shortDescription) {
                        return `${durationMinutes} mins ${remainingSeconds} sec (${videoFPS} fps)`;
                    } else {
                        return `${credits} credits → ${totalFrames} frames at ${videoFPS} fps (${durationMinutes} mins ${remainingSeconds} sec)`;
                    }
                };

                // Inpaint capability calculation.
                const getInpaintFormula = (shortDescription, credits) => {
                    if (shortDescription) {
                        return `${Math.floor(credits / creditPerInpaint)} process`;
                    } else {
                        return `${creditPerInpaint} creds (${inpaintPrice})/inpaint (${Math.floor(credits / creditPerInpaint)})`;
                    }
                };

                // Art Generation calculation.
                const getArtFormula = (shortDescription, credits) => {
                    if (shortDescription) {
                        return `${Math.floor(credits)} process`;
                    } else {
                        return `${creditPerArtGeneration} cred (${artPrice})/art (${Math.floor(credits)})`;
                    }
                };

                /*----------------------------------------------
                 * Build the capabilities object based on selected package.
                 ----------------------------------------------*/
                const getCapabilities = (shortDescription) => {
                    const capabilities = {};

                    // For "faceSwap", use the face swap formula and its companion image swap.
                    if (selectedPackage === 'allInOne' || selectedPackage === 'faceSwap') {
                        capabilities.faceSwap = {
                            name: "Video Face Swap",
                            formula: credits => getFaceSwapFormula(shortDescription, credits)
                        };
                        capabilities.imageSwap = {
                            name: "Image Face Swap",
                            formula: credits => getImageSwapFormula(shortDescription, credits)
                        };
                    }

                    // Video Generator uses new credit rules.
                    if (selectedPackage === 'allInOne' || selectedPackage === 'videoGenerator') {
                        capabilities.videoGenerator = {
                            name: "Video Generator",
                            formula: credits => getVideoGeneratorFormula(shortDescription, credits)
                        };
                    }

                    // Inpaint capability.
                    if (selectedPackage === 'allInOne' || selectedPackage === 'inpaint') {
                        capabilities.inpaint = {
                            name: "Inpaint",
                            formula: credits => getInpaintFormula(shortDescription, credits)
                        };
                    }

                    // Art Generation capability.
                    if (selectedPackage === 'allInOne' || selectedPackage === 'artGenerator') {
                        capabilities.artGeneration = {
                            name: "Art Generator",
                            formula: credits => getArtFormula(shortDescription, credits)
                        };
                    }

                    return capabilities;
                };

                // Use a short description when not in subscription mode.
                const shortDescription = !isSubscriptionMode;
                const capabilities = getCapabilities(shortDescription);

                /*----------------------------------------------
                 * Render capabilities to the list element.
                 ----------------------------------------------*/
                if (isSubscriptionMode) {
                    // Subscription: All capabilities show "Unlimited".
                    capabilityListElement.innerHTML = Object.values(capabilities)
                        .map(capability => `<li class="capability">${capability.name}: Unlimited</li>`)
                        .join('');
                } else {
                    // Pay-as-you-go: Show detailed calculated usage based on credits.
                    capabilityListElement.innerHTML = Object.values(capabilities)
                        .map(capability => `<li class="capability">${capability.name}: ${capability.formula(credits)}</li>`)
                        .join('');
                }
            }

            const features = {
                subscription: [
                    { text: "Verified account", icon: checkmarkIcon },
                    { text: "2 GB upload per process", icon: checkmarkIcon },
                    { text: "Multiple face swaps", icon: checkmarkIcon },
                    { text: "Priority queue", icon: checkmarkIcon },
                    { text: "Frame limiter", icon: checkmarkIcon },
                    { text: "Ad-free experience", icon: checkmarkIcon },
                    { text: "Incognito mode", icon: checkmarkIcon },
                ],
                credits: [
                    { text: "Verified account", icon: checkmarkIcon },
                    { text: "2 GB upload per process", icon: checkmarkIcon },
                    { text: "Multiple face swaps", icon: checkmarkIcon },
                    { text: "Priority queue", icon: xIcon },
                    { text: "Frame limiter", icon: checkmarkIcon },
                    { text: "Ad-free experience", icon: checkmarkIcon },
                    { text: "Incognito mode", icon: checkmarkIcon },
                ]
            };

            function updateFeatureList(isCreditsMode) {
                const featuresListElement = document.getElementById("features-list");
                featuresListElement.innerHTML = "";
                const selectedFeatures = isCreditsMode ? features.credits : features.subscription;
                selectedFeatures.forEach(({ text, icon }) => {
                    featuresListElement.innerHTML += `<p class="feature">${icon} ${text}</p>`;
                });
            }

            function getSelectedPlan() {
                const container = document.getElementById('packageSelection');
                if (!container) return 'allInOne';

                const checkedItem = container.querySelector('li.item.checked');
                if (!checkedItem) return 'allInOne';

                const checkbox = checkedItem.querySelector('input[type="checkbox"]');
                return checkbox ? checkbox.value : 'allInOne';
            }

            function getPricing() {
                return pricingData[getSelectedPlan()];
            }

            function calculatePrice(value) { return getPricing().prices[value - 1]; }
            function calculateDiscountSubPrice(value) { return getPricing().discountedSubprices[value - 1]; }
            function calculateSubPrice(value) { return getPricing().subprices[value - 1]; }
            function calculateCredit(value) { return getPricing().credits[value - 1]; }

            function updatePlan(plan) {
                document.getElementById('plan-name').textContent = plan.name;
                document.getElementById('popular-tag').style.opacity = plan.isPopular ? '1' : '0';
            }

            function formatNumber(value, currency, minimumFractionDigits = 0, maximumFractionDigits = 3) {
                let locale;

                switch (currency) {
                    case 'USD': locale = 'en-US'; break;
                    case 'EUR': locale = 'de-DE'; break;
                    case 'GBP': locale = 'en-GB'; break;
                    case 'TRY': locale = 'tr-TR'; break;
                    default: locale = 'en-US';
                }

                function customRound(value, divider) {
                    let rounded = Math.round(value * divider) / divider;
                    if (!(rounded % 1 === 0.25 || rounded % 1 === 0.75))
                        rounded -= 0.01;
                    return rounded;
                }

                if (value >= 999.99) {
                    value = customRound(value, 1);
                    minimumFractionDigits = 0;
                    maximumFractionDigits = 4;
                } else if (value >= 599.99) {
                    value = Math.floor(value / 10) * 10 - 0.01;
                    minimumFractionDigits = 0;
                    maximumFractionDigits = 4;
                } else if (value >= 199.99) {
                    value = customRound(value, 1);
                    minimumFractionDigits = 0;
                    maximumFractionDigits = 4;
                } else if (value >= 99.99) {
                    value = customRound(value, 1);
                    minimumFractionDigits = 0;
                    maximumFractionDigits = 4;
                } else if (value >= 24.99) {
                    value = customRound(value, 2);
                    minimumFractionDigits = 0;
                    maximumFractionDigits = 3;
                } else if (value >= 9.99) {
                    value = customRound(value, 4);
                    minimumFractionDigits = 0;
                    maximumFractionDigits = 3;
                } else if (value >= 5) {
                    value = customRound(value, 2);
                    minimumFractionDigits = 0;
                    maximumFractionDigits = 3;
                } else if (value >= 0.99) {
                    value = customRound(value, currency === 'TRY' ? 8 : 4);
                    minimumFractionDigits = 0;
                    maximumFractionDigits = 2;
                } else if (value >= 0.1) {
                    value = customRound(value, 10);
                    minimumFractionDigits = 0;
                    maximumFractionDigits = 3;
                } else if (value >= 0.01) {
                    minimumFractionDigits = 0;
                    maximumFractionDigits = 3;
                } else if (value >= 0.001) {
                    minimumFractionDigits = 0;
                    maximumFractionDigits = 4;
                }

                const options = { style: 'decimal', minimumFractionDigits, maximumFractionDigits, };
                const formattedValue = new Intl.NumberFormat(locale, options).format(value);
                return locale === 'en-US' ? formattedValue : `${formattedValue}~`;
            }

            let createdEvent = false;

            const ACTUAL = 0;
            const DISCOUNT = 1;

            async function createPayment() {
                createSectionAndElements();

                const ScreenMode = Object.freeze({
                    PHONE: 3,
                    PC: 1,
                });

                const baseContainer = document.getElementById('baseContainer');
                if (baseContainer)
                    baseContainer.style.alignItems = getScreenMode() === ScreenMode.PHONE ? 'unset' : 'center';

                const selectedCurrencyElement = document.querySelector('.background-dot-container-option.selected[data-currency]');
                let selectedCurrency = selectedCurrencyElement ? selectedCurrencyElement.getAttribute('data-currency') : 'USD';

                const selectedPaymentProviderElement = document.querySelector('.background-dot-container-option.selected[payment-provider]');
                let selectedPaymentProvider = selectedPaymentProviderElement ? selectedPaymentProviderElement.getAttribute('payment-provider') : 'PAYTR';
                let taxAmt = selectedPaymentProvider === 'PAYTR' ? 3.59 : 1.01;

                const sliderElement = document.getElementById("slider");
                const subscriptionMode = document.getElementById("subscription-mode");
                const creditsMode = document.getElementById("credits-mode");
                const currencyOptions = document.querySelectorAll(".background-dot-container-option[data-currency]");
                const paymentProviderOptions = document.querySelectorAll(".background-dot-container-option[payment-provider]");
                const dailyPriceAmountElement = document.getElementById("cost-per-day");
                const discountElement = document.getElementById("discount");
                const discountDetailsElement = document.getElementById("discount-details");
                const purchase = document.getElementById("purchase");
                const toggleDescriptionButton = document.getElementById("toggle-description");
                const fpsSlider = document.getElementById('fps-slider');
                const fpsValueDisplay = document.getElementById('fps-value');

                currencyOptions.forEach(option => {
                    option.addEventListener('click', () => {
                        if (option.classList.contains('not-available')) {
                            console.log(`Currency option "${option.textContent.trim()}" is not available`);
                            return;
                        }

                        const newCurrency = option.getAttribute("data-currency");
                        if (newCurrency !== selectedCurrency) {
                            currencyOptions.forEach(opt => opt.classList.remove("selected"));
                            option.classList.add("selected");
                            selectedCurrency = newCurrency;
                            updatePrices();
                        }
                    });
                });

                paymentProviderOptions.forEach(option => {
                    option.addEventListener('click', () => {
                        if (option.classList.contains('not-available')) {
                            console.log(`Payment provider "${option.textContent.trim()}" is not available`);
                            return;
                        }

                        const newProvider = option.getAttribute("payment-provider");
                        if (newProvider !== selectedPaymentProvider) {
                            paymentProviderOptions.forEach(opt => opt.classList.remove("selected"));
                            option.classList.add("selected");
                            selectedPaymentProvider = newProvider;
                            updatePrices();
                        }
                    });
                });

                if (!Array.from(currencyOptions).some(option => option.classList.contains("selected"))) {
                    if (Array.from(currencyOptions).length > 0) {
                        const firstCurrencyOption = Array.from(currencyOptions)[0];
                        firstCurrencyOption.classList.add("selected");
                        selectedCurrency = firstCurrencyOption.getAttribute("data-currency");
                        updatePrices();
                    }
                }

                if (!Array.from(currencyOptions).some(option => option.classList.contains("selected"))) {
                    if (Array.from(currencyOptions).length > 0) {
                        const firstCurrencyOption = Array.from(currencyOptions)[0];
                        firstCurrencyOption.classList.add("selected");
                        selectedCurrency = firstCurrencyOption.getAttribute("data-currency");
                        updatePrices();
                    }
                }

                if (!Array.from(paymentProviderOptions).some(option => option.classList.contains("selected"))) {
                    if (Array.from(paymentProviderOptions).length > 0) {
                        const firstPaymentProviderOption = Array.from(paymentProviderOptions)[1];
                        firstPaymentProviderOption.classList.add("selected");
                        selectedPaymentProvider = firstPaymentProviderOption.getAttribute("payment-provider");
                        updatePrices();
                    }
                }

                function updatePrices() {
                    updateSliderRange();
                    const isCreditsMode = creditsMode.classList.contains("selected");
                    const packageSelection = document.getElementById('packageSelection');
                    packageSelection.parentElement.style.display = !isCreditsMode ? 'unset' : 'none';

                    let currencySymbol = getCurrencySymbol(selectedCurrency);

                    updateFeatureList(isCreditsMode);

                    let value, price = [0, 0], h1PriceAmount = [0, 0], priceInSelectedCurrency = [0, 0];
                    let message = '';
                    let isNonUSDOrBTC = selectedCurrency !== 'USD';

                    const convertCurrency = (amount) => isNonUSDOrBTC && conversionRates ? amount * conversionRates[selectedCurrency] : amount;
                    const updateDisplay = (text, unit) => {
                        dailyPriceAmountElement.innerHTML = text;
                        document.getElementById('cost-per-day-unit').textContent = unit;
                    };

                    function getCurrencySymbol(currency) {
                        const symbols = { USD: '$', EUR: '€', GBP: '£', TRY: '₺' };
                        return symbols[currency] || currency;
                    }

                    if (isCreditsMode) {
                        const plans = {
                            '1': { name: 'Starter', isPopular: false },
                            '2': { name: 'Standard', isPopular: false },
                            '3': { name: 'Recommended', isPopular: true },
                            '8': { name: 'Enterprise', isPopular: false },
                            '9': { name: 'Best Value', isPopular: false },
                            'default': { name: 'Advanced', isPopular: false }
                        };

                        function updateVariables() {
                            const selectedPackage = getSelectedPlan();
                            const selectedCurrencyElement = document.querySelector('.background-dot-container-option.selected[data-currency]');
                            selectedCurrency = selectedCurrencyElement ? selectedCurrencyElement.getAttribute('data-currency') : 'USD';

                            const selectedPaymentProviderElement = document.querySelector('.background-dot-container-option.selected[payment-provider]');
                            selectedPaymentProvider = selectedPaymentProviderElement ? selectedPaymentProviderElement.getAttribute('payment-provider') : 'PAYTR';
                            taxAmt = selectedPaymentProvider === 'STRIPE' ? 2.89 : 0.01;
                            const centsFee = selectedPaymentProvider === 'STRIPE' ? ' + 30¢ + VAT' : '';

                            currencySymbol = getCurrencySymbol(selectedCurrency);
                            isNonUSDOrBTC = selectedCurrency !== 'USD';

                            value = sliderElement.value;
                            updatePlan(plans[value] || plans['default']);

                            const creditAmount = calculateCredit(value);
                            price[ACTUAL] = calculatePrice(value);
                            priceInSelectedCurrency[ACTUAL] = convertCurrency(price[ACTUAL]);
                            h1PriceAmount[ACTUAL] = creditAmount > 0 ? price[ACTUAL] / creditAmount : null;
                            h1PriceAmount[ACTUAL] = h1PriceAmount[ACTUAL] !== null ? convertCurrency(h1PriceAmount[ACTUAL]) : null;

                            price[DISCOUNT] = calculatePrice(value);
                            priceInSelectedCurrency[DISCOUNT] = convertCurrency(price[DISCOUNT]);
                            h1PriceAmount[DISCOUNT] = creditAmount > 0 ? price[DISCOUNT] / creditAmount : null;
                            h1PriceAmount[DISCOUNT] = h1PriceAmount[DISCOUNT] !== null ? convertCurrency(h1PriceAmount[DISCOUNT]) : null;

                            fpsValueDisplay.textContent = `${fpsSlider.value} FPS`;
                            faceSwapFPS = fpsSlider.value;
                            updateCapabilityList(formatNumber(h1PriceAmount[ACTUAL], selectedCurrency), currencySymbol, false, creditAmount);

                            fpsSlider.style.display = 'block';
                            fpsValueDisplay.style.display = 'block';
                            toggleDescriptionButton.style.display = 'block';
                            if (!createdEvent) {
                                toggleDescriptionButton.addEventListener('click', function () {
                                    isShortDescription = !isShortDescription;
                                    this.textContent = isShortDescription ? "+" : "-";
                                    updateCapabilityList(formatNumber(h1PriceAmount[ACTUAL], selectedCurrency), currencySymbol, false, creditAmount);
                                });

                                fpsSlider.addEventListener('input', function () { updateVariables(); });
                                createdEvent = true;
                            }
                            message = 'Any credits you purchase will not expire.';

                            let discountDisplay = '';

                            if (h1PriceAmount[ACTUAL] !== h1PriceAmount[DISCOUNT]) {
                                discountDetailsElement.style.display = 'flex';
                                discountDetailsElement.style.gap = 'calc(2vh* var(--scale-factor-h))';
                                discountDetailsElement.innerHTML = `
                                                                                <div style="display: ruby;">
                                                                                    Discounted:
                                                                                    <span style="text-decoration: line-through;font-weight: 400;">${currencySymbol}${formatNumber(priceInSelectedCurrency[ACTUAL], selectedCurrency)}</span>
                                                                                    <span >${currencySymbol}${formatNumber(priceInSelectedCurrency[DISCOUNT], selectedCurrency)}</span>
                                                                                    <small style="opacity: 0.5;line-height: calc((1vh* 1.5* var(--scale-factor-h)));">(+${taxAmt}%${centsFee}) fee</small>
                                                                                </div>

                                                                                <div class="plans-popular" id="popular-tag" style="display: flex;">
                                                                                    <p class="plans-name text-gradient">OFF -${((1 - (price[DISCOUNT] / price[ACTUAL])) * 100).toFixed(0)}%</p>
                                                                                </div>
                                                                            `;

                                discountDisplay = `
                                                                                <span style="text-decoration: line-through;font-weight: 400;">${currencySymbol}${formatNumber(h1PriceAmount[ACTUAL], selectedCurrency)}</span>
                                                                                <span >${currencySymbol}${formatNumber(h1PriceAmount[DISCOUNT], selectedCurrency)}</span>
                                                                            `;
                            }
                            else {
                                discountDetailsElement.style.display = 'ruby';
                                discountDetailsElement.style.gap = 'unset';
                                discountDetailsElement.innerHTML = `
                                                                                Total Price:
                                                                                <div style="display: ruby;">
                                                                                    <span>${currencySymbol}${formatNumber(priceInSelectedCurrency[ACTUAL], selectedCurrency)}</span>
                                                                                    <small style="opacity: 0.5;line-height: calc((1vh* 1.5* var(--scale-factor-h)));">(+${taxAmt}%${centsFee})</small>
                                                                                <div>
                                                                            `;

                                discountDisplay = `
                                                                                <span >${currencySymbol}${formatNumber(h1PriceAmount[ACTUAL], selectedCurrency)}</span>
                                                                            `;
                            }

                            updateDisplay(discountDisplay, '/credit');
                        }

                        updateVariables();
                    } else {
                        const plans = {
                            '1': { name: 'Starter', isPopular: true },
                            '2': { name: 'Standard', isPopular: false },
                            '6': { name: 'Enterprise', isPopular: false },
                            'default': { name: 'Advanced', isPopular: false }
                        };

                        function updateVariables() {
                            const selectedPackage = getSelectedPlan();
                            const selectedCurrencyElement = document.querySelector('.background-dot-container-option.selected[data-currency]');
                            selectedCurrency = selectedCurrencyElement ? selectedCurrencyElement.getAttribute('data-currency') : 'USD';

                            const selectedPaymentProviderElement = document.querySelector('.background-dot-container-option.selected[payment-provider]');
                            selectedPaymentProvider = selectedPaymentProviderElement ? selectedPaymentProviderElement.getAttribute('payment-provider') : 'PAYTR';
                            taxAmt = selectedPaymentProvider === 'STRIPE' ? 2.89 : 0.01;
                            const centsFee = selectedPaymentProvider === 'STRIPE' ? ' + 30¢ + VAT' : '';

                            currencySymbol = getCurrencySymbol(selectedCurrency);
                            isNonUSDOrBTC = selectedCurrency !== 'USD';

                            value = sliderElement.value;
                            updatePlan(plans[value] || plans['default']);

                            const durationDays = getPricing().durationsInDays[value - 1];
                            price[ACTUAL] = calculateSubPrice(value);
                            priceInSelectedCurrency[ACTUAL] = convertCurrency(price[ACTUAL]);
                            h1PriceAmount[ACTUAL] = durationDays > 0 ? price[ACTUAL] / durationDays : null;
                            h1PriceAmount[ACTUAL] = h1PriceAmount[ACTUAL] !== null ? convertCurrency(h1PriceAmount[ACTUAL]) : null;

                            price[DISCOUNT] = calculateDiscountSubPrice(value);
                            priceInSelectedCurrency[DISCOUNT] = convertCurrency(price[DISCOUNT]);
                            h1PriceAmount[DISCOUNT] = durationDays > 0 ? price[DISCOUNT] / durationDays : null;
                            h1PriceAmount[DISCOUNT] = h1PriceAmount[DISCOUNT] !== null ? convertCurrency(h1PriceAmount[DISCOUNT]) : null;

                            fpsSlider.style.display = 'none';
                            fpsValueDisplay.style.display = 'none';
                            updateCapabilityList(formatNumber(h1PriceAmount[ACTUAL], selectedCurrency), currencySymbol, true, 0, selectedPackage);

                            isShortDescription = true;
                            toggleDescriptionButton.style.display = "none";

                            message = 'Use our products without credit limitations.';
                            if (durationDays === -1) {
                                discountDetailsElement.style.display = 'flex';
                                discountDetailsElement.style.gap = 'calc(2vh* var(--scale-factor-h))';
                                discountDetailsElement.innerHTML = `
                                                                                 <div style="display: ruby;">
                                                                                     Discounted:
                                                                                     <span style="text-decoration: line-through;font-weight: 400;">${currencySymbol}${formatNumber(priceInSelectedCurrency[ACTUAL], selectedCurrency)}</span>
                                                                                     <span >${currencySymbol}${formatNumber(priceInSelectedCurrency[DISCOUNT], selectedCurrency)}</span>
                                                                                     <!--<small style="opacity: 0.5;line-height: calc((1vh* 1.5* var(--scale-factor-h)));">(+${taxAmt}%${centsFee})</small>-->
                                                                                 </div>

                                                                                 <div class="plans-popular" id="popular-tag" style="display: flex;">
                                                                                     <p class="plans-name text-gradient">OFF -${((1 - (price[DISCOUNT] / price[ACTUAL])) * 100).toFixed(0)}%</p>
                                                                                 </div>
                                                                             `;

                                let discountDisplay = '';

                                if (priceInSelectedCurrency[ACTUAL] !== priceInSelectedCurrency[DISCOUNT]) {
                                    discountDisplay = `
                                                                                    <span style="text-decoration: line-through;font-weight: 400;">${currencySymbol}${formatNumber(priceInSelectedCurrency[ACTUAL], selectedCurrency)}</span>
                                                                                    <span >${currencySymbol}${formatNumber(priceInSelectedCurrency[DISCOUNT], selectedCurrency)}</span>
                                                                                `;
                                }
                                else {
                                    discountDisplay = `
                                                                                    <span>${currencySymbol}${formatNumber(priceInSelectedCurrency[ACTUAL], selectedCurrency)}</span>
                                                                                `;
                                }

                                updateDisplay(discountDisplay, '');
                            } else {
                                let discountDisplay = '';

                                if (h1PriceAmount[ACTUAL] !== h1PriceAmount[DISCOUNT]) {
                                    discountDetailsElement.style.display = 'flex';
                                    discountDetailsElement.style.gap = 'calc(2vh* var(--scale-factor-h))';
                                    discountDetailsElement.innerHTML = `
                                                                                        <div style="display: ruby;">
                                                                                            Discounted:
                                                                                            <span style="text-decoration: line-through;font-weight: 400;">${currencySymbol}${formatNumber(priceInSelectedCurrency[ACTUAL], selectedCurrency)}</span>
                                                                                            <span >${currencySymbol}${formatNumber(priceInSelectedCurrency[DISCOUNT], selectedCurrency)}</span>
                                                                                            <small style="opacity: 0.5;line-height: calc((1vh* 1.5* var(--scale-factor-h)));">(+${taxAmt}%${centsFee})</small>
                                                                                        </div>

                                                                                        <div class="plans-popular" id="popular-tag" style="display: flex;">
                                                                                            <p class="plans-name text-gradient">OFF -${((1 - (price[DISCOUNT] / price[ACTUAL])) * 100).toFixed(0)}%</p>
                                                                                        </div>
                                                                                `;

                                    discountDisplay = `
                                                                                    <span style="text-decoration: line-through;font-weight: 400;">${currencySymbol}${formatNumber(h1PriceAmount[ACTUAL], selectedCurrency)}</span>
                                                                                    <span >${currencySymbol}${formatNumber(h1PriceAmount[DISCOUNT], selectedCurrency)}</span>
                                                                                `;
                                }
                                else {
                                    discountDetailsElement.style.display = 'ruby';
                                    discountDetailsElement.style.gap = 'unset';
                                    discountDetailsElement.innerHTML = `
                                                                                    Total Price:
                                                                                    <div style="display: ruby;">
                                                                                        <span>${currencySymbol}${formatNumber(priceInSelectedCurrency[ACTUAL], selectedCurrency)}</span>
                                                                                        <small style="opacity: 0.5;line-height: calc((1vh* 1.5* var(--scale-factor-h)));">(+${taxAmt}%${centsFee})</small>
                                                                                    <div>
                                                                                `;

                                    discountDisplay = `
                                                                                    <span >${currencySymbol}${formatNumber(h1PriceAmount[ACTUAL], selectedCurrency)}</span>
                                                                                `;
                                }

                                updateDisplay(discountDisplay, '/day');
                            }
                        }

                        updateVariables();
                    }

                    if (discountElement) discountElement.textContent = message;
                }

                function updateSliderRange() {
                    if (creditsMode.classList.contains("selected"))
                        sliderElement.max = getPricing().credits.length;
                    else sliderElement.max = getPricing().durations.length;

                    if (sliderElement.value > sliderElement.max)
                        sliderElement.value = sliderElement.max;
                }

                function updateSliderValue() {
                    const value = sliderElement.value;
                    if (creditsMode.classList.contains("selected")) {
                        const creditAmount = calculateCredit(value);
                        sliderElement.nextElementSibling.textContent = `${creditAmount} credit${creditAmount > 1 ? 's' : ''}`;
                    } else {
                        const selectedDuration = getPricing().durations[value - 1];
                        sliderElement.nextElementSibling.textContent = selectedDuration;
                    }

                    updatePrices();
                }

                sliderElement.addEventListener("input", updateSliderValue);

                let currentMode = state.selectedMode;

                subscriptionMode.addEventListener('click', () => {
                    if (currentMode !== 'subscription-mode') {
                        subscriptionMode.classList.add("selected");
                        creditsMode.classList.remove("selected");
                        currentMode = 'subscription-mode';
                        updateSliderRange();
                        updateSliderValue();
                    }
                });

                if (!localStorage.getItem('selectedMode')) {
                    creditsMode.classList.add("selected");
                    currentMode = 'credits-mode';
                    updateSliderRange();
                    updateSliderValue();
                    localStorage.setItem('selectedMode', 'true');
                }

                creditsMode.addEventListener('click', () => {
                    if (currentMode !== 'credits-mode') {
                        creditsMode.classList.add("selected");
                        subscriptionMode.classList.remove("selected");
                        currentMode = 'credits-mode';
                        updateSliderRange();
                        updateSliderValue();
                    }
                });

                updateSliderRange();
                updateSliderValue();

                document.querySelectorAll('#packageSelection li.item input[type="checkbox"]').forEach(input => {
                    input.addEventListener('change', () => {
                        updatePrices();
                    });
                });


                purchase.addEventListener('click', async () => { await handleBuyNow(); });

                async function handleBuyNow() {
                    const userData = await getUserData();
                    if (!userData || !userData.uid) {
                        alert('User data not found.');
                        return;
                    }

                    const selectedMode = subscriptionMode.classList.contains("selected") ? 'subscription' : 'credits';
                    const isPaypal = selectedPaymentProvider === 'PAYPAL';

                    const requestData = {
                        userId: userData.uid,
                        userEmail: userData.email,
                        selectedCurrency,
                        sliderElement: sliderElement.value,
                        selectedPackage: getSelectedPlan(),
                        selectedMode,
                    };

                    const isBTC = selectedPaymentProvider === 'COINBASE';
                    const backendURL = isBTC ? `${serverAddressAPI}/create-charge` : `${serverAddressPayment}/create-charge`;

                    const response = await fetchWithRandom(backendURL, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(requestData),
                    });

                    let responseData;
                    let rawText = '';

                    try {
                        responseData = await response.json();
                    } catch {
                        rawText = await response.text().catch(() => '');
                        alert(rawText || 'Invalid response from server.');
                        return;
                    }

                    if (!response.ok) {
                        alert(responseData?.error || rawText || 'An unexpected error occurred');
                        return;
                    }

                    if (typeof gtag === 'function') {
                        gtag('event', 'conversion', {
                            'send_to': 'AW-16739497290/1Eg0CIaP86EaEMrqga4-',
                            'value': 1,
                            'currency': 'USD',
                        });

                        gtag('event', 'conversion', {
                            'send_to': 'AW-17205210368/6m3ACLiR_twaEIDaioxA',
                            'value': 1,
                            'currency': 'USD'
                        });
                    }

                    const paymentURL = responseData?.data?.hosted_url || responseData?.url;

                    try {
                        const newWindow = window.open(paymentURL, '_blank');
                        if (!newWindow || newWindow.closed || typeof newWindow.closed === 'undefined') {
                            throw new Error('Popup blocked');
                        }
                    } catch {
                        window.location.href = paymentURL;
                    }
                }

                document.querySelectorAll('.background-container').forEach((container, index) => {
                    let selected = container.querySelector('.background-dot-container-option.selected')
                        || container.querySelector('.background-dot-container-option');

                    if (selected) {
                        if (selected.classList.contains('not-available')) {
                            const next = selected.nextElementSibling;
                            if (next) {
                                if (next.classList.contains('background-dot-container-option')) {
                                    selected.classList.remove('selected');
                                    next.classList.add('selected');
                                }
                            }
                        }
                    }
                });
            }

            let previousScreenMode = null;

            async function sizeBasedElements() {
                const screenMode = getScreenMode();
                const shouldUpdate = previousScreenMode !== screenMode;
                previousScreenMode = screenMode;
                if (!shouldUpdate)
                    return;

                createPayment();
            }

            sizeBasedElements();

            window.addEventListener('resize', sizeBasedElements);
        });
    </script>
</body>
</html>
